(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5791:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Y}});var r=n(5893),s=n(9008),a=n(5323),i=n.n(a),c=n(7329),o=n(6156),l=n(2212),u=n(7294),d=n(5411),f=n(5975),p=n.n(f),m=function(e){var t=Math.floor(e),n=Math.floor(t/60),r=1e3*e%1e3,s="",a="",i="";return r=Math.round(r),s=(t%=60)<10?"0"+t:t.toString(),a=n<10?"0"+n:n.toString(),r<10?r*=100:r<100&&(r*=10),i=0===r?"000":r.toString(),"".concat(a,":").concat(s,".").concat(i)},h=function(e){return(0,r.jsx)("button",{className:p().button,onClick:e.onClick,title:e.title,disabled:e.connected,children:(0,r.jsx)("img",{className:p().svg,src:e.path})})},x=function(e){var t=(0,u.useContext)(W),n=(0,u.useState)("icons/pause.svg"),s=n[0],a=n[1],i=(0,u.useState)("icons/realtime.svg"),c=i[0],o=i[1],l=(0,u.useState)("icons/stopRender.svg"),d=l[0],f=l[1],x=(0,u.useState)("Pause the simulation"),v=x[0],j=x[1],b=(0,u.useState)("Play at real-time"),_=b[0],y=b[1],w=(0,u.useState)("Stop rendering (simulation continues)"),S=w[0],g=w[1],O=(0,u.useState)(!1),k=O[0],D=O[1],N=(0,u.useState)(!0),P=N[0],E=N[1],C=(0,u.useState)(!0),B=C[0],I=C[1];return(0,r.jsxs)("div",{className:p().info,children:[(0,r.jsx)("div",{className:p().spacer}),(0,r.jsx)(h,{path:s,onClick:function(){var e;k?(j("Pause the simulation"),a("icons/pause.svg"),e=!1):(j("Continue the simulation"),a("icons/play.svg"),e=!0),D(e),t({type:"userInputNoState",index:0,data:e})},title:v,connected:!e.connected}),(0,r.jsx)(h,{path:c,onClick:function(){var e;P?(y("Play at full speed"),o("icons/fasttime.svg"),e=!1):(y("Play at real-time"),o("icons/realtime.svg"),e=!0),E(e),t({type:"userInputNoState",index:1,data:e})},title:_,connected:!e.connected}),(0,r.jsx)(h,{path:d,onClick:function(){var e;B?(g("Start rendering"),f("icons/startRender.svg"),e=!1):(g("Stop rendering (simulation continues)"),f("icons/stopRender.svg"),e=!0),I(e),t({type:"userInputNoState",index:2,data:e})},title:S,connected:!e.connected}),(0,r.jsx)("div",{className:p().fps,children:e.FPS}),(0,r.jsx)("div",{className:p().simTime,children:m(e.time)})]})},v=n(4699),j=n(3400),b=n.n(j);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w=function(e){var t=(0,u.useContext)(W);return(0,r.jsx)("div",{className:b().buttonDiv,children:(0,r.jsx)("button",{type:"button",className:b().buttonButton,id:"button"+e.id,onClick:function(){return t({type:"userInputNoState",index:e.id,data:1})},children:e.desc})})},S=function(e){return(0,r.jsx)("div",{className:b().labelDiv,children:(0,r.jsx)("p",{id:"label"+e.id,children:e.desc})})},g=function(e){var t=(0,u.useContext)(W),n=(0,u.useRef)(null),s=(0,u.useRef)(null),a=function(){s.current.innerHTML=n.current.value+e.unit,t({type:"userInputState",index:e.id,data:parseFloat(n.current.value),valueName:"value",value:parseFloat(n.current.value)})};return(0,u.useEffect)((function(){a()}),[e.value]),(0,r.jsxs)("div",{className:b().sliderDiv,id:"slider-div"+e.id,children:[(0,r.jsx)("p",{className:b().sliderP,id:"desc"+e.id,children:e.desc}),(0,r.jsx)("input",{ref:n,type:"range",value:e.value,step:e.step,min:e.min,max:e.max,className:b().slider,id:"slider"+e.id,onInput:a}),(0,r.jsxs)("div",{className:b().sliderValDiv,id:"slider-val-div"+e.id,children:[(0,r.jsx)("p",{className:[b().sliderVals,b().sliderMin].join(" "),id:"min"+e.id,children:e.min}),(0,r.jsx)("p",{ref:s,className:[b().sliderVals,b().sliderVal].join(" "),id:"value"+e.id,children:e.value+e.unit}),(0,r.jsx)("p",{className:[b().sliderVals,b().sliderMax].join(" "),id:"max"+e.id,children:e.max})]})]})},O=function(e){var t=(0,u.useContext)(W),n=(0,u.useRef)(null);return(0,u.useEffect)((function(){t({type:"userInputNoState",index:e.id,data:parseInt(n.current.value)})}),[e.value]),(0,r.jsxs)("div",{className:b().selectDiv,children:[(0,r.jsx)("label",{id:"label"+e.id,className:b().selectLabel,children:e.desc}),(0,r.jsx)("select",{ref:n,id:"select"+e.id,className:b().selectSelect,onChange:function(r){t({type:"userInputState",index:e.id,data:parseInt(n.current.value),valueName:"value",value:parseInt(n.current.value)})},value:e.value,children:e.options.map((function(t,n){return(0,r.jsx)("option",{value:n,children:t},e.id+" "+n)}))})]})},k=function(e){var t=(0,u.useContext)(W),n=(0,u.useRef)(null),s=function(){for(var e=n.current.getElementsByTagName("input"),t=[],r=0;r<e.length;r++)t.push(e[r].checked);return t},a=function(n){var r=s();t({type:"userInputState",index:e.id,data:r,valueName:"checked",value:r})};return(0,u.useEffect)((function(){var n=s();t({type:"userInputNoState",index:e.id,data:n})}),[e.checked]),(0,r.jsxs)("div",{className:b().checkboxDiv,children:[(0,r.jsx)("label",{className:b().checkboxLabel,id:"label"+e.id,children:e.desc}),(0,r.jsx)("div",{ref:n,className:b().checkboxCont,id:"checkboxcont"+e.id,children:e.options.map((function(t,n){return(0,r.jsxs)("label",{htmlFor:"checkbox"+e.id,children:[(0,r.jsx)("input",{type:"checkbox",onChange:a,checked:e.checked[n],id:"checkbox"+e.id+n}),(0,r.jsxs)("span",{children:[" ",e.options[n]," "]})]},e.id+" "+n)}))})]})},D=function(e){var t=(0,u.useContext)(W),n=(0,u.useRef)(null),s=function(){var e,t,r=n.current.getElementsByTagName("input"),s=[];for(e=0;e<r.length;e++)r[e].checked&&(t=e),s.push(r[e].checked);return[s,t]},a=function(){var n=s(),r=(0,v.Z)(n,2),a=r[0],i=r[1];t({type:"userInputState",index:e.id,data:i,valueName:"checked",value:a})};return(0,u.useEffect)((function(){var n=s(),r=(0,v.Z)(n,2),a=(r[0],r[1]);t({type:"userInputNoState",index:e.id,data:a})}),[e.checked]),(0,r.jsxs)("div",{className:b().radioDiv,children:[(0,r.jsx)("label",{className:b().radioLabel,id:"label"+e.id,children:e.desc}),(0,r.jsx)("div",{ref:n,className:b().radioCont,id:"radiocont"+e.id,children:e.options.map((function(t,n){return(0,r.jsxs)("label",{htmlFor:"radio"+e.id,children:[(0,r.jsx)("input",{type:"radio",onChange:a,checked:e.checked[n],id:"radio"+e.id+n,name:"radio"+e.id}),(0,r.jsxs)("span",{children:[" ",e.options[n]," "]})]},e.id+" "+n)}))})]})},N=function(e){return"button"===e.element?(0,r.jsx)(w,y({},e)):"label"===e.element?(0,r.jsx)(S,y({},e)):"slider"===e.element?(0,r.jsx)(g,y({},e)):"select"===e.element?(0,r.jsx)(O,y({},e)):"checkbox"===e.element?(0,r.jsx)(k,y({},e)):"radio"===e.element?(0,r.jsx)(D,y({},e)):(0,r.jsx)(w,y({},e))},P=function(e){return(0,r.jsx)("div",{className:b().sidenav,hidden:!(e.elements.length>0),children:e.elements.map((function(e,t){return(0,r.jsx)(N,y({},e),e.id.toString()+t)}))})},E=n(8779),C=n.n(E);function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var R=function(e,t){switch(console.log("action: ",t,"state ",e),t.type){case"newElement":return I(I({},e),{},{formElements:[].concat((0,c.Z)(e.formElements),[t.data])});case"userInputState":var n=I({},e.formData),r=(0,c.Z)(e.formElements);return n[t.index]=t.data,r[t.index-3][t.valueName]=t.value,{formElements:r,formData:n};case"userInputNoState":var s=I({},e.formData);return s[t.index]=t.data,{formElements:(0,c.Z)(e.formElements),formData:s};case"wsUpdate":var a=(0,c.Z)(e.formElements);return a[t.index-3]=t.data,I(I({},e),{},{formElements:a});case"reset":var i=I({},e.formData);return t.indices.map((function(e){delete i[e]})),{formData:i,formElements:(0,c.Z)(e.formElements)};default:throw new Error}};function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}l.Object3D.DefaultUp.set(0,0,1);var Z=(0,u.lazy)((function(){return Promise.all([n.e(972),n.e(861)]).then(n.bind(n,1861))})),F=function(){var e=(0,d.Ky)().scene;return e.background=new l.Color(7895160),e.fog=new l.Fog(7895160,50,60),(0,r.jsxs)("mesh",{receiveShadow:!0,children:[(0,r.jsx)("planeBufferGeometry",{args:[200,200]}),(0,r.jsx)("meshPhongMaterial",{color:4934475,specular:new l.Color(1052688)})]})},V=function(e){var t=(0,u.useRef)();return(0,r.jsx)("directionalLight",{ref:t,color:e.color,intensity:e.intensity,position:[e.x,e.y,e.z],castShadow:!0})},L=function(e){var t=(0,d.Ky)(),n=t.viewport,s=t.setDefaultCamera,a=n.width,i=n.height,c=(0,u.useRef)();return(0,u.useEffect)((function(){e.setDefault&&s(c.current)})),(0,d.xQ)((function(t,n){e.fpsCallBack(1/n)})),(0,r.jsx)("perspectiveCamera",{ref:c,position:[.2,1.2,.7],near:.01,far:100,fov:70,aspect:i/a})},T=function(e){switch(e.stype){case"box":return(0,r.jsx)("boxBufferGeometry",{args:[e.scale[0],e.scale[1],e.scale[2]]});case"sphere":return(0,r.jsx)("sphereBufferGeometry",{args:[e.radius,64,64]});case"cylinder":return(0,r.jsx)("cylinderBufferGeometry",{args:[e.radius,e.radius,e.length,32]});default:return(0,r.jsx)("boxBufferGeometry",{args:[e.scale[0],e.scale[1],e.scale[2]]})}},z=function(e){var t=(0,u.useRef)();return(0,r.jsxs)("mesh",{ref:t,position:[e.t[0],e.t[1],e.t[2]],quaternion:e.q?[e.q[0],e.q[1],e.q[2],e.q[3]]:[1,0,0,0],castShadow:!0,name:"loaded",children:[(0,r.jsx)(T,M({},e)),(0,r.jsx)("meshStandardMaterial",{transparent:!!e.opacity,color:e.color?e.color:"hotpink",opacity:e.opacity?e.opacity:1})]})},U=function(e){var t=(0,u.useState)(!1),n=t[0],s=t[1];return(0,u.useEffect)((function(){s(!0)}),[]),(0,r.jsx)(r.Fragment,{children:n&&(0,r.jsx)(u.Suspense,{fallback:(0,r.jsx)(z,{stype:"box",scale:[.1,.1,.1],t:e.t,opacity:.1,color:16777215}),children:(0,r.jsx)(Z,M({},e))})})},G=function(e){var t=(0,u.useRef)();return(0,r.jsx)("mesh",{ref:t,position:[e.t[0],e.t[1],e.t[2]],quaternion:[e.q[0],e.q[1],e.q[2],e.q[3]],name:"loaded",children:(0,r.jsx)("axesHelper",{args:[e.length]})})},H=function(e){if(!1===e.display)return(0,r.jsx)(r.Fragment,{});switch(e.stype){case"mesh":return(0,r.jsx)(U,M({},e));case"axes":return(0,r.jsx)(G,M({},e));case"box":case"cylinder":case"sphere":default:return(0,r.jsx)(z,M({},e))}};function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}l.Object3D.DefaultUp.set(0,0,1);var Q=(0,u.lazy)((function(){return n.e(424).then(n.bind(n,2424))})),X=function(e){return(0,r.jsx)("group",{children:e.meshes.map((function(e,t){return(0,r.jsx)(H,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e),t)}))})},K=u.forwardRef((function(e,t){return(0,r.jsx)("group",{ref:t,children:e.meshes.map((function(e,t){return(0,r.jsx)(X,{meshes:e},t)}))})})),W=u.createContext(null),A=function(e){var t=(0,u.useState)(!1),n=t[0],s=t[1],a=(0,u.useState)(0),i=a[0],o=a[1],f=(0,u.useState)("60 fps"),p=f[0],m=(f[1],(0,u.useState)([0,0,0,0,0,0,0,0,0,0])),h=m[0],v=(m[1],(0,u.useState)(0)),j=v[0],b=(v[1],(0,u.useRef)()),_=(0,u.useRef)(null),y=(0,u.useState)([]),w=y[0],S=y[1],g=(0,u.useState)(!1),O=g[0],k=g[1],D=(0,u.useReducer)(R,{formData:{},formElements:[]}),N=D[0],E=D[1],B=(0,u.useCallback)((function(e){var t=(0,c.Z)(h),n=j,r=0;(n+=1)>=10&&(n=0),t[n]=e;for(var s=0;s<10;s++)r+=t[s];r=Math.round(r/10)}),[]);return(0,u.useEffect)((function(){s(!0);var t=e.port;0===t&&(t=parseInt(window.location.search.substring(1))),t||(t=0),_.current=new WebSocket("ws://localhost:"+t+"/"),_.current.onopen=function(){_.current.onclose=function(){setTimeout((function(){window.close()}),5e3)},_.current.send("Connected"),k(!0)}}),[]),(0,u.useEffect)((function(){_.current.onmessage=function(e){var t=JSON.parse(e.data),n=t[0],r=t[1];switch(n){case"shape_mounted":var s=r[0],a=r[1];try{var i=0;b.current.children[s].children.forEach((function(e,t){"loaded"===e.name&&i++})),i===a?_.current.send("1"):_.current.send("0")}catch(f){_.current.send("0")}break;case"shape":var u=w.length.toString();S([].concat((0,c.Z)(w),[r])),_.current.send(u);break;case"remove":var d=(0,c.Z)(w);d[r]=[],S(d),_.current.send("0");break;case"shape_poses":0!==Object.keys(N.formData).length?(_.current.send(JSON.stringify(N.formData)),E({type:"reset",indices:Object.keys(N.formData)})):_.current.send("[]"),r.forEach((function(e){var t=e[0];e[1].forEach((function(e,n){b.current.children[t].children[n].position.set(e.t[0],e.t[1],e.t[2]);var r=new l.Quaternion(e.q[0],e.q[1],e.q[2],e.q[3]);b.current.children[t].children[n].setRotationFromQuaternion(r)}))}));break;case"sim_time":o(parseFloat(r));break;case"close":_.current.close(),window.close();break;case"element":E({type:"newElement",data:r}),_.current.send("0");break;case"update_element":E({type:"wsUpdate",index:r.id,data:r})}}})),(0,r.jsxs)("div",{className:C().swiftContainer,children:[(0,r.jsxs)(W.Provider,{value:E,children:[(0,r.jsx)(x,{time:i,FPS:p,connected:O}),(0,r.jsx)(P,{elements:N.formElements})]}),(0,r.jsxs)(d.Xz,{gl:{antialias:!0},shadowMap:{enabled:!0},children:[(0,r.jsx)(L,{setDefault:!0,fpsCallBack:B}),n&&(0,r.jsx)(u.Suspense,{fallback:null,children:(0,r.jsx)(Q,{})}),(0,r.jsx)("hemisphereLight",{skyColor:new l.Color(4469555),groundColor:new l.Color(1118498)}),(0,r.jsx)(V,{x:10,y:10,z:10,color:16777215,intensity:.2}),(0,r.jsx)(V,{x:-10,y:-10,z:10,color:16777215,intensity:.2}),(0,r.jsx)(F,{}),(0,r.jsx)("axesHelper",{args:[100]}),(0,r.jsx)(K,{meshes:w,ref:b})]})]})},Y=function(){return(0,r.jsxs)("div",{className:i().container,children:[(0,r.jsxs)(s.default,{children:[(0,r.jsx)("title",{children:"Swift"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,r.jsx)("main",{className:i().main,children:(0,r.jsx)("div",{className:i().container,children:(0,r.jsx)(A,{port:0})})})]})}},5301:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(5791)}])},5323:function(e){e.exports={container:"Home_container__1EcsU",main:"Home_main__1x8gC"}},8779:function(e){e.exports={swiftContainer:"Swift_swiftContainer__2t_ik"}},3400:function(e){e.exports={sidenav:"SwiftBar_sidenav__2qUJI",buttonDiv:"SwiftBar_buttonDiv__ya3jP",buttonButton:"SwiftBar_buttonButton__2unEE",labelDiv:"SwiftBar_labelDiv__ln7h4",sliderDiv:"SwiftBar_sliderDiv__1zlP7",sliderValDiv:"SwiftBar_sliderValDiv__1RlAS",sliderVals:"SwiftBar_sliderVals__2fFu5",sliderMin:"SwiftBar_sliderMin__3fW5S",sliderVal:"SwiftBar_sliderVal__2bJDq",sliderMax:"SwiftBar_sliderMax__tFr-g",sliderP:"SwiftBar_sliderP__oD57f",slider:"SwiftBar_slider__3ckm0",selectDiv:"SwiftBar_selectDiv__Bgu8m",selectLabel:"SwiftBar_selectLabel__2sF0j",selectSelect:"SwiftBar_selectSelect__UV6V5",checkboxDiv:"SwiftBar_checkboxDiv__3kuGX",checkboxLabel:"SwiftBar_checkboxLabel__3DiR3",checkboxCont:"SwiftBar_checkboxCont__1tEm3",radioDiv:"SwiftBar_radioDiv__3vt-B",radioLabel:"SwiftBar_radioLabel__1ech3",radioCont:"SwiftBar_radioCont__yZ_Ok"}},5975:function(e){e.exports={info:"SwiftInfo_info__IiQj5",fps:"SwiftInfo_fps__2e8I9",simTime:"SwiftInfo_simTime__zqT2x",spacer:"SwiftInfo_spacer__okk8h",button:"SwiftInfo_button__11dRp",svg:"SwiftInfo_svg__31l8w",sr:"SwiftInfo_sr__2BhMk"}}},function(e){e.O(0,[737,735,774,888,179],(function(){return t=5301,e(e.s=t);var t}));var t=e.O();_N_E=t}]);