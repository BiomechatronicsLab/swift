(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[972],{8988:function(e,t,r){"use strict";var n,i;r.d(t,{F:function(){return a}}),e=r.hmd(e),n="undefined"!=typeof self?self:void 0,i=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=18)}([function(e,t,r){function n(e){return e&&0===e.length}function i(e){return null==e?[]:Object.keys(e)}function a(e){for(var t=[],r=Object.keys(e),n=0;n<r.length;n++)t.push(e[r[n]]);return t}function o(e,t){if(Array.isArray(e))for(var r=0;r<e.length;r++)t.call(null,e[r],r);else{if(!v(e))throw Error("non exhaustive match");var n=i(e);for(r=0;r<n.length;r++){var a=n[r],o=e[a];t.call(null,o,a)}}}function s(e){return void 0===e}function u(e,t){var r=[];if(Array.isArray(e))for(var n=0;n<e.length;n++){var i=e[n];t.call(null,i)&&r.push(i)}return r}function c(e,t){return u(e,(function(e){return!t(e)}))}function l(e,t){return!!v(e)&&e.hasOwnProperty(t)}function p(e,t){return void 0!==d(e,(function(e){return e===t}))}function h(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r]);return t}function f(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}function d(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(t.call(null,n))return n}}function m(e,t,r){for(var n=Array.isArray(e),o=n?e:a(e),s=n?[]:i(e),u=r,c=0;c<o.length;c++)u=t.call(null,u,o[c],n?c:s[c]);return u}function v(e){return e instanceof Object}function g(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n++){var a=t[n];if(!s(a))for(var o=i(a),u=0;u<o.length;u++){var c=o[u];l(e,c)||(e[c]=a[c])}}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.isEmpty=n,t.keys=i,t.values=a,t.mapValues=function(e,t){for(var r=[],n=i(e),a=0;a<n.length;a++){var o=n[a];r.push(t.call(null,e[o],o))}return r},t.map=function(e,t){for(var r=[],n=0;n<e.length;n++)r.push(t.call(null,e[n],n));return r},t.flatten=function e(t){for(var r=[],n=0;n<t.length;n++){var i=t[n];Array.isArray(i)?r=r.concat(e(i)):r.push(i)}return r},t.first=function(e){return n(e)?void 0:e[0]},t.last=function(e){var t=e&&e.length;return t?e[t-1]:void 0},t.forEach=o,t.isString=function(e){return"string"==typeof e},t.isUndefined=s,t.isFunction=function(e){return e instanceof Function},t.drop=function(e,t){return void 0===t&&(t=1),e.slice(t,e.length)},t.dropRight=function(e,t){return void 0===t&&(t=1),e.slice(0,e.length-t)},t.filter=u,t.reject=c,t.pick=function(e,t){for(var r=Object.keys(e),n={},i=0;i<r.length;i++){var a=r[i],o=e[a];t(o)&&(n[a]=o)}return n},t.has=l,t.contains=p,t.cloneArr=h,t.cloneObj=f,t.find=d,t.findAll=function(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n];t.call(null,i)&&r.push(i)}return r},t.reduce=m,t.compact=function(e){return c(e,(function(e){return null==e}))},t.uniq=function(e,t){void 0===t&&(t=function(e){return e});var r=[];return m(e,(function(e,n){var i=t(n);return p(r,i)?e:(r.push(i),e.concat(n))}),[])},t.partial=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=[null].concat(t);return Function.bind.apply(e,n)},t.isArray=function(e){return Array.isArray(e)},t.isRegExp=function(e){return e instanceof RegExp},t.isObject=v,t.every=function(e,t){for(var r=0;r<e.length;r++)if(!t(e[r],r))return!1;return!0},t.difference=function(e,t){return c(e,(function(e){return p(t,e)}))},t.some=function(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return!0;return!1},t.indexOf=function(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return r;return-1},t.sortBy=function(e,t){var r=h(e);return r.sort((function(e,r){return t(e)-t(r)})),r},t.zipObject=function(e,t){if(e.length!==t.length)throw Error("can't zipObject with different number of keys and values!");for(var r={},n=0;n<e.length;n++)r[e[n]]=t[n];return r},t.assign=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n++)for(var a=t[n],o=i(a),s=0;s<o.length;s++){var u=o[s];e[u]=a[u]}return e},t.assignNoOverwrite=g,t.defaults=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return g.apply(null,[{}].concat(e))},t.groupBy=function(e,t){var r={};return o(e,(function(e){var n=t(e),i=r[n];i?i.push(e):r[n]=[e]})),r},t.merge=function(e,t){for(var r=f(e),n=i(t),a=0;a<n.length;a++){var o=n[a],s=t[o];r[o]=s}return r},t.NOOP=function(){},t.IDENTITY=function(e){return e},t.packArray=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t.push(void 0!==n?n:void 0)}return t},t.PRINT_ERROR=function(e){console&&console.error&&console.error("Error: "+e)},t.PRINT_WARNING=function(e){console&&console.warn&&console.warn("Warning: "+e)},t.isES2015MapSupported=function(){return"function"==typeof Map},t.applyMixins=function(e,t){t.forEach((function(t){var r=t.prototype;Object.getOwnPropertyNames(r).forEach((function(n){if("constructor"!==n){var i=Object.getOwnPropertyDescriptor(r,n);i&&(i.get||i.set)?Object.defineProperty(e.prototype,n,i):e.prototype[n]=t.prototype[n]}}))}))},t.toFastProperties=function(e){function t(){}t.prototype=e;var r=new t;function n(){return typeof r.bar}return n(),n(),e}},function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=r(2),s=function(){function e(e){this.definition=e}return e.prototype.accept=function(e){e.visit(this),a.forEach(this.definition,(function(t){t.accept(e)}))},e}();t.AbstractProduction=s;var u=function(e){function t(t){var r=e.call(this,[])||this;return r.idx=1,a.assign(r,a.pick(t,(function(e){return void 0!==e}))),r}return i(t,e),Object.defineProperty(t.prototype,"definition",{get:function(){return void 0!==this.referencedRule?this.referencedRule.definition:[]},set:function(e){},enumerable:!0,configurable:!0}),t.prototype.accept=function(e){e.visit(this)},t}(s);t.NonTerminal=u;var c=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.orgText="",a.assign(r,a.pick(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(s);t.Rule=c;var l=function(e){function t(t){var r=e.call(this,t.definition)||this;return a.assign(r,a.pick(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(s);t.Flat=l;var p=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,a.assign(r,a.pick(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(s);t.Option=p;var h=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,a.assign(r,a.pick(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(s);t.RepetitionMandatory=h;var f=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,a.assign(r,a.pick(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(s);t.RepetitionMandatoryWithSeparator=f;var d=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,a.assign(r,a.pick(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(s);t.Repetition=d;var m=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,a.assign(r,a.pick(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(s);t.RepetitionWithSeparator=m;var v=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,a.assign(r,a.pick(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(s);t.Alternation=v;var g=function(){function e(e){this.idx=1,a.assign(this,a.pick(e,(function(e){return void 0!==e})))}return e.prototype.accept=function(e){e.visit(this)},e}();function y(e){function t(e){return a.map(e,y)}if(e instanceof u)return{type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};if(e instanceof l)return{type:"Flat",definition:t(e.definition)};if(e instanceof p)return{type:"Option",idx:e.idx,definition:t(e.definition)};if(e instanceof h)return{type:"RepetitionMandatory",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof f)return{type:"RepetitionMandatoryWithSeparator",name:e.name,idx:e.idx,separator:y(new g({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof m)return{type:"RepetitionWithSeparator",name:e.name,idx:e.idx,separator:y(new g({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof d)return{type:"Repetition",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof v)return{type:"Alternation",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof g){var r={type:"Terminal",name:o.tokenName(e.terminalType),label:o.tokenLabel(e.terminalType),idx:e.idx},n=e.terminalType.PATTERN;return e.terminalType.PATTERN&&(r.pattern=a.isRegExp(n)?n.source:n),r}if(e instanceof c)return{type:"Rule",name:e.name,orgText:e.orgText,definition:t(e.definition)};throw Error("non exhaustive match")}t.Terminal=g,t.serializeGrammar=function(e){return a.map(e,y)},t.serializeProduction=y},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(4),a=r(15),o=r(7);function s(e){return n.isString(e.LABEL)&&""!==e.LABEL}function u(e){return n.isObject(e)&&e.hasOwnProperty("tokenName")&&n.isString(e.tokenName)?e.tokenName:i.functionName(e)}t.tokenLabel=function(e){return s(e)?e.LABEL:u(e)},t.hasTokenLabel=s,t.tokenName=u;var c="categories",l="label",p="group",h="push_mode",f="pop_mode",d="longer_alt",m="line_breaks",v="start_chars_hint";function g(e){return function(e){var t=e.name,r=e.pattern,a={};if(i.defineNameProp(a,t)||(a.tokenName=t),n.isUndefined(r)||(a.PATTERN=r),n.has(e,"parent"))throw"The parent property is no longer supported.\nSee: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.";return n.has(e,c)&&(a.CATEGORIES=e[c]),o.augmentTokenTypes([a]),n.has(e,l)&&(a.LABEL=e[l]),n.has(e,p)&&(a.GROUP=e[p]),n.has(e,f)&&(a.POP_MODE=e[f]),n.has(e,h)&&(a.PUSH_MODE=e[h]),n.has(e,d)&&(a.LONGER_ALT=e[d]),n.has(e,m)&&(a.LINE_BREAKS=e[m]),n.has(e,v)&&(a.START_CHARS_HINT=e[v]),a}(e)}t.createToken=g,t.EOF=g({name:"EOF",pattern:a.Lexer.NA}),o.augmentTokenTypes([t.EOF]),t.createTokenInstance=function(e,t,r,n,i,a,o,s){return{image:t,startOffset:r,endOffset:n,startLine:i,endLine:a,startColumn:o,endColumn:s,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}},t.tokenMatcher=function(e,t){return o.tokenStructuredMatcher(e,t)}},function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(4),o=r(0),s=r(26),u=r(2),c=r(23),l=r(16),p=r(10),h=r(24),f=r(25),d=r(31),m=r(32),v=r(34),g=r(35),y=r(36),T=r(37),E=r(38);t.END_OF_FILE=u.createTokenInstance(u.EOF,"",NaN,NaN,NaN,NaN,NaN,NaN),Object.freeze(t.END_OF_FILE),t.DEFAULT_PARSER_CONFIG=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:p.defaultParserErrorProvider,serializedGrammar:null}),t.DEFAULT_RULE_CONFIG=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0}),function(e){e[e.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",e[e.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",e[e.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",e[e.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",e[e.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",e[e.LEFT_RECURSION=5]="LEFT_RECURSION",e[e.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",e[e.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",e[e.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",e[e.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",e[e.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",e[e.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",e[e.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",e[e.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",e[e.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"}(t.ParserDefinitionErrorType||(t.ParserDefinitionErrorType={})),t.EMPTY_ALT=function(e){return void 0===e&&(e=void 0),function(){return e}};var A=function(){function e(e,r){void 0===r&&(r=t.DEFAULT_PARSER_CONFIG),this.ignoredIssues=t.DEFAULT_PARSER_CONFIG.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1,this.initErrorHandler(r),this.initLexerAdapter(),this.initLooksAhead(r),this.initRecognizerEngine(e,r),this.initRecoverable(r),this.initTreeBuilder(r),this.initContentAssist(),this.ignoredIssues=o.has(r,"ignoredIssues")?r.ignoredIssues:t.DEFAULT_PARSER_CONFIG.ignoredIssues,o.toFastProperties(this)}return e.performSelfAnalysis=function(e){e.performSelfAnalysis()},e.prototype.performSelfAnalysis=function(){var t,r=this;this.selfAnalysisDone=!0;var n=a.classNameFromInstance(this),i=this.gastProductionsCache;if(this.serializedGrammar){var u=c.deserializeGrammar(this.serializedGrammar,this.tokensMap);o.forEach(u,(function(e){r.gastProductionsCache.put(e.name,e)}))}var f=h.resolveGrammar({rules:i.values()});if(this.definitionErrors.push.apply(this.definitionErrors,f),o.isEmpty(f)){var d=h.validateGrammar({rules:i.values(),maxLookahead:this.maxLookahead,tokenTypes:o.values(this.tokensMap),ignoredIssues:this.ignoredIssues,errMsgProvider:p.defaultGrammarValidatorErrorProvider,grammarName:n});this.definitionErrors.push.apply(this.definitionErrors,d)}if(o.isEmpty(this.definitionErrors)){var m=s.computeAllProdsFollows(i.values());this.resyncFollows=m}var v=l.analyzeCst(i.values(),this.fullRuleNameToShort);if(this.allRuleNames=v.allRuleNames,!e.DEFER_DEFINITION_ERRORS_HANDLING&&!o.isEmpty(this.definitionErrors))throw t=o.map(this.definitionErrors,(function(e){return e.message})),new Error("Parser Definition Errors detected:\n "+t.join("\n-------------------------------\n"))},e.DEFER_DEFINITION_ERRORS_HANDLING=!1,e}();t.Parser=A,o.applyMixins(A,[f.Recoverable,d.LooksAhead,m.TreeBuilder,v.LexerAdapter,y.RecognizerEngine,g.RecognizerApi,T.ErrorHandler,E.ContentAssist]);var x=function(e){function r(r,n){void 0===n&&(n=t.DEFAULT_PARSER_CONFIG);var i=o.cloneObj(n);return i.outputCst=!0,e.call(this,r,i)||this}return i(r,e),r}(A);t.CstParser=x;var b=function(e){function r(r,n){void 0===n&&(n=t.DEFAULT_PARSER_CONFIG);var i=o.cloneObj(n);return i.outputCst=!1,e.call(this,r,i)||this}return i(r,e),r}(A);t.EmbeddedActionsParser=b},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.classNameFromInstance=function(e){return o(e.constructor)};var i=/^\s*function\s*(\S*)\s*\(/,a="name";function o(e){return e.name||e.toString().match(i)[1]}t.functionName=o,t.defineNameProp=function(e,t){var r=Object.getOwnPropertyDescriptor(e,a);return!(!n.isUndefined(r)&&!r.configurable||(Object.defineProperty(e,a,{enumerable:!1,configurable:!0,writable:!1,value:t}),0))};var s=function(){function e(){this._state={}}return e.prototype.keys=function(){return n.keys(this._state)},e.prototype.values=function(){return n.values(this._state)},e.prototype.put=function(e,t){this._state[e]=t},e.prototype.putAll=function(e){this._state=n.assign(this._state,e._state)},e.prototype.get=function(e){return this._state[e]},e.prototype.containsKey=function(e){return n.has(this._state,e)},e.prototype.clear=function(){this._state={}},e}();t.HashTable=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=function(){function e(){}return e.prototype.visit=function(e){if(e instanceof n.NonTerminal)return this.visitNonTerminal(e);if(e instanceof n.Flat)return this.visitFlat(e);if(e instanceof n.Option)return this.visitOption(e);if(e instanceof n.RepetitionMandatory)return this.visitRepetitionMandatory(e);if(e instanceof n.RepetitionMandatoryWithSeparator)return this.visitRepetitionMandatoryWithSeparator(e);if(e instanceof n.RepetitionWithSeparator)return this.visitRepetitionWithSeparator(e);if(e instanceof n.Repetition)return this.visitRepetition(e);if(e instanceof n.Alternation)return this.visitAlternation(e);if(e instanceof n.Terminal)return this.visitTerminal(e);if(e instanceof n.Rule)return this.visitRule(e);throw Error("non exhaustive match")},e.prototype.visitNonTerminal=function(e){},e.prototype.visitFlat=function(e){},e.prototype.visitOption=function(e){},e.prototype.visitRepetition=function(e){},e.prototype.visitRepetitionMandatory=function(e){},e.prototype.visitRepetitionMandatoryWithSeparator=function(e){},e.prototype.visitRepetitionWithSeparator=function(e){},e.prototype.visitAlternation=function(e){},e.prototype.visitTerminal=function(e){},e.prototype.visitRule=function(e){},e}();t.GAstVisitor=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i="MismatchedTokenException",a="NoViableAltException",o="EarlyExitException",s="NotAllInputParsedException",u=[i,a,o,s];function c(e,t,r){this.name=i,this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}function l(e,t,r){this.name=a,this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}function p(e,t){this.name=s,this.message=e,this.token=t,this.resyncedTokens=[]}function h(e,t,r){this.name=o,this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}Object.freeze(u),t.isRecognitionException=function(e){return n.contains(u,e.name)},t.MismatchedTokenException=c,c.prototype=Error.prototype,t.NoViableAltException=l,l.prototype=Error.prototype,t.NotAllInputParsedException=p,p.prototype=Error.prototype,t.EarlyExitException=h,h.prototype=Error.prototype},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(4),a=r(2);function o(e){for(var t=n.cloneArr(e),r=e,i=!0;i;){r=n.compact(n.flatten(n.map(r,(function(e){return e.CATEGORIES}))));var a=n.difference(r,t);t=t.concat(a),n.isEmpty(a)?i=!1:r=a}return t}function s(e){n.forEach(e,(function(e){p(e)||(t.tokenIdxToClass.put(t.tokenShortNameIdx,e),e.tokenTypeIdx=t.tokenShortNameIdx++),h(e)&&!n.isArray(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),h(e)||(e.CATEGORIES=[]),f(e)||(e.categoryMatches=[]),d(e)||(e.categoryMatchesMap={}),m(e)||(e.tokenName=a.tokenName(e))}))}function u(e){n.forEach(e,(function(e){e.categoryMatches=[],n.forEach(e.categoryMatchesMap,(function(r,n){e.categoryMatches.push(t.tokenIdxToClass.get(n).tokenTypeIdx)}))}))}function c(e){n.forEach(e,(function(e){l([],e)}))}function l(e,t){n.forEach(e,(function(e){t.categoryMatchesMap[e.tokenTypeIdx]=!0})),n.forEach(t.CATEGORIES,(function(r){var i=e.concat(t);n.contains(i,r)||l(i,r)}))}function p(e){return n.has(e,"tokenTypeIdx")}function h(e){return n.has(e,"CATEGORIES")}function f(e){return n.has(e,"categoryMatches")}function d(e){return n.has(e,"categoryMatchesMap")}function m(e){return n.has(e,"tokenName")}t.tokenStructuredMatcher=function(e,t){var r=e.tokenTypeIdx;return r===t.tokenTypeIdx||!0===t.isParent&&!0===t.categoryMatchesMap[r]},t.tokenStructuredMatcherNoCategories=function(e,t){return e.tokenTypeIdx===t.tokenTypeIdx},t.tokenShortNameIdx=1,t.tokenIdxToClass=new i.HashTable,t.augmentTokenTypes=function(e){var t=o(e);s(t),c(t),u(t),n.forEach(t,(function(e){e.isParent=e.categoryMatches.length>0}))},t.expandCategories=o,t.assignTokenDefaultProps=s,t.assignCategoriesTokensProp=u,t.assignCategoriesMapProp=c,t.singleAssignCategoriesToksMap=l,t.hasShortKeyProperty=p,t.hasCategoriesProperty=h,t.hasExtendingTokensTypesProperty=f,t.hasExtendingTokensTypesMapProperty=d,t.hasTokenNameProperty=m,t.isTokenType=function(e){return n.has(e,"tokenTypeIdx")}},function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=r(1),s=r(5),u=r(2);t.isSequenceProd=function(e){return e instanceof o.Flat||e instanceof o.Option||e instanceof o.Repetition||e instanceof o.RepetitionMandatory||e instanceof o.RepetitionMandatoryWithSeparator||e instanceof o.RepetitionWithSeparator||e instanceof o.Terminal||e instanceof o.Rule},t.isOptionalProd=function e(t,r){return void 0===r&&(r=[]),!!(t instanceof o.Option||t instanceof o.Repetition||t instanceof o.RepetitionWithSeparator)||(t instanceof o.Alternation?a.some(t.definition,(function(t){return e(t,r)})):!(t instanceof o.NonTerminal&&a.contains(r,t))&&t instanceof o.AbstractProduction&&(t instanceof o.NonTerminal&&r.push(t),a.every(t.definition,(function(t){return e(t,r)}))))},t.isBranchingProd=function(e){return e instanceof o.Alternation},t.getProductionDslName=function(e){if(e instanceof o.NonTerminal)return"SUBRULE";if(e instanceof o.Option)return"OPTION";if(e instanceof o.Alternation)return"OR";if(e instanceof o.RepetitionMandatory)return"AT_LEAST_ONE";if(e instanceof o.RepetitionMandatoryWithSeparator)return"AT_LEAST_ONE_SEP";if(e instanceof o.RepetitionWithSeparator)return"MANY_SEP";if(e instanceof o.Repetition)return"MANY";if(e instanceof o.Terminal)return"CONSUME";throw Error("non exhaustive match")};var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return i(t,e),t.prototype.visitTerminal=function(e){var t=u.tokenName(e.terminalType)+this.separator+"Terminal";a.has(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitNonTerminal=function(e){var t=e.nonTerminalName+this.separator+"Terminal";a.has(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitOption=function(e){this.dslMethods.option.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.dslMethods.repetitionWithSeparator.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.dslMethods.repetitionMandatory.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)},t.prototype.visitRepetition=function(e){this.dslMethods.repetition.push(e)},t.prototype.visitAlternation=function(e){this.dslMethods.alternation.push(e)},t}(s.GAstVisitor);t.DslMethodsCollectorVisitor=c},function(e,t,r){function n(e,t,r){return r|t|e}Object.defineProperty(t,"__esModule",{value:!0}),t.BITS_FOR_METHOD_IDX=4,t.BITS_FOR_OCCURRENCE_IDX=4,t.BITS_FOR_RULE_IDX=24,t.BITS_FOR_ALT_IDX=8,t.OR_IDX=1<<t.BITS_FOR_METHOD_IDX,t.OPTION_IDX=2<<t.BITS_FOR_METHOD_IDX,t.MANY_IDX=3<<t.BITS_FOR_METHOD_IDX,t.AT_LEAST_ONE_IDX=4<<t.BITS_FOR_METHOD_IDX,t.MANY_SEP_IDX=5<<t.BITS_FOR_METHOD_IDX,t.AT_LEAST_ONE_SEP_IDX=6<<t.BITS_FOR_METHOD_IDX,t.getKeyForAutomaticLookahead=n;var i=32-t.BITS_FOR_ALT_IDX;t.getKeyForAltIndex=function(e,t,r,a){var o=a+1<<i;return n(e,t,r)|o}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(0),a=r(0),o=r(1),s=r(8),u=r(11),c=r(17),l=r(3);t.defaultParserErrorProvider={buildMismatchTokenMessage:function(e){var t=e.expected,r=e.actual;return e.previous,e.ruleName,"Expecting "+(n.hasTokenLabel(t)?"--\x3e "+n.tokenLabel(t)+" <--":"token of type --\x3e "+n.tokenName(t)+" <--")+" but found --\x3e '"+r.image+"' <--"},buildNotAllInputParsedMessage:function(e){var t=e.firstRedundant;return e.ruleName,"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage:function(e){var t=e.expectedPathsPerAlt,r=e.actual,i=(e.previous,e.customUserDescription),o=(e.ruleName,"\nbut found: '"+a.first(r).image+"'");if(i)return"Expecting: "+i+o;var s=a.reduce(t,(function(e,t){return e.concat(t)}),[]),u=a.map(s,(function(e){return"["+a.map(e,(function(e){return n.tokenLabel(e)})).join(", ")+"]"}));return"Expecting: one of these possible Token sequences:\n"+a.map(u,(function(e,t){return"  "+(t+1)+". "+e})).join("\n")+o},buildEarlyExitMessage:function(e){var t=e.expectedIterationPaths,r=e.actual,i=e.customUserDescription,o=(e.ruleName,"\nbut found: '"+a.first(r).image+"'");return i?"Expecting: "+i+o:"Expecting: expecting at least one iteration which starts with one of these possible Token sequences::\n  <"+a.map(t,(function(e){return"["+a.map(e,(function(e){return n.tokenLabel(e)})).join(",")+"]"})).join(" ,")+">"+o}},Object.freeze(t.defaultParserErrorProvider),t.defaultGrammarResolverErrorProvider={buildRuleNotFoundError:function(e,t){return"Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+"<-\ninside top level rule: ->"+e.name+"<-"}},t.defaultGrammarValidatorErrorProvider={buildDuplicateFoundError:function(e,t){var r,i=e.name,u=a.first(t),c=u.idx,l=s.getProductionDslName(u),p=(r=u)instanceof o.Terminal?n.tokenName(r.terminalType):r instanceof o.NonTerminal?r.nonTerminalName:"",h="->"+l+"<- with numerical suffix: ->"+c+"<-\n                  "+(p?"and argument: ->"+p+"<-":"")+"\n                  appears more than once ("+t.length+" times) in the top level rule: ->"+i+"<-.\n                  "+(0===c?"Also note that numerical suffix 0 means "+l+" without any suffix.":"")+"\n                  To fix this make sure each usage of "+l+" "+(p?"with the argument: ->"+p+"<-":"")+"\n                  in the rule ->"+i+"<- has a different occurrence index (0-5), as that combination acts as a unique\n                  position key in the grammar, which is needed by the parsing engine.\n                  \n                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  ";return(h=h.replace(/[ \t]+/g," ")).replace(/\s\s+/g,"\n")},buildInvalidNestedRuleNameError:function(e,t){return"Invalid nested rule name: ->"+t.name+"<- inside rule: ->"+e.name+"<-\nit must match the pattern: ->"+u.validNestedRuleName.toString()+"<-.\nNote that this means a nested rule name must start with the '$'(dollar) sign."},buildDuplicateNestedRuleNameError:function(e,t){return"Duplicate nested rule name: ->"+a.first(t).name+"<- inside rule: ->"+e.name+"<-\nA nested name must be unique in the scope of a top level grammar rule."},buildNamespaceConflictError:function(e){return"Namespace conflict found in grammar.\nThe grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+e.name+">.\nTo resolve this make sure each Terminal and Non-Terminal names are unique\nThis is easy to accomplish by using the convention that Terminal names start with an uppercase letter\nand Non-Terminal names start with a lower case letter."},buildAlternationPrefixAmbiguityError:function(e){var t=a.map(e.prefixPath,(function(e){return n.tokenLabel(e)})).join(", "),r=0===e.alternation.idx?"":e.alternation.idx;return"Ambiguous alternatives: <"+e.ambiguityIndices.join(" ,")+"> due to common lookahead prefix\nin <OR"+r+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\nhttps://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\nFor Further details."},buildAlternationAmbiguityError:function(e){var t=a.map(e.prefixPath,(function(e){return n.tokenLabel(e)})).join(", "),r=0===e.alternation.idx?"":e.alternation.idx,i="Ambiguous alternatives: <"+e.ambiguityIndices.join(" ,")+"> in <OR"+r+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\n",o=c.VERSION.replace(/\./g,"_");return i+"To Resolve this, try one of of the following: \n1. Refactor your grammar to be LL(K) for the current value of k (by default k="+l.DEFAULT_PARSER_CONFIG.maxLookahead+"})\n2. Increase the value of K for your grammar by providing a larger 'maxLookahead' value in the parser's config\n3. This issue can be ignored (if you know what you are doing...), see https://sap.github.io/chevrotain/documentation/"+o+"/interfaces/iparserconfig.html#ignoredissues for more details\n"},buildEmptyRepetitionError:function(e){var t=s.getProductionDslName(e.repetition);return 0!==e.repetition.idx&&(t+=e.repetition.idx),"The repetition <"+t+"> within Rule <"+e.topLevelRule.name+"> can never consume any tokens.\nThis could lead to an infinite loop."},buildTokenNameError:function(e){return"Invalid Grammar Token name: ->"+n.tokenName(e.tokenType)+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildEmptyAlternationError:function(e){return"Ambiguous empty alternative: <"+(e.emptyChoiceIdx+1)+"> in <OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\nOnly the last alternative may be an empty alternative."},buildTooManyAlternativesError:function(e){return"An Alternation cannot have more than 256 alternatives:\n<OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\n has "+(e.alternation.definition.length+1)+" alternatives."},buildLeftRecursionError:function(e){var t=e.topLevelRule.name;return"Left Recursion found in grammar.\nrule: <"+t+"> can be invoked from itself (directly or indirectly)\nwithout consuming any Tokens. The grammar path that causes this is: \n "+t+" --\x3e "+i.map(e.leftRecursionPath,(function(e){return e.name})).concat([t]).join(" --\x3e ")+"\n To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring."},buildInvalidRuleNameError:function(e){return"Invalid grammar rule name: ->"+e.topLevelRule.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildDuplicateRuleNameError:function(e){return"Duplicate definition, rule: ->"+(e.topLevelRule instanceof o.Rule?e.topLevelRule.name:e.topLevelRule)+"<- is already defined in the grammar: ->"+e.grammarName+"<-"}}},function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=r(0),s=r(3),u=r(8),c=r(2),l=r(12),p=r(16),h=r(13),f=r(1),d=r(5);function m(e){return u.getProductionDslName(e)+"_#_"+e.idx+"_#_"+v(e)}function v(e){return e instanceof f.Terminal?c.tokenName(e.terminalType):e instanceof f.NonTerminal?e.nonTerminalName:""}t.validateGrammar=function(e,t,r,n,i,l){var h=a.map(e,(function(e){return function(e,t){var r=new g;e.accept(r);var n=r.allProductions,i=a.groupBy(n,m),o=a.pick(i,(function(e){return e.length>1}));return a.map(a.values(o),(function(r){var n=a.first(r),i=t.buildDuplicateFoundError(e,r),o=u.getProductionDslName(n),c={message:i,type:s.ParserDefinitionErrorType.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:o,occurrence:n.idx},l=v(n);return l&&(c.parameter=l),c}))}(e,i)})),f=a.map(e,(function(e){return x(e,e,i)})),d=[],b=[],R=[];o.every(f,o.isEmpty)&&(d=o.map(e,(function(e){return w(e,i)})),b=o.map(e,(function(e){return N(e,t,n,i)})),R=_(e,t,i));var S=function(e,t,r){var n=[],i=o.map(t,(function(e){return c.tokenName(e)}));return o.forEach(e,(function(e){var t=e.name;if(o.contains(i,t)){var a=r.buildNamespaceConflictError(e);n.push({message:a,type:s.ParserDefinitionErrorType.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:t})}})),n}(e,r,i),L=a.map(r,(function(e){return E(e,i)})),I=function(e,t){var r=[];return o.forEach(e,(function(e){var n=new p.NamedDSLMethodsCollectorVisitor("");e.accept(n);var i=o.map(n.result,(function(e){return e.orgProd}));r.push(o.map(i,(function(r){return T(e,r,t)})))})),o.flatten(r)}(e,i),O=function(e,t){var r=[];return o.forEach(e,(function(e){var n=new p.NamedDSLMethodsCollectorVisitor("");e.accept(n);var i=o.groupBy(n.result,(function(e){return e.name})),a=o.pick(i,(function(e){return e.length>1}));o.forEach(o.values(a),(function(n){var i=o.map(n,(function(e){return e.orgProd})),a=t.buildDuplicateNestedRuleNameError(e,i);r.push({message:a,type:s.ParserDefinitionErrorType.DUPLICATE_NESTED_NAME,ruleName:e.name})}))})),r}(e,i),M=o.map(e,(function(e){return k(e,i)})),C=o.map(e,(function(e){return y(e,i)})),P=o.map(e,(function(t){return A(t,e,l,i)}));return a.flatten(h.concat(L,I,O,R,f,d,b,S,M,C,P))},t.identifyProductionForDuplicates=m;var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return i(t,e),t.prototype.visitNonTerminal=function(e){this.allProductions.push(e)},t.prototype.visitOption=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t.prototype.visitAlternation=function(e){this.allProductions.push(e)},t.prototype.visitTerminal=function(e){this.allProductions.push(e)},t}(d.GAstVisitor);function y(e,r){var n=[],i=e.name;return i.match(t.validTermsPattern)||n.push({message:r.buildInvalidRuleNameError({topLevelRule:e,expectedPattern:t.validTermsPattern}),type:s.ParserDefinitionErrorType.INVALID_RULE_NAME,ruleName:i}),n}function T(e,r,n){var i,a=[];return r.name.match(t.validNestedRuleName)||(i=n.buildInvalidNestedRuleNameError(e,r),a.push({message:i,type:s.ParserDefinitionErrorType.INVALID_NESTED_RULE_NAME,ruleName:e.name})),a}function E(e,r){var n=[];return c.tokenName(e).match(t.validTermsPattern)||n.push({message:r.buildTokenNameError({tokenType:e,expectedPattern:t.validTermsPattern}),type:s.ParserDefinitionErrorType.INVALID_TOKEN_NAME}),n}function A(e,t,r,n){var i=[];if(o.reduce(t,(function(t,r){return r.name===e.name?t+1:t}),0)>1){var a=n.buildDuplicateRuleNameError({topLevelRule:e,grammarName:r});i.push({message:a,type:s.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:e.name})}return i}function x(e,t,r,n){void 0===n&&(n=[]);var i=[],o=b(t.definition);if(a.isEmpty(o))return[];var u=e.name;a.contains(o,e)&&i.push({message:r.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:n}),type:s.ParserDefinitionErrorType.LEFT_RECURSION,ruleName:u});var c=a.difference(o,n.concat([e])),l=a.map(c,(function(t){var i=a.cloneArr(n);return i.push(t),x(e,t,r,i)}));return i.concat(a.flatten(l))}function b(e){var t=[];if(a.isEmpty(e))return t;var r=a.first(e);if(r instanceof f.NonTerminal)t.push(r.referencedRule);else if(r instanceof f.Flat||r instanceof f.Option||r instanceof f.RepetitionMandatory||r instanceof f.RepetitionMandatoryWithSeparator||r instanceof f.RepetitionWithSeparator||r instanceof f.Repetition)t=t.concat(b(r.definition));else if(r instanceof f.Alternation)t=a.flatten(a.map(r.definition,(function(e){return b(e.definition)})));else if(!(r instanceof f.Terminal))throw Error("non exhaustive match");var n=u.isOptionalProd(r),i=e.length>1;if(n&&i){var o=a.drop(e);return t.concat(b(o))}return t}t.OccurrenceValidationCollector=g,t.validTermsPattern=/^[a-zA-Z_]\w*$/,t.validNestedRuleName=new RegExp(t.validTermsPattern.source.replace("^","^\\$")),t.validateRuleName=y,t.validateNestedRuleName=T,t.validateTokenName=E,t.validateRuleDoesNotAlreadyExist=A,t.validateRuleIsOverridden=function(e,t,r){var n,i=[];return a.contains(t,e)||(n="Invalid rule override, rule: ->"+e+"<- cannot be overridden in the grammar: ->"+r+"<-as it is not defined in any of the super grammars ",i.push({message:n,type:s.ParserDefinitionErrorType.INVALID_RULE_OVERRIDE,ruleName:e})),i},t.validateNoLeftRecursion=x,t.getFirstNoneTerminal=b;var R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.alternations=[],t}return i(t,e),t.prototype.visitAlternation=function(e){this.alternations.push(e)},t}(d.GAstVisitor);function w(e,t){var r=new R;e.accept(r);var n=r.alternations;return a.reduce(n,(function(r,n){var i=a.dropRight(n.definition),o=a.map(i,(function(r,i){var o=h.nextPossibleTokensAfter([r],[],null,1);return a.isEmpty(o)?{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:n,emptyChoiceIdx:i}),type:s.ParserDefinitionErrorType.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:n.idx,alternative:i+1}:null}));return r.concat(a.compact(o))}),[])}function N(e,t,r,n){var i=new R;e.accept(i);var c=i.alternations,p=r[e.name];return p&&(c=o.reject(c,(function(e){return p[u.getProductionDslName(e)+(0===e.idx?"":e.idx)]}))),a.reduce(c,(function(r,i){var u=i.idx,c=l.getLookaheadPathsForOr(u,e,t),p=function(e,t,r,n){var i=[],u=o.reduce(e,(function(t,r,n){return o.forEach(r,(function(r){var a=[n];o.forEach(e,(function(e,t){n!==t&&l.containsPath(e,r)&&a.push(t)})),a.length>1&&!l.containsPath(i,r)&&(i.push(r),t.push({alts:a,path:r}))})),t}),[]);return a.map(u,(function(e){var i=o.map(e.alts,(function(e){return e+1}));return{message:n.buildAlternationAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:i,prefixPath:e.path}),type:s.ParserDefinitionErrorType.AMBIGUOUS_ALTS,ruleName:r.name,occurrence:t.idx,alternatives:[e.alts]}}))}(c,i,e,n),h=L(c,i,e,n);return r.concat(p,h)}),[])}t.validateEmptyOrAlternative=w,t.validateAmbiguousAlternationAlternatives=N;var S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return i(t,e),t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t}(d.GAstVisitor);function k(e,t){var r=new R;e.accept(r);var n=r.alternations;return a.reduce(n,(function(r,n){return n.definition.length>255&&r.push({message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:n}),type:s.ParserDefinitionErrorType.TOO_MANY_ALTS,ruleName:e.name,occurrence:n.idx}),r}),[])}function _(e,t,r){var n=[];return o.forEach(e,(function(e){var i=new S;e.accept(i);var a=i.allProductions;o.forEach(a,(function(i){var a=l.getProdType(i),u=i.idx,c=l.getLookaheadPathsForOptionalProd(u,e,a,t)[0];if(o.isEmpty(o.flatten(c))){var p=r.buildEmptyRepetitionError({topLevelRule:e,repetition:i});n.push({message:p,type:s.ParserDefinitionErrorType.NO_NON_EMPTY_LOOKAHEAD,ruleName:e.name})}}))})),n}function L(e,t,r,n){var i=[],a=o.reduce(e,(function(e,t,r){var n=o.map(t,(function(e){return{idx:r,path:e}}));return e.concat(n)}),[]);return o.forEach(a,(function(e){var u=e.idx,c=e.path,p=o.findAll(a,(function(e){return e.idx<u&&l.isStrictPrefixOfPath(e.path,c)})),h=o.map(p,(function(e){var i=[e.idx+1,u+1],a=0===t.idx?"":t.idx;return{message:n.buildAlternationPrefixAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:i,prefixPath:e.path}),type:s.ParserDefinitionErrorType.AMBIGUOUS_PREFIX_ALTS,ruleName:r.name,occurrence:a,alternatives:i}}));i=i.concat(h)})),i}t.RepetionCollector=S,t.validateTooManyAlts=k,t.validateSomeNonEmptyLookaheadPath=_,t.checkPrefixAlternativesAmbiguities=L},function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a,o=r(0),s=r(13),u=r(14),c=r(7),l=r(1),p=r(5);!function(e){e[e.OPTION=0]="OPTION",e[e.REPETITION=1]="REPETITION",e[e.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",e[e.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",e[e.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",e[e.ALTERNATION=5]="ALTERNATION"}(a=t.PROD_TYPE||(t.PROD_TYPE={})),t.getProdType=function(e){if(e instanceof l.Option)return a.OPTION;if(e instanceof l.Repetition)return a.REPETITION;if(e instanceof l.RepetitionMandatory)return a.REPETITION_MANDATORY;if(e instanceof l.RepetitionMandatoryWithSeparator)return a.REPETITION_MANDATORY_WITH_SEPARATOR;if(e instanceof l.RepetitionWithSeparator)return a.REPETITION_WITH_SEPARATOR;if(e instanceof l.Alternation)return a.ALTERNATION;throw Error("non exhaustive match")},t.buildLookaheadFuncForOr=function(e,t,r,n,i,a){var o=m(e,t,r);return a(o,n,y(o)?c.tokenStructuredMatcherNoCategories:c.tokenStructuredMatcher,i)},t.buildLookaheadFuncForOptionalProd=function(e,t,r,n,i,a){var o=v(e,t,i,r),s=y(o)?c.tokenStructuredMatcherNoCategories:c.tokenStructuredMatcher;return a(o[0],s,n)},t.buildAlternativesLookAheadFunc=function(e,t,r,n){var i=e.length,a=o.every(e,(function(e){return o.every(e,(function(e){return 1===e.length}))}));if(t)return function(t){for(var n=o.map(t,(function(e){return e.GATE})),a=0;a<i;a++){var s=e[a],u=s.length,c=n[a];if(void 0===c||!1!==c.call(this))e:for(var l=0;l<u;l++){for(var p=s[l],h=p.length,f=0;f<h;f++){var d=this.LA(f+1);if(!1===r(d,p[f]))continue e}return a}}};if(a&&!n){var s=o.map(e,(function(e){return o.flatten(e)})),u=o.reduce(s,(function(e,t,r){return o.forEach(t,(function(t){o.has(e,t.tokenTypeIdx)||(e[t.tokenTypeIdx]=r),o.forEach(t.categoryMatches,(function(t){o.has(e,t)||(e[t]=r)}))})),e}),[]);return function(){var e=this.LA(1);return u[e.tokenTypeIdx]}}return function(){for(var t=0;t<i;t++){var n=e[t],a=n.length;e:for(var o=0;o<a;o++){for(var s=n[o],u=s.length,c=0;c<u;c++){var l=this.LA(c+1);if(!1===r(l,s[c]))continue e}return t}}}},t.buildSingleAlternativeLookaheadFunction=function(e,t,r){var n=o.every(e,(function(e){return 1===e.length})),i=e.length;if(n&&!r){var a=o.flatten(e);if(1===a.length&&o.isEmpty(a[0].categoryMatches)){var s=a[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===s}}var u=o.reduce(a,(function(e,t,r){return e[t.tokenTypeIdx]=!0,o.forEach(t.categoryMatches,(function(t){e[t]=!0})),e}),[]);return function(){var e=this.LA(1);return!0===u[e.tokenTypeIdx]}}return function(){e:for(var r=0;r<i;r++){for(var n=e[r],a=n.length,o=0;o<a;o++){var s=this.LA(o+1);if(!1===t(s,n[o]))continue e}return!0}return!1}};var h=function(e){function t(t,r,n){var i=e.call(this)||this;return i.topProd=t,i.targetOccurrence=r,i.targetProdType=n,i}return i(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},t.prototype.checkIsTarget=function(e,t,r,n){return e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.restDef=r.concat(n),!0)},t.prototype.walkOption=function(t,r,n){this.checkIsTarget(t,a.OPTION,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkAtLeastOne=function(t,r,n){this.checkIsTarget(t,a.REPETITION_MANDATORY,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkAtLeastOneSep=function(t,r,n){this.checkIsTarget(t,a.REPETITION_MANDATORY_WITH_SEPARATOR,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkMany=function(t,r,n){this.checkIsTarget(t,a.REPETITION,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkManySep=function(t,r,n){this.checkIsTarget(t,a.REPETITION_WITH_SEPARATOR,r,n)||e.prototype.walkOption.call(this,t,r,n)},t}(u.RestWalker),f=function(e){function t(t,r){var n=e.call(this)||this;return n.targetOccurrence=t,n.targetProdType=r,n.result=[],n}return i(t,e),t.prototype.checkIsTarget=function(e,t){e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.result=e.definition)},t.prototype.visitOption=function(e){this.checkIsTarget(e,a.OPTION)},t.prototype.visitRepetition=function(e){this.checkIsTarget(e,a.REPETITION)},t.prototype.visitRepetitionMandatory=function(e){this.checkIsTarget(e,a.REPETITION_MANDATORY)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.checkIsTarget(e,a.REPETITION_MANDATORY_WITH_SEPARATOR)},t.prototype.visitRepetitionWithSeparator=function(e){this.checkIsTarget(e,a.REPETITION_WITH_SEPARATOR)},t.prototype.visitAlternation=function(e){this.checkIsTarget(e,a.ALTERNATION)},t}(p.GAstVisitor);function d(e,t){function r(e,t){return o.reduce(e,(function(e,r,n){if(n!==t){var i=o.map(r,(function(e){return e.partialPath}));return e.concat(i)}return e}),[])}function n(e,t){return void 0===o.find(e,(function(e){return o.every(t,(function(t,r){return(n=t)===(i=e[r])||n&&i&&(n.categoryMatchesMap[i.tokenTypeIdx]||i.categoryMatchesMap[n.tokenTypeIdx]);var n,i}))}))}function i(e){for(var t=[],r=0;r<e;r++)t.push([]);return t}for(var a=o.map(e,(function(e){return s.possiblePathsFrom([e],1)})),u=i(a.length),c=a,l=1;l<=t;l++){var p=c;c=i(p.length);for(var h=0;h<p.length;h++)for(var f=p[h],d=r(p,h),m=0;m<f.length;m++){var v=f[m].partialPath,y=f[m].suffixDef;if(n(d,v)||o.isEmpty(y)||v.length===t){var T=u[h];g(T,v)||T.push(v)}else{var E=s.possiblePathsFrom(y,l+1,v);c[h]=c[h].concat(E)}}}return u}function m(e,t,r){var n=new f(e,a.ALTERNATION);return t.accept(n),d(n.result,r)}function v(e,t,r,n){var i=new f(e,r);t.accept(i);var a=i.result,o=new h(t,e,r).startWalking();return d([new l.Flat({definition:a}),new l.Flat({definition:o})],n)}function g(e,t){return void 0!==o.find(e,(function(e){return t.length===e.length&&o.every(t,(function(t,r){return t===e[r]||e[r].categoryMatchesMap[t.tokenTypeIdx]}))}))}function y(e){return o.every(e,(function(e){return o.every(e,(function(e){return o.every(e,(function(e){return o.isEmpty(e.categoryMatches)}))}))}))}t.lookAheadSequenceFromAlternatives=d,t.getLookaheadPathsForOr=m,t.getLookaheadPathsForOptionalProd=v,t.containsPath=g,t.isStrictPrefixOfPath=function(e,t){return e.length<t.length&&o.every(e,(function(e,r){var n=t[r];return e===n||n.categoryMatchesMap[e.tokenTypeIdx]}))},t.areTokenCategoriesNotUsed=y},function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(14),o=r(0),s=r(2),u=r(21),c=r(1),l=function(e){function t(t,r){var n=e.call(this)||this;return n.topProd=t,n.path=r,n.possibleTokTypes=[],n.nextProductionName="",n.nextProductionOccurrence=0,n.found=!1,n.isAtEndOfPath=!1,n}return i(t,e),t.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=o.cloneArr(this.path.ruleStack).reverse(),this.occurrenceStack=o.cloneArr(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},t.prototype.walk=function(t,r){void 0===r&&(r=[]),this.found||e.prototype.walk.call(this,t,r)},t.prototype.walkProdRef=function(e,t,r){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){var n=t.concat(r);this.updateExpectedNext(),this.walk(e.referencedRule,n)}},t.prototype.updateExpectedNext=function(){o.isEmpty(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},t}(a.RestWalker);t.AbstractNextPossibleTokensWalker=l;var p=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.path=r,n.nextTerminalName="",n.nextTerminalOccurrence=0,n.nextTerminalName=s.tokenName(n.path.lastTok),n.nextTerminalOccurrence=n.path.lastTokOccurrence,n}return i(t,e),t.prototype.walkTerminal=function(e,t,r){if(this.isAtEndOfPath&&s.tokenName(e.terminalType)===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){var n=t.concat(r),i=new c.Flat({definition:n});this.possibleTokTypes=u.first(i),this.found=!0}},t}(l);t.NextAfterTokenWalker=p;var h=function(e){function t(t,r){var n=e.call(this)||this;return n.topRule=t,n.occurrence=r,n.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},n}return i(t,e),t.prototype.startWalking=function(){return this.walk(this.topRule),this.result},t}(a.RestWalker);t.AbstractNextTerminalAfterProductionWalker=h;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.walkMany=function(t,r,n){if(t.idx===this.occurrence){var i=o.first(r.concat(n));this.result.isEndOfRule=void 0===i,i instanceof c.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkMany.call(this,t,r,n)},t}(h);t.NextTerminalAfterManyWalker=f;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.walkManySep=function(t,r,n){if(t.idx===this.occurrence){var i=o.first(r.concat(n));this.result.isEndOfRule=void 0===i,i instanceof c.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkManySep.call(this,t,r,n)},t}(h);t.NextTerminalAfterManySepWalker=d;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.walkAtLeastOne=function(t,r,n){if(t.idx===this.occurrence){var i=o.first(r.concat(n));this.result.isEndOfRule=void 0===i,i instanceof c.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkAtLeastOne.call(this,t,r,n)},t}(h);t.NextTerminalAfterAtLeastOneWalker=m;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.walkAtLeastOneSep=function(t,r,n){if(t.idx===this.occurrence){var i=o.first(r.concat(n));this.result.isEndOfRule=void 0===i,i instanceof c.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkAtLeastOneSep.call(this,t,r,n)},t}(h);function g(e,t,r,n){var i=o.cloneArr(r);i.push(e.name);var a=o.cloneArr(n);return a.push(1),{idx:t,def:e.definition,ruleStack:i,occurrenceStack:a}}t.NextTerminalAfterAtLeastOneSepWalker=v,t.possiblePathsFrom=function e(t,r,n){void 0===n&&(n=[]),n=o.cloneArr(n);var i=[],a=0;function s(s){var u=e(s.concat(o.drop(t,a+1)),r,n);return i.concat(u)}for(;n.length<r&&a<t.length;){var u=t[a];if(u instanceof c.Flat)return s(u.definition);if(u instanceof c.NonTerminal)return s(u.definition);if(u instanceof c.Option)i=s(u.definition);else{if(u instanceof c.RepetitionMandatory)return s(l=u.definition.concat([new c.Repetition({definition:u.definition})]));if(u instanceof c.RepetitionMandatoryWithSeparator)return s(l=[new c.Flat({definition:u.definition}),new c.Repetition({definition:[new c.Terminal({terminalType:u.separator})].concat(u.definition)})]);if(u instanceof c.RepetitionWithSeparator){var l=u.definition.concat([new c.Repetition({definition:[new c.Terminal({terminalType:u.separator})].concat(u.definition)})]);i=s(l)}else if(u instanceof c.Repetition)l=u.definition.concat([new c.Repetition({definition:u.definition})]),i=s(l);else{if(u instanceof c.Alternation)return o.forEach(u.definition,(function(e){i=s(e.definition)})),i;if(!(u instanceof c.Terminal))throw Error("non exhaustive match");n.push(u.terminalType)}}a++}return i.push({partialPath:n,suffixDef:o.drop(t,a)}),i},t.nextPossibleTokensAfter=function(e,t,r,n){var i=["EXIT_NONE_TERMINAL"],a=!1,s=t.length,u=s-n-1,l=[],p=[];for(p.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});!o.isEmpty(p);){var h=p.pop();if("EXIT_ALTERNATIVE"!==h){var f=h.def,d=h.idx,m=h.ruleStack,v=h.occurrenceStack;if(!o.isEmpty(f)){var y=f[0];if("EXIT_NONE_TERMINAL"===y){var T={idx:d,def:o.drop(f),ruleStack:o.dropRight(m),occurrenceStack:o.dropRight(v)};p.push(T)}else if(y instanceof c.Terminal)if(d<s-1){var E=d+1;r(t[E],y.terminalType)&&(T={idx:E,def:o.drop(f),ruleStack:m,occurrenceStack:v},p.push(T))}else{if(d!==s-1)throw Error("non exhaustive match");l.push({nextTokenType:y.terminalType,nextTokenOccurrence:y.idx,ruleStack:m,occurrenceStack:v}),a=!0}else if(y instanceof c.NonTerminal){var A=o.cloneArr(m);A.push(y.nonTerminalName);var x=o.cloneArr(v);x.push(y.idx),T={idx:d,def:y.definition.concat(i,o.drop(f)),ruleStack:A,occurrenceStack:x},p.push(T)}else if(y instanceof c.Option){var b={idx:d,def:o.drop(f),ruleStack:m,occurrenceStack:v};p.push(b),p.push("EXIT_ALTERNATIVE");var R={idx:d,def:y.definition.concat(o.drop(f)),ruleStack:m,occurrenceStack:v};p.push(R)}else if(y instanceof c.RepetitionMandatory){var w=new c.Repetition({definition:y.definition,idx:y.idx});T={idx:d,def:y.definition.concat([w],o.drop(f)),ruleStack:m,occurrenceStack:v},p.push(T)}else if(y instanceof c.RepetitionMandatoryWithSeparator){var N=new c.Terminal({terminalType:y.separator});w=new c.Repetition({definition:[N].concat(y.definition),idx:y.idx}),T={idx:d,def:y.definition.concat([w],o.drop(f)),ruleStack:m,occurrenceStack:v},p.push(T)}else if(y instanceof c.RepetitionWithSeparator){b={idx:d,def:o.drop(f),ruleStack:m,occurrenceStack:v},p.push(b),p.push("EXIT_ALTERNATIVE"),N=new c.Terminal({terminalType:y.separator});var S=new c.Repetition({definition:[N].concat(y.definition),idx:y.idx});R={idx:d,def:y.definition.concat([S],o.drop(f)),ruleStack:m,occurrenceStack:v},p.push(R)}else if(y instanceof c.Repetition)b={idx:d,def:o.drop(f),ruleStack:m,occurrenceStack:v},p.push(b),p.push("EXIT_ALTERNATIVE"),S=new c.Repetition({definition:y.definition,idx:y.idx}),R={idx:d,def:y.definition.concat([S],o.drop(f)),ruleStack:m,occurrenceStack:v},p.push(R);else if(y instanceof c.Alternation)for(var k=y.definition.length-1;k>=0;k--){var _={idx:d,def:y.definition[k].definition.concat(o.drop(f)),ruleStack:m,occurrenceStack:v};p.push(_),p.push("EXIT_ALTERNATIVE")}else if(y instanceof c.Flat)p.push({idx:d,def:y.definition.concat(o.drop(f)),ruleStack:m,occurrenceStack:v});else{if(!(y instanceof c.Rule))throw Error("non exhaustive match");p.push(g(y,d,m,v))}}}else a&&o.last(p).idx<=u&&p.pop()}return l}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1),a=function(){function e(){}return e.prototype.walk=function(e,t){var r=this;void 0===t&&(t=[]),n.forEach(e.definition,(function(a,o){var s=n.drop(e.definition,o+1);if(a instanceof i.NonTerminal)r.walkProdRef(a,s,t);else if(a instanceof i.Terminal)r.walkTerminal(a,s,t);else if(a instanceof i.Flat)r.walkFlat(a,s,t);else if(a instanceof i.Option)r.walkOption(a,s,t);else if(a instanceof i.RepetitionMandatory)r.walkAtLeastOne(a,s,t);else if(a instanceof i.RepetitionMandatoryWithSeparator)r.walkAtLeastOneSep(a,s,t);else if(a instanceof i.RepetitionWithSeparator)r.walkManySep(a,s,t);else if(a instanceof i.Repetition)r.walkMany(a,s,t);else{if(!(a instanceof i.Alternation))throw Error("non exhaustive match");r.walkOr(a,s,t)}}))},e.prototype.walkTerminal=function(e,t,r){},e.prototype.walkProdRef=function(e,t,r){},e.prototype.walkFlat=function(e,t,r){var n=t.concat(r);this.walk(e,n)},e.prototype.walkOption=function(e,t,r){var n=t.concat(r);this.walk(e,n)},e.prototype.walkAtLeastOne=function(e,t,r){var n=[new i.Option({definition:e.definition})].concat(t,r);this.walk(e,n)},e.prototype.walkAtLeastOneSep=function(e,t,r){var n=o(e,t,r);this.walk(e,n)},e.prototype.walkMany=function(e,t,r){var n=[new i.Option({definition:e.definition})].concat(t,r);this.walk(e,n)},e.prototype.walkManySep=function(e,t,r){var n=o(e,t,r);this.walk(e,n)},e.prototype.walkOr=function(e,t,r){var a=this,o=t.concat(r);n.forEach(e.definition,(function(e){var t=new i.Flat({definition:[e]});a.walk(t,o)}))},e}();function o(e,t,r){return[new i.Option({definition:[new i.Terminal({terminalType:e.separator})].concat(e.definition)})].concat(t,r)}t.RestWalker=a},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(27),i=r(0),a=r(7),o=r(20);!function(e){e[e.MISSING_PATTERN=0]="MISSING_PATTERN",e[e.INVALID_PATTERN=1]="INVALID_PATTERN",e[e.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",e[e.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",e[e.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",e[e.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",e[e.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",e[e.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",e[e.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",e[e.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",e[e.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",e[e.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",e[e.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",e[e.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",e[e.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",e[e.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",e[e.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"}(t.LexerDefinitionErrorType||(t.LexerDefinitionErrorType={}));var s={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:o.defaultLexerErrorProvider};Object.freeze(s);var u=function(){function e(e,t){var r=this;if(void 0===t&&(t=s),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},"boolean"==typeof t)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");if(this.config=i.merge(s,t),this.config.lineTerminatorsPattern===s.lineTerminatorsPattern)this.config.lineTerminatorsPattern=n.LineTerminatorOptimizedTester;else if(this.config.lineTerminatorCharacters===s.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking),this.trackEndLines=/full/i.test(this.config.positionTracking);var o,u=!0;i.isArray(e)?((o={modes:{}}).modes[n.DEFAULT_MODE]=i.cloneArr(e),o[n.DEFAULT_MODE]=n.DEFAULT_MODE):(u=!1,o=i.cloneObj(e)),this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(n.performRuntimeChecks(o,this.trackStartLines,this.config.lineTerminatorCharacters)),this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(n.performWarningRuntimeChecks(o,this.trackStartLines,this.config.lineTerminatorCharacters)),o.modes=o.modes?o.modes:{},i.forEach(o.modes,(function(e,t){o.modes[t]=i.reject(e,(function(e){return i.isUndefined(e)}))}));var c=i.keys(o.modes);if(i.forEach(o.modes,(function(e,o){if(r.modes.push(o),r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(n.validatePatterns(e,c)),i.isEmpty(r.lexerDefinitionErrors)){a.augmentTokenTypes(e);var s=n.analyzeTokenTypes(e,{lineTerminatorCharacters:r.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode});r.patternIdxToConfig[o]=s.patternIdxToConfig,r.charCodeToPatternIdxToConfig[o]=s.charCodeToPatternIdxToConfig,r.emptyGroups=i.merge(r.emptyGroups,s.emptyGroups),r.hasCustom=s.hasCustom||r.hasCustom,r.canModeBeOptimized[o]=s.canBeOptimized}})),this.defaultMode=o.defaultMode,!i.isEmpty(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){var l=i.map(this.lexerDefinitionErrors,(function(e){return e.message})).join("-----------------------\n");throw new Error("Errors detected in definition of Lexer:\n"+l)}if(i.forEach(this.lexerDefinitionWarning,(function(e){i.PRINT_WARNING(e.message)})),n.SUPPORT_STICKY?(this.chopInput=i.IDENTITY,this.match=this.matchWithTest):(this.updateLastIndex=i.NOOP,this.match=this.matchWithExec),u&&(this.handleModes=i.NOOP),!1===this.trackStartLines&&(this.computeNewColumn=i.IDENTITY),!1===this.trackEndLines&&(this.updateTokenEndLineColumnLocation=i.NOOP),/full/i.test(this.config.positionTracking))this.createTokenInstance=this.createFullToken;else if(/onlyStart/i.test(this.config.positionTracking))this.createTokenInstance=this.createStartOnlyToken;else{if(!/onlyOffset/i.test(this.config.positionTracking))throw Error('Invalid <positionTracking> config option: "'+this.config.positionTracking+'"');this.createTokenInstance=this.createOffsetOnlyToken}this.hasCustom?this.addToken=this.addTokenUsingPush:this.addToken=this.addTokenUsingMemberAccess;var p=i.reduce(this.canModeBeOptimized,(function(e,t,r){return!1===t&&e.push(r),e}),[]);if(t.ensureOptimizations&&!i.isEmpty(p))throw Error("Lexer Modes: < "+p.join(", ")+' > cannot be optimized.\n\t Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n\t Or inspect the console log for details on how to resolve these issues.')}return e.prototype.tokenize=function(e,t){if(void 0===t&&(t=this.defaultMode),!i.isEmpty(this.lexerDefinitionErrors)){var r=i.map(this.lexerDefinitionErrors,(function(e){return e.message})).join("-----------------------\n");throw new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+r)}return this.tokenizeInternal(e,t)},e.prototype.tokenizeInternal=function(e,t){var r,a,o,s,u,c,l,p,h,f,d,m,v=this,g=e,y=g.length,T=0,E=0,A=this.hasCustom?0:Math.floor(e.length/10),x=new Array(A),b=[],R=this.trackStartLines?1:void 0,w=this.trackStartLines?1:void 0,N=n.cloneEmptyGroups(this.emptyGroups),S=this.trackStartLines,k=this.config.lineTerminatorsPattern,_=0,L=[],I=[],O=[],M=[];Object.freeze(M);var C,P=void 0,F=function(e){if(1===O.length&&void 0===e.tokenType.PUSH_MODE){var t=v.config.errorMessageProvider.buildUnableToPopLexerModeMessage(e);b.push({offset:e.startOffset,line:void 0!==e.startLine?e.startLine:void 0,column:void 0!==e.startColumn?e.startColumn:void 0,length:e.image.length,message:t})}else{O.pop();var r=i.last(O);L=v.patternIdxToConfig[r],I=v.charCodeToPatternIdxToConfig[r],_=L.length;var n=v.canModeBeOptimized[r]&&!1===v.config.safeMode;P=I&&n?function(e){var t=I[e];return void 0===t?M:t}:function(){return L}}};function U(e){O.push(e),I=this.charCodeToPatternIdxToConfig[e],L=this.patternIdxToConfig[e],_=L.length,_=L.length;var t=this.canModeBeOptimized[e]&&!1===this.config.safeMode;P=I&&t?function(e){var t=I[e];return void 0===t?M:t}:function(){return L}}for(U.call(this,t);T<y;){u=null;var D=g.charCodeAt(T),B=P(D),V=B.length;for(r=0;r<V;r++){var j=(C=B[r]).pattern;if(!1!==($=C.short)?D===$&&(u=j):!0===C.isCustom?u=null!==(m=j.exec(g,T,x,N))?m[0]:m:(this.updateLastIndex(j,T),u=this.match(j,e,T)),null!==u){if(void 0!==(s=C.longerAlt)){var G=L[s],H=G.pattern;!0===G.isCustom?o=null!==(m=H.exec(g,T,x,N))?m[0]:m:(this.updateLastIndex(H,T),o=this.match(H,e,T)),o&&o.length>u.length&&(u=o,C=G)}break}}if(null!==u){if(c=u.length,void 0!==(l=C.group)&&(p=C.tokenTypeIdx,h=this.createTokenInstance(u,T,p,C.tokenType,R,w,c),!1===l?E=this.addToken(x,E,h):N[l].push(h)),e=this.chopInput(e,c),T+=c,w=this.computeNewColumn(w,c),!0===S&&!0===C.canLineTerminator){var z=0,W=void 0,K=void 0;k.lastIndex=0;do{!0===(W=k.test(u))&&(K=k.lastIndex-1,z++)}while(W);0!==z&&(R+=z,w=c-K,this.updateTokenEndLineColumnLocation(h,l,K,z,R,w,c))}this.handleModes(C,F,U,h)}else{for(var X=T,Y=R,q=w,Z=!1;!Z&&T<y;)for(g.charCodeAt(T),e=this.chopInput(e,1),T++,a=0;a<_;a++){var $,J=L[a];if(j=J.pattern,!1!==($=J.short)?g.charCodeAt(T)===$&&(Z=!0):!0===J.isCustom?Z=null!==j.exec(g,T,x,N):(this.updateLastIndex(j,T),Z=null!==j.exec(e)),!0===Z)break}f=T-X,d=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(g,X,f,Y,q),b.push({offset:X,line:Y,column:q,length:f,message:d})}}return this.hasCustom||(x.length=E),{tokens:x,groups:N,errors:b}},e.prototype.handleModes=function(e,t,r,n){if(!0===e.pop){var i=e.push;t(n),void 0!==i&&r.call(this,i)}else void 0!==e.push&&r.call(this,e.push)},e.prototype.chopInput=function(e,t){return e.substring(t)},e.prototype.updateLastIndex=function(e,t){e.lastIndex=t},e.prototype.updateTokenEndLineColumnLocation=function(e,t,r,n,i,a,o){var s,u;void 0!==t&&(u=(s=r===o-1)?-1:0,1===n&&!0===s||(e.endLine=i+u,e.endColumn=a-1-u))},e.prototype.computeNewColumn=function(e,t){return e+t},e.prototype.createTokenInstance=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return null},e.prototype.createOffsetOnlyToken=function(e,t,r,n){return{image:e,startOffset:t,tokenTypeIdx:r,tokenType:n}},e.prototype.createStartOnlyToken=function(e,t,r,n,i,a){return{image:e,startOffset:t,startLine:i,startColumn:a,tokenTypeIdx:r,tokenType:n}},e.prototype.createFullToken=function(e,t,r,n,i,a,o){return{image:e,startOffset:t,endOffset:t+o-1,startLine:i,endLine:i,startColumn:a,endColumn:a+o-1,tokenTypeIdx:r,tokenType:n}},e.prototype.addToken=function(e,t,r){return 666},e.prototype.addTokenUsingPush=function(e,t,r){return e.push(r),t},e.prototype.addTokenUsingMemberAccess=function(e,t,r){return e[t]=r,++t},e.prototype.match=function(e,t,r){return null},e.prototype.matchWithTest=function(e,t,r){return!0===e.test(t)?t.substring(r,e.lastIndex):null},e.prototype.matchWithExec=function(e,t){var r=e.exec(t);return null!==r?r[0]:r},e.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",e.NA=/NOT_APPLICABLE/,e}();t.Lexer=u},function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=r(4),s=r(9),u=r(1),c=r(5);t.addTerminalToCst=function(e,t,r){void 0===e.children[r]?e.children[r]=[t]:e.children[r].push(t)},t.addNoneTerminalToCst=function(e,t,r){void 0===e.children[t]?e.children[t]=[r]:e.children[t].push(r)};var l=function(e){function t(t){var r=e.call(this)||this;return r.result=[],r.ruleIdx=t,r}return i(t,e),t.prototype.collectNamedDSLMethod=function(e,t,r){if(!a.isUndefined(e.name)){var n=void 0;if(e instanceof u.Option||e instanceof u.Repetition||e instanceof u.RepetitionMandatory||e instanceof u.Alternation)n=new t({definition:e.definition,idx:e.idx});else{if(!(e instanceof u.RepetitionMandatoryWithSeparator||e instanceof u.RepetitionWithSeparator))throw Error("non exhaustive match");n=new t({definition:e.definition,idx:e.idx,separator:e.separator})}var i=[n],o=s.getKeyForAutomaticLookahead(this.ruleIdx,r,e.idx);this.result.push({def:i,key:o,name:e.name,orgProd:e})}},t.prototype.visitOption=function(e){this.collectNamedDSLMethod(e,u.Option,s.OPTION_IDX)},t.prototype.visitRepetition=function(e){this.collectNamedDSLMethod(e,u.Repetition,s.MANY_IDX)},t.prototype.visitRepetitionMandatory=function(e){this.collectNamedDSLMethod(e,u.RepetitionMandatory,s.AT_LEAST_ONE_IDX)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.collectNamedDSLMethod(e,u.RepetitionMandatoryWithSeparator,s.AT_LEAST_ONE_SEP_IDX)},t.prototype.visitRepetitionWithSeparator=function(e){this.collectNamedDSLMethod(e,u.RepetitionWithSeparator,s.MANY_SEP_IDX)},t.prototype.visitAlternation=function(e){var t=this;this.collectNamedDSLMethod(e,u.Alternation,s.OR_IDX);var r=e.definition.length>1;a.forEach(e.definition,(function(n,i){if(!a.isUndefined(n.name)){var o=n.definition;o=r?[new u.Option({definition:n.definition})]:n.definition;var c=s.getKeyForAltIndex(t.ruleIdx,s.OR_IDX,e.idx,i);t.result.push({def:o,key:c,name:n.name,orgProd:n})}}))},t}(c.GAstVisitor);t.NamedDSLMethodsCollectorVisitor=l,t.analyzeCst=function(e,t){var r={dictDef:new o.HashTable,allRuleNames:[]};return a.forEach(e,(function(e){var n=t.get(e.name);r.allRuleNames.push(e.name);var i=new l(n);e.accept(i),a.forEach(i.result,(function(t){t.def,t.key;var n=t.name;r.allRuleNames.push(e.name+n)}))})),r}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION="4.6.0"},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=r(15),a=r(2),o=r(6),s=r(17),u=r(10),c=r(39),l=r(5),p=r(1),h=r(24),f=r(40),d=r(20),m={};m.VERSION=s.VERSION,m.Parser=n.Parser,m.CstParser=n.CstParser,m.EmbeddedActionsParser=n.EmbeddedActionsParser,m.ParserDefinitionErrorType=n.ParserDefinitionErrorType,m.Lexer=i.Lexer,m.LexerDefinitionErrorType=i.LexerDefinitionErrorType,m.EOF=a.EOF,m.tokenName=a.tokenName,m.tokenLabel=a.tokenLabel,m.tokenMatcher=a.tokenMatcher,m.createToken=a.createToken,m.createTokenInstance=a.createTokenInstance,m.EMPTY_ALT=n.EMPTY_ALT,m.defaultParserErrorProvider=u.defaultParserErrorProvider,m.isRecognitionException=o.isRecognitionException,m.EarlyExitException=o.EarlyExitException,m.MismatchedTokenException=o.MismatchedTokenException,m.NotAllInputParsedException=o.NotAllInputParsedException,m.NoViableAltException=o.NoViableAltException,m.defaultLexerErrorProvider=d.defaultLexerErrorProvider,m.Flat=p.Flat,m.Repetition=p.Repetition,m.RepetitionWithSeparator=p.RepetitionWithSeparator,m.RepetitionMandatory=p.RepetitionMandatory,m.RepetitionMandatoryWithSeparator=p.RepetitionMandatoryWithSeparator,m.Option=p.Option,m.Alternation=p.Alternation,m.NonTerminal=p.NonTerminal,m.Terminal=p.Terminal,m.Rule=p.Rule,m.GAstVisitor=l.GAstVisitor,m.serializeGrammar=p.serializeGrammar,m.serializeProduction=p.serializeProduction,m.resolveGrammar=h.resolveGrammar,m.defaultGrammarResolverErrorProvider=u.defaultGrammarResolverErrorProvider,m.validateGrammar=h.validateGrammar,m.defaultGrammarValidatorErrorProvider=u.defaultGrammarValidatorErrorProvider,m.assignOccurrenceIndices=h.assignOccurrenceIndices,m.clearCache=function(){console.warn("The clearCache function was 'soft' removed from the Chevrotain API.\n\t It performs no action other than printing this message.\n\t Please avoid using it as it will be completely removed in the future")},m.createSyntaxDiagramsCode=c.createSyntaxDiagramsCode,m.generateParserFactory=f.generateParserFactory,m.generateParserModule=f.generateParserModule,e.exports=m},function(e,t,r){var n,i;"undefined"!=typeof self&&self,void 0===(i="function"==typeof(n=function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx},e.prototype.pattern=function(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");var t=this.disjunction();this.consumeChar("/");for(var r={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":s(r,"global");break;case"i":s(r,"ignoreCase");break;case"m":s(r,"multiLine");break;case"u":s(r,"unicode");break;case"y":s(r,"sticky")}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:r,value:t}},e.prototype.disjunction=function(){var e=[];for(e.push(this.alternative());"|"===this.peekChar();)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e}},e.prototype.alternative=function(){for(var e=[];this.isTerm();)e.push(this.term());return{type:"Alternative",value:e}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":var e;switch(this.consumeChar("?"),this.popChar()){case"=":e="Lookahead";break;case"!":e="NegativeLookahead"}u(e);var t=this.disjunction();return this.consumeChar(")"),{type:e,value:t}}!function(){throw Error("Internal Error - Should never get here!")}()},e.prototype.quantifier=function(e){var t;switch(this.popChar()){case"*":t={atLeast:0,atMost:1/0};break;case"+":t={atLeast:1,atMost:1/0};break;case"?":t={atLeast:0,atMost:1};break;case"{":var r=this.integerIncludingZero();switch(this.popChar()){case"}":t={atLeast:r,atMost:r};break;case",":t=this.isDigit()?{atLeast:r,atMost:this.integerIncludingZero()}:{atLeast:r,atMost:1/0},this.consumeChar("}")}if(!0===e&&void 0===t)return;u(t)}if(!0!==e||void 0!==t)return u(t),"?"===this.peekChar(0)?(this.consumeChar("?"),t.greedy=!1):t.greedy=!0,t.type="Quantifier",t},e.prototype.atom=function(){var e;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group()}return void 0===e&&this.isPatternCharacter()&&(e=this.patternCharacter()),u(e),this.isQuantifier()&&(e.quantifier=this.quantifier()),e},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[a("\n"),a("\r"),a("\u2028"),a("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){return{type:"GroupBackReference",value:this.positiveInteger()}},e.prototype.characterClassEscape=function(){var e,t=!1;switch(this.popChar()){case"d":e=c;break;case"D":e=c,t=!0;break;case"s":e=p;break;case"S":e=p,t=!0;break;case"w":e=l;break;case"W":e=l,t=!0}return u(e),{type:"Set",value:e,complement:t}},e.prototype.controlEscapeAtom=function(){var e;switch(this.popChar()){case"f":e=a("\f");break;case"n":e=a("\n");break;case"r":e=a("\r");break;case"t":e=a("\t");break;case"v":e=a("\v")}return u(e),{type:"Character",value:e}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var e=this.popChar();if(!1===/[a-zA-Z]/.test(e))throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:a("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){return{type:"Character",value:a(this.popChar())}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:return{type:"Character",value:a(this.popChar())}}},e.prototype.characterClass=function(){var e=[],t=!1;for(this.consumeChar("["),"^"===this.peekChar(0)&&(this.consumeChar("^"),t=!0);this.isClassAtom();){var r=this.classAtom();if("Character"===r.type&&this.isRangeDash()){this.consumeChar("-");var n=this.classAtom();if("Character"===n.type){if(n.value<r.value)throw Error("Range out of order in character class");e.push({from:r.value,to:n.value})}else o(r.value,e),e.push(a("-")),o(n.value,e)}else o(r.value,e)}return this.consumeChar("]"),{type:"Set",complement:t,value:e}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:a("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var e=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),e=!1;break;default:this.groupIdx++}var t=this.disjunction();this.consumeChar(")");var r={type:"Group",capturing:e,value:t};return e&&(r.idx=this.groupIdx),r},e.prototype.positiveInteger=function(){var e=this.popChar();if(!1===i.test(e))throw Error("Expecting a positive integer");for(;n.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.integerIncludingZero=function(){var e=this.popChar();if(!1===n.test(e))throw Error("Expecting an integer");for(;n.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.patternCharacter=function(){var e=this.popChar();switch(e){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:a(e)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return"-"===this.peekChar()&&this.isClassAtom(1)},e.prototype.isDigit=function(){return n.test(this.peekChar(0))},e.prototype.isClassAtom=function(e){switch(void 0===e&&(e=0),this.peekChar(e)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return"?"===this.peekChar(1)&&("="===this.peekChar(2)||"!"===this.peekChar(2));default:return!1}},e.prototype.isQuantifier=function(){var e=this.saveState();try{return void 0!==this.quantifier(!0)}catch(e){return!1}finally{this.restoreState(e)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(e){for(var t="",n=0;n<e;n++){var i=this.popChar();if(!1===r.test(i))throw Error("Expecting a HexDecimal digits");t+=i}return{type:"Character",value:parseInt(t,16)}},e.prototype.peekChar=function(e){return void 0===e&&(e=0),this.input[this.idx+e]},e.prototype.popChar=function(){var e=this.peekChar(0);return this.consumeChar(),e},e.prototype.consumeChar=function(e){if(void 0!==e&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var t,r=/[0-9a-fA-F]/,n=/[0-9]/,i=/[1-9]/;function a(e){return e.charCodeAt(0)}function o(e,t){void 0!==e.length?e.forEach((function(e){t.push(e)})):t.push(e)}function s(e,t){if(!0===e[t])throw"duplicate flag "+t;e[t]=!0}function u(e){if(void 0===e)throw Error("Internal Error - Should never get here!")}var c=[];for(t=a("0");t<=a("9");t++)c.push(t);var l=[a("_")].concat(c);for(t=a("a");t<=a("z");t++)l.push(t);for(t=a("A");t<=a("Z");t++)l.push(t);var p=[a(" "),a("\f"),a("\n"),a("\r"),a("\t"),a("\v"),a("\t"),a("\xa0"),a("\u1680"),a("\u2000"),a("\u2001"),a("\u2002"),a("\u2003"),a("\u2004"),a("\u2005"),a("\u2006"),a("\u2007"),a("\u2008"),a("\u2009"),a("\u200a"),a("\u2028"),a("\u2029"),a("\u202f"),a("\u205f"),a("\u3000"),a("\ufeff")];function h(){}return h.prototype.visitChildren=function(e){for(var t in e){var r=e[t];e.hasOwnProperty(t)&&(void 0!==r.type?this.visit(r):Array.isArray(r)&&r.forEach((function(e){this.visit(e)}),this))}},h.prototype.visit=function(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e)}this.visitChildren(e)},h.prototype.visitPattern=function(e){},h.prototype.visitFlags=function(e){},h.prototype.visitDisjunction=function(e){},h.prototype.visitAlternative=function(e){},h.prototype.visitStartAnchor=function(e){},h.prototype.visitEndAnchor=function(e){},h.prototype.visitWordBoundary=function(e){},h.prototype.visitNonWordBoundary=function(e){},h.prototype.visitLookahead=function(e){},h.prototype.visitNegativeLookahead=function(e){},h.prototype.visitCharacter=function(e){},h.prototype.visitSet=function(e){},h.prototype.visitGroup=function(e){},h.prototype.visitGroupBackReference=function(e){},h.prototype.visitQuantifier=function(e){},{RegExpParser:e,BaseRegExpVisitor:h,VERSION:"0.4.0"}})?n.apply(t,[]):n)||(e.exports=i)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.defaultLexerErrorProvider={buildUnableToPopLexerModeMessage:function(e){return"Unable to pop Lexer Mode after encountering Token ->"+e.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(e,t,r,n,i){return"unexpected character: ->"+e.charAt(t)+"<- at offset: "+t+", skipped "+r+" characters."}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1),a=r(8);function o(e){if(e instanceof i.NonTerminal)return o(e.referencedRule);if(e instanceof i.Terminal)return c(e);if(a.isSequenceProd(e))return s(e);if(a.isBranchingProd(e))return u(e);throw Error("non exhaustive match")}function s(e){for(var t,r=[],i=e.definition,s=0,u=i.length>s,c=!0;u&&c;)t=i[s],c=a.isOptionalProd(t),r=r.concat(o(t)),s+=1,u=i.length>s;return n.uniq(r)}function u(e){var t=n.map(e.definition,(function(e){return o(e)}));return n.uniq(n.flatten(t))}function c(e){return[e.terminalType]}t.first=o,t.firstForSequence=s,t.firstForBranching=u,t.firstForTerminal=c},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.IN="_~IN~_"},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(29),a=r(0),o=r(1);!function(e){e[e.OPTION=0]="OPTION",e[e.OR=1]="OR",e[e.MANY=2]="MANY",e[e.MANY_SEP=3]="MANY_SEP",e[e.AT_LEAST_ONE=4]="AT_LEAST_ONE",e[e.AT_LEAST_ONE_SEP=5]="AT_LEAST_ONE_SEP",e[e.REF=6]="REF",e[e.TERMINAL=7]="TERMINAL",e[e.FLAT=8]="FLAT"}(n=t.ProdType||(t.ProdType={}));var s=/(?:\s*{\s*NAME\s*:\s*["'`]([\w$]*)["'`])?/,u=new RegExp(s.source.replace("{","").replace(")?","\\s*,)?")),c=/\.\s*CONSUME(\d+)?\s*\(\s*(?:[a-zA-Z_$]\w*\s*\.\s*)*([a-zA-Z_$]\w*)/,l=new RegExp(c.source,"g"),p=/\.\s*SUBRULE(\d+)?\s*\(\s*(?:[a-zA-Z_$]\w*\s*\.\s*)*([a-zA-Z_$]\w*)/,h=new RegExp(p.source,"g"),f=/\.\s*OPTION(\d+)?\s*\(/,d=new RegExp(f.source+s.source),m=new RegExp(f.source,"g"),v=/\.\s*MANY(\d+)?\s*\(/,g=new RegExp(v.source+s.source),y=new RegExp(v.source,"g"),T=/\s*SEP\s*:\s*(?:[a-zA-Z_$]\w*\s*\.\s*)*([a-zA-Z_$]\w*)/,E=new RegExp(/\.\s*MANY_SEP(\d+)?\s*\(\s*{/.source+u.source+T.source),A=new RegExp(E.source,"g"),x=new RegExp(/\.\s*AT_LEAST_ONE_SEP(\d+)?\s*\(\s*{/.source+u.source+T.source),b=new RegExp(x.source,"g"),R=/\.\s*AT_LEAST_ONE(\d+)?\s*\(/,w=new RegExp(R.source+s.source),N=new RegExp(R.source,"g"),S=/\.\s*OR(\d+)?\s*\(/,k=new RegExp(S.source+s.source),_=new RegExp(S.source,"g"),L=new RegExp(u.source+/\s*(ALT)\s*:/.source),I=new RegExp(L.source,"g");function O(e,r,i){switch(e.type){case n.AT_LEAST_ONE:return function(e,t,r){return M(w,new o.RepetitionMandatory({definition:[]}),e,t,r)}(e,r,i);case n.AT_LEAST_ONE_SEP:return function(e,t,r){return C(e,t,o.RepetitionMandatoryWithSeparator,x,r)}(e,r,i);case n.MANY_SEP:return function(e,t,r){return C(e,t,o.RepetitionWithSeparator,E,r)}(e,r,i);case n.MANY:return function(e,t,r){return M(g,new o.Repetition({definition:[]}),e,t,r)}(e,r,i);case n.OPTION:return function(e,t,r){return M(d,new o.Option({definition:[]}),e,t,r)}(e,r,i);case n.OR:return function(e,t,r){return M(k,new o.Alternation({definition:[]}),e,t,r)}(e,r,i);case n.FLAT:return function(e,t,r){var n=new o.Flat({definition:[]}),i=L.exec(e.text)[1];return a.isUndefined(i)||(n.name=i),P(n,e.range,t,r)}(e,r,i);case n.REF:return function(e){var t=p.exec(e.text),r=void 0===t[1]?0:parseInt(t[1],10),n=t[2];return new o.NonTerminal({nonTerminalName:n,idx:r})}(e);case n.TERMINAL:return function(e,r){var n=c.exec(e.text),i=void 0===n[1]?0:parseInt(n[1],10),a=n[2],s=t.terminalNameToConstructor[a];if(!s)throw Error("Terminal Token name: <"+a+"> not found in rule: <"+r+">  \n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#TERMINAL_NAME_NOT_FOUND\n\tFor Further details.");return new o.Terminal({terminalType:s,idx:i})}(e,i);default:throw Error("non exhaustive match")}}function M(e,t,r,n,i){var o=e.exec(r.text),s=void 0===o[1];t.idx=s?0:parseInt(o[1],10);var u=o[2];return a.isUndefined(u)||(t.name=u),P(t,r.range,n,i)}function C(e,r,n,i,o){var s=i.exec(e.text),u=void 0===s[1]?0:parseInt(s[1],10),c=s[3],l=t.terminalNameToConstructor[c];if(!l)throw Error("Separator Terminal Token name: "+c+" not found");var p=new n({definition:[],separator:l,idx:u}),h=s[2];return a.isUndefined(h)||(p.name=h),P(p,e.range,r,o)}function P(e,t,r,n){var i=F(t,r),o=a.sortBy(i,(function(e){return e.range.start})),s=[];return a.forEach(o,(function(e){s.push(O(e,r,n))})),e.definition=s,e}function F(e,t){return a.filter(t,(function(r){var n=e.strictlyContainsRange(r.range),i=a.every(t,(function(t){var n=t.range.strictlyContainsRange(r.range),i=t.range.isStrictlyContainedInRange(e);return!(n&&i)}));return n&&i}))}t.terminalNameToConstructor={},t.buildTopProduction=function(e,r,n){t.terminalNameToConstructor=n;var a=z(H(j("  "+e)));return function(e,t,r,n){return P(new o.Rule({name:e,definition:[],orgText:n}),t,r,e)}(r,new i.Range(0,e.length+2),a,e)},t.buildProdGast=O,t.getDirectlyContainedRanges=F;var U=/\/\/.*/g,D=/\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\//g,B=/(NAME\s*:\s*)?"([^\\"]|\\([bfnrtv"\\\/]|u[0-9a-fA-F]{4}))*"/g,V=/(NAME\s*:\s*)?'([^\\']|\\([bfnrtv'\\\/]|u[0-9a-fA-F]{4}))*'/g;function j(e){return e.replace(U,"").replace(D,"")}function G(e,t){return void 0!==t?e:""}function H(e){return e.replace(B,G).replace(V,G)}function z(e){var t=W(e),r=K(e),n=X(e),i=Y(e),a=q(e),o=Z(e),s=$(e),u=J(e);return[].concat(t,r,n,i,a,o,s,u)}function W(e){return re(e,n.TERMINAL,l)}function K(e){return re(e,n.REF,h)}function X(e){return ne(e,n.AT_LEAST_ONE,N)}function Y(e){return ne(e,n.AT_LEAST_ONE_SEP,b)}function q(e){return ne(e,n.MANY,y)}function Z(e){return ne(e,n.MANY_SEP,A)}function $(e){return ne(e,n.OPTION,m)}function J(e){var t=ne(e,n.OR,_),r=te(t);return t.concat(r)}t.removeComments=j,t.removeStringLiterals=H,t.createRanges=z,t.createTerminalRanges=W,t.createRefsRanges=K,t.createAtLeastOneRanges=X,t.createAtLeastOneSepRanges=Y,t.createManyRanges=q,t.createManySepRanges=Z,t.createOptionRanges=$,t.createOrRanges=J;var Q=a.partial(ae,"{","}"),ee=a.partial(ae,"(",")");function te(e){var t=[];return a.forEach(e,(function(e){var r=ie(e.text,n.FLAT,I,Q),i=e.range.start;a.forEach(r,(function(e){e.range.start+=i,e.range.end+=i})),t=t.concat(r)})),a.uniq(t,(function(e){return e.type+"~"+e.range.start+"~"+e.range.end+"~"+e.text}))}function re(e,t,r){for(var n,a=[];n=r.exec(e);){var o=n.index,s=r.lastIndex,u=new i.Range(o,s),c=n[0];a.push({range:u,text:c,type:t})}return a}function ne(e,t,r){return ie(e,t,r,ee)}function ie(e,t,r,n){for(var a,o=[];a=r.exec(e);){var s=a.index,u=n(s+a[0].length,e),c=new i.Range(s,u),l=e.substr(s,u-s+1);o.push({range:c,text:l,type:t})}return o}function ae(e,t,r,n){for(var i=[1],o=-1;!a.isEmpty(i)&&o+r<n.length;){o++;var s=n.charAt(r+o);s===e?i.push(1):s===t&&i.pop()}if(a.isEmpty(i))return o+r;throw new Error("INVALID INPUT TEXT, UNTERMINATED PARENTHESIS")}function oe(e,t){return a.map(e,(function(e){return se(e,t)}))}function se(e,t){switch(e.type){case"NonTerminal":return new o.NonTerminal({nonTerminalName:e.name,idx:e.idx});case"Flat":return new o.Flat({name:e.name,definition:oe(e.definition,t)});case"Option":return new o.Option({name:e.name,idx:e.idx,definition:oe(e.definition,t)});case"RepetitionMandatory":return new o.RepetitionMandatory({name:e.name,idx:e.idx,definition:oe(e.definition,t)});case"RepetitionMandatoryWithSeparator":return new o.RepetitionMandatoryWithSeparator({name:e.name,idx:e.idx,separator:t[e.separator.name],definition:oe(e.definition,t)});case"RepetitionWithSeparator":return new o.RepetitionWithSeparator({name:e.name,idx:e.idx,separator:t[e.separator.name],definition:oe(e.definition,t)});case"Repetition":return new o.Repetition({name:e.name,idx:e.idx,definition:oe(e.definition,t)});case"Alternation":return new o.Alternation({name:e.name,idx:e.idx,definition:oe(e.definition,t)});case"Terminal":return new o.Terminal({terminalType:t[e.name],idx:e.idx});case"Rule":return new o.Rule({name:e.name,orgText:e.orgText,definition:oe(e.definition,t)})}}t.createOrPartRanges=te,t.findClosingOffset=ae,t.deserializeGrammar=oe,t.deserializeProduction=se},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(4),a=r(30),o=r(11),s=r(10),u=r(8);t.resolveGrammar=function(e){e=n.defaults(e,{errMsgProvider:s.defaultGrammarResolverErrorProvider});var t=new i.HashTable;return n.forEach(e.rules,(function(e){t.put(e.name,e)})),a.resolveGrammar(t,e.errMsgProvider)},t.validateGrammar=function(e){return e=n.defaults(e,{errMsgProvider:s.defaultGrammarValidatorErrorProvider,ignoredIssues:{}}),o.validateGrammar(e.rules,e.maxLookahead,e.tokenTypes,e.ignoredIssues,e.errMsgProvider,e.grammarName)},t.assignOccurrenceIndices=function(e){n.forEach(e.rules,(function(e){var t=new u.DslMethodsCollectorVisitor;e.accept(t),n.forEach(t.dslMethods,(function(e){n.forEach(e,(function(e,t){e.idx=t+1}))}))}))}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(0),a=r(6),o=r(22),s=r(4),u=r(3);function c(e){this.name=t.IN_RULE_RECOVERY_EXCEPTION,this.message=e}t.EOF_FOLLOW_KEY={},t.IN_RULE_RECOVERY_EXCEPTION="InRuleRecoveryException",t.InRuleRecoveryException=c,c.prototype=Error.prototype;var l=function(){function e(){}return e.prototype.initRecoverable=function(e){this.firstAfterRepMap=new s.HashTable,this.resyncFollows=new s.HashTable,this.recoveryEnabled=i.has(e,"recoveryEnabled")?e.recoveryEnabled:u.DEFAULT_PARSER_CONFIG.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=p)},e.prototype.getTokenToInsert=function(e){var t=n.createTokenInstance(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},e.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},e.prototype.tryInRepetitionRecovery=function(e,t,r,n){for(var o=this,s=this.findReSyncTokenType(),u=this.exportLexerState(),c=[],l=!1,p=this.LA(1),h=this.LA(1),f=function(){var e=o.LA(0),t=o.errorMessageProvider.buildMismatchTokenMessage({expected:n,actual:p,previous:e,ruleName:o.getCurrRuleFullName()}),r=new a.MismatchedTokenException(t,p,o.LA(0));r.resyncedTokens=i.dropRight(c),o.SAVE_ERROR(r)};!l;){if(this.tokenMatcher(h,n))return void f();if(r.call(this))return f(),void e.apply(this,t);this.tokenMatcher(h,s)?l=!0:(h=this.SKIP_TOKEN(),this.addToResyncTokens(h,c))}this.importLexerState(u)},e.prototype.shouldInRepetitionRecoveryBeTried=function(e,t){return void 0!==e&&void 0!==t&&!this.tokenMatcher(this.LA(1),e)&&!this.isBackTracking()&&!this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t))},e.prototype.getFollowsForInRuleRecovery=function(e,t){var r=this.getCurrentGrammarPath(e,t);return this.getNextPossibleTokenTypes(r)},e.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e)){var r=this.SKIP_TOKEN();return this.consumeToken(),r}throw new c("sad sad panda")},e.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},e.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var r=this;if(!this.canTokenTypeBeInsertedInRecovery(e))return!1;if(i.isEmpty(t))return!1;var n=this.LA(1);return void 0!==i.find(t,(function(e){return r.tokenMatcher(n,e)}))},e.prototype.canRecoverWithSingleTokenDeletion=function(e){return this.tokenMatcher(this.LA(2),e)},e.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(t);return i.contains(r,e)},e.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),r=2;;){var n=t.tokenType;if(i.contains(e,n))return n;t=this.LA(r),r++}},e.prototype.getCurrFollowKey=function(){if(1===this.RULE_STACK.length)return t.EOF_FOLLOW_KEY;var e=this.getLastExplicitRuleShortName(),r=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:r,inRule:this.shortRuleNameToFullName(n)}},e.prototype.buildFullFollowKeyStack=function(){var e=this,r=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return i.isEmpty(this.LAST_EXPLICIT_RULE_STACK)||(r=i.map(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.RULE_STACK[t]})),n=i.map(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.RULE_OCCURRENCE_STACK[t]}))),i.map(r,(function(i,a){return 0===a?t.EOF_FOLLOW_KEY:{ruleName:e.shortRuleNameToFullName(i),idxInCallingRule:n[a],inRule:e.shortRuleNameToFullName(r[a-1])}}))},e.prototype.flattenFollowSet=function(){var e=this,t=i.map(this.buildFullFollowKeyStack(),(function(t){return e.getFollowSetFromFollowKey(t)}));return i.flatten(t)},e.prototype.getFollowSetFromFollowKey=function(e){if(e===t.EOF_FOLLOW_KEY)return[n.EOF];var r=e.ruleName+e.idxInCallingRule+o.IN+e.inRule;return this.resyncFollows.get(r)},e.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,n.EOF)||t.push(e),t},e.prototype.reSyncTo=function(e){for(var t=[],r=this.LA(1);!1===this.tokenMatcher(r,e);)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,t);return i.dropRight(t)},e.prototype.attemptInRepetitionRecovery=function(e,t,r,n,i,a){},e.prototype.getCurrentGrammarPath=function(e,t){return{ruleStack:this.getHumanReadableRuleStack(),occurrenceStack:i.cloneArr(this.RULE_OCCURRENCE_STACK),lastTok:e,lastTokOccurrence:t}},e.prototype.getHumanReadableRuleStack=function(){var e=this;return i.isEmpty(this.LAST_EXPLICIT_RULE_STACK)?i.map(this.RULE_STACK,(function(t){return e.shortRuleNameToFullName(t)})):i.map(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.shortRuleNameToFullName(e.RULE_STACK[t])}))},e}();function p(e,t,r,i,a,o){var s=this.getKeyForAutomaticLookahead(i,a),u=this.firstAfterRepMap.get(s);if(void 0===u){var c=this.getCurrRuleFullName();u=new o(this.getGAstProductions().get(c),a).startWalking(),this.firstAfterRepMap.put(s,u)}var l=u.token,p=u.occurrence,h=u.isEndOfRule;1===this.RULE_STACK.length&&h&&void 0===l&&(l=n.EOF,p=1),this.shouldInRepetitionRecoveryBeTried(l,p)&&this.tryInRepetitionRecovery(e,t,r,l)}t.Recoverable=l,t.attemptInRepetitionRecovery=p},function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(14),o=r(4),s=r(21),u=r(0),c=r(22),l=r(2),p=r(1),h=function(e){function t(t){var r=e.call(this)||this;return r.topProd=t,r.follows=new o.HashTable,r}return i(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},t.prototype.walkTerminal=function(e,t,r){},t.prototype.walkProdRef=function(e,t,r){var n=f(e.referencedRule,e.idx)+this.topProd.name,i=t.concat(r),a=new p.Flat({definition:i}),o=s.first(a);this.follows.put(n,o)},t}(a.RestWalker);function f(e,t){return e.name+t+c.IN}t.ResyncFollowsWalker=h,t.computeAllProdsFollows=function(e){var t=new o.HashTable;return u.forEach(e,(function(e){var r=new h(e).startWalking();t.putAll(r)})),t},t.buildBetweenProdsFollowPrefix=f,t.buildInProdFollowPrefix=function(e){return l.tokenName(e.terminalType)+e.idx+c.IN}},function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(19),o=r(2),s=r(15),u=r(0),c=r(28),l=new a.RegExpParser,p="PATTERN";function h(e){var t=u.filter(e,(function(e){return!u.has(e,p)}));return{errors:u.map(t,(function(e){return{message:"Token Type: ->"+o.tokenName(e)+"<- missing static 'PATTERN' property",type:s.LexerDefinitionErrorType.MISSING_PATTERN,tokenTypes:[e]}})),valid:u.difference(e,t)}}function f(e){var t=u.filter(e,(function(e){var t=e[p];return!(u.isRegExp(t)||u.isFunction(t)||u.has(t,"exec")||u.isString(t))}));return{errors:u.map(t,(function(e){return{message:"Token Type: ->"+o.tokenName(e)+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:s.LexerDefinitionErrorType.INVALID_PATTERN,tokenTypes:[e]}})),valid:u.difference(e,t)}}t.DEFAULT_MODE="defaultMode",t.MODES="modes",t.SUPPORT_STICKY="boolean"==typeof new RegExp("(?:)").sticky,t.disableSticky=function(){t.SUPPORT_STICKY=!1},t.enableSticky=function(){t.SUPPORT_STICKY=!0},t.analyzeTokenTypes=function(e,r){r=u.defaults(r,{useSticky:t.SUPPORT_STICKY,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"]});var n=u.reject(e,(function(e){return e[p]===s.Lexer.NA})),i=!1,a=u.map(n,(function(e){var t=e[p];if(u.isRegExp(t)){var n=t.source;return 1===n.length&&"^"!==n&&"$"!==n&&"."!==n?n:2!==n.length||"\\"!==n[0]||u.contains(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],n[1])?r.useSticky?w(t):R(t):n[1]}if(u.isFunction(t))return i=!0,{exec:t};if(u.has(t,"exec"))return i=!0,t;if("string"==typeof t){if(1===t.length)return t;var a=t.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),o=new RegExp(a);return r.useSticky?w(o):R(o)}throw Error("non exhaustive match")})),l=u.map(n,(function(e){return e.tokenTypeIdx})),h=u.map(n,(function(e){var t=e.GROUP;if(t!==s.Lexer.SKIPPED){if(u.isString(t))return t;if(u.isUndefined(t))return!1;throw Error("non exhaustive match")}})),f=u.map(n,(function(e){var t=e.LONGER_ALT;if(t)return u.indexOf(n,t)})),d=u.map(n,(function(e){return e.PUSH_MODE})),m=u.map(n,(function(e){return u.has(e,"POP_MODE")})),v=L(r.lineTerminatorCharacters),g=u.map(n,(function(e){return!1}));"onlyOffset"!==r.positionTracking&&(g=u.map(n,(function(e){return u.has(e,"LINE_BREAKS")?e.LINE_BREAKS:!1===k(e,v)?c.canMatchCharCode(v,e.PATTERN):void 0})));var y=u.map(n,N),T=u.map(a,S),E=u.reduce(n,(function(e,t){var r=t.GROUP;return u.isString(r)&&r!==s.Lexer.SKIPPED&&(e[r]=[]),e}),{}),A=u.map(a,(function(e,t){return{pattern:a[t],longerAlt:f[t],canLineTerminator:g[t],isCustom:y[t],short:T[t],group:h[t],push:d[t],pop:m[t],tokenTypeIdx:l[t],tokenType:n[t]}}));function x(e,t,r){void 0===e[t]&&(e[t]=[]),e[t].push(r)}var b=!0,_=[];return r.safeMode||(_=u.reduce(n,(function(e,t,n){if("string"==typeof t.PATTERN){var i=t.PATTERN.charCodeAt(0);x(e,i,A[n])}else if(u.isArray(t.START_CHARS_HINT))u.forEach(t.START_CHARS_HINT,(function(t){var r="string"==typeof t?t.charCodeAt(0):t;x(e,r,A[n])}));else if(u.isRegExp(t.PATTERN))if(t.PATTERN.unicode)b=!1,r.ensureOptimizations&&u.PRINT_ERROR(c.failedOptimizationPrefixMsg+"\tUnable to analyze < "+t.PATTERN.toString()+" > pattern.\n\tThe regexp unicode flag is not currently supported by the regexp-to-ast library.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE");else{var a=c.getStartCodes(t.PATTERN,r.ensureOptimizations);u.isEmpty(a)&&(b=!1),u.forEach(a,(function(t){x(e,t,A[n])}))}else r.ensureOptimizations&&u.PRINT_ERROR(c.failedOptimizationPrefixMsg+"\tTokenType: <"+o.tokenName(t)+"> is using a custom token pattern without providing <start_chars_hint> parameter.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE"),b=!1;return e}),[])),b&&_.length<65536&&(_=u.packArray(_)),{emptyGroups:E,patternIdxToConfig:A,charCodeToPatternIdxToConfig:_,hasCustom:i,canBeOptimized:b}},t.validatePatterns=function(e,t){var r=[],n=h(e);r=r.concat(n.errors);var i=f(n.valid),a=i.valid;return(r=(r=(r=(r=r.concat(i.errors)).concat(function(e){var t=[],r=u.filter(e,(function(e){return u.isRegExp(e[p])}));return(t=(t=(t=(t=t.concat(m(r))).concat(y(r))).concat(T(r))).concat(E(r))).concat(v(r))}(a))).concat(A(a))).concat(x(a,t))).concat(b(a))},t.findMissingPatterns=h,t.findInvalidPatterns=f;var d=/[^\\][\$]/;function m(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return i(t,e),t.prototype.visitEndAnchor=function(e){this.found=!0},t}(a.BaseRegExpVisitor),r=u.filter(e,(function(e){var r=e[p];try{var n=l.pattern(r.toString()),i=new t;return i.visit(n),i.found}catch(e){return d.test(r.source)}}));return u.map(r,(function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+o.tokenName(e)+"<- static 'PATTERN' cannot contain end of input anchor '$'\n\tSee sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:s.LexerDefinitionErrorType.EOI_ANCHOR_FOUND,tokenTypes:[e]}}))}function v(e){var t=u.filter(e,(function(e){return e[p].test("")}));return u.map(t,(function(e){return{message:"Token Type: ->"+o.tokenName(e)+"<- static 'PATTERN' must not match an empty string",type:s.LexerDefinitionErrorType.EMPTY_MATCH_PATTERN,tokenTypes:[e]}}))}t.findEndOfInputAnchor=m,t.findEmptyMatchRegExps=v;var g=/[^\\[][\^]|^\^/;function y(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return i(t,e),t.prototype.visitStartAnchor=function(e){this.found=!0},t}(a.BaseRegExpVisitor),r=u.filter(e,(function(e){var r=e[p];try{var n=l.pattern(r.toString()),i=new t;return i.visit(n),i.found}catch(e){return g.test(r.source)}}));return u.map(r,(function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+o.tokenName(e)+"<- static 'PATTERN' cannot contain start of input anchor '^'\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:s.LexerDefinitionErrorType.SOI_ANCHOR_FOUND,tokenTypes:[e]}}))}function T(e){var t=u.filter(e,(function(e){var t=e[p];return t instanceof RegExp&&(t.multiline||t.global)}));return u.map(t,(function(e){return{message:"Token Type: ->"+o.tokenName(e)+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:s.LexerDefinitionErrorType.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[e]}}))}function E(e){var t=[],r=u.map(e,(function(r){return u.reduce(e,(function(e,n){return r.PATTERN.source!==n.PATTERN.source||u.contains(t,n)||n.PATTERN===s.Lexer.NA||(t.push(n),e.push(n)),e}),[])}));r=u.compact(r);var n=u.filter(r,(function(e){return e.length>1}));return u.map(n,(function(e){var t=u.map(e,(function(e){return o.tokenName(e)}));return{message:"The same RegExp pattern ->"+u.first(e).PATTERN+"<-has been used in all of the following Token Types: "+t.join(", ")+" <-",type:s.LexerDefinitionErrorType.DUPLICATE_PATTERNS_FOUND,tokenTypes:e}}))}function A(e){var t=u.filter(e,(function(e){if(!u.has(e,"GROUP"))return!1;var t=e.GROUP;return t!==s.Lexer.SKIPPED&&t!==s.Lexer.NA&&!u.isString(t)}));return u.map(t,(function(e){return{message:"Token Type: ->"+o.tokenName(e)+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:s.LexerDefinitionErrorType.INVALID_GROUP_TYPE_FOUND,tokenTypes:[e]}}))}function x(e,t){var r=u.filter(e,(function(e){return void 0!==e.PUSH_MODE&&!u.contains(t,e.PUSH_MODE)}));return u.map(r,(function(e){return{message:"Token Type: ->"+o.tokenName(e)+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+e.PUSH_MODE+"<-which does not exist",type:s.LexerDefinitionErrorType.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[e]}}))}function b(e){var t=[],r=u.reduce(e,(function(e,t,r){var n,i=t.PATTERN;return i===s.Lexer.NA||(u.isString(i)?e.push({str:i,idx:r,tokenType:t}):u.isRegExp(i)&&(n=i,void 0===u.find([".","\\","[","]","|","^","$","(",")","?","*","+","{"],(function(e){return-1!==n.source.indexOf(e)})))&&e.push({str:i.source,idx:r,tokenType:t})),e}),[]);return u.forEach(e,(function(e,n){u.forEach(r,(function(r){var i=r.str,a=r.idx,c=r.tokenType;if(n<a&&function(e,t){if(u.isRegExp(t)){var r=t.exec(e);return null!==r&&0===r.index}if(u.isFunction(t))return t(e,0,[],{});if(u.has(t,"exec"))return t.exec(e,0,[],{});if("string"==typeof t)return t===e;throw Error("non exhaustive match")}(i,e.PATTERN)){var l="Token: ->"+o.tokenName(c)+"<- can never be matched.\nBecause it appears AFTER the Token Type ->"+o.tokenName(e)+"<-in the lexer's definition.\nSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE";t.push({message:l,type:s.LexerDefinitionErrorType.UNREACHABLE_PATTERN,tokenTypes:[e,c]})}}))})),t}function R(e){var t=e.ignoreCase?"i":"";return new RegExp("^(?:"+e.source+")",t)}function w(e){var t=e.ignoreCase?"iy":"y";return new RegExp(""+e.source,t)}function N(e){var t=e.PATTERN;if(u.isRegExp(t))return!1;if(u.isFunction(t))return!0;if(u.has(t,"exec"))return!0;if(u.isString(t))return!1;throw Error("non exhaustive match")}function S(e){return!(!u.isString(e)||1!==e.length)&&e.charCodeAt(0)}function k(e,t){if(u.has(e,"LINE_BREAKS"))return!1;if(u.isRegExp(e.PATTERN)){try{c.canMatchCharCode(t,e.PATTERN)}catch(e){return{issue:s.LexerDefinitionErrorType.IDENTIFY_TERMINATOR,errMsg:e.message}}return!1}if(u.isString(e.PATTERN))return!1;if(N(e))return{issue:s.LexerDefinitionErrorType.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function _(e,t){if(t.issue===s.LexerDefinitionErrorType.IDENTIFY_TERMINATOR)return"Warning: unable to identify line terminator usage in pattern.\n\tThe problem is in the <"+e.name+"> Token Type\n\t Root cause: "+t.errMsg+".\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(t.issue===s.LexerDefinitionErrorType.CUSTOM_LINE_BREAK)return"Warning: A Custom Token Pattern should specify the <line_breaks> option.\n\tThe problem is in the <"+e.name+"> Token Type\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function L(e){return u.map(e,(function(e){return u.isString(e)&&e.length>0?e.charCodeAt(0):e}))}t.findStartOfInputAnchor=y,t.findUnsupportedFlags=T,t.findDuplicatePatterns=E,t.findInvalidGroupType=A,t.findModesThatDoNotExist=x,t.findUnreachablePatterns=b,t.addStartOfInput=R,t.addStickyFlag=w,t.performRuntimeChecks=function(e,r,n){var i=[];return u.has(e,t.DEFAULT_MODE)||i.push({message:"A MultiMode Lexer cannot be initialized without a <"+t.DEFAULT_MODE+"> property in its definition\n",type:s.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),u.has(e,t.MODES)||i.push({message:"A MultiMode Lexer cannot be initialized without a <"+t.MODES+"> property in its definition\n",type:s.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),u.has(e,t.MODES)&&u.has(e,t.DEFAULT_MODE)&&!u.has(e.modes,e.defaultMode)&&i.push({message:"A MultiMode Lexer cannot be initialized with a "+t.DEFAULT_MODE+": <"+e.defaultMode+">which does not exist\n",type:s.LexerDefinitionErrorType.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),u.has(e,t.MODES)&&u.forEach(e.modes,(function(e,t){u.forEach(e,(function(e,r){u.isUndefined(e)&&i.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:<"+t+"> at index: <"+r+">\n",type:s.LexerDefinitionErrorType.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})}))})),i},t.performWarningRuntimeChecks=function(e,t,r){var n=[],i=!1,a=u.compact(u.flatten(u.mapValues(e.modes,(function(e){return e})))),o=u.reject(a,(function(e){return e[p]===s.Lexer.NA})),l=L(r);return t&&u.forEach(o,(function(e){var t=k(e,l);if(!1!==t){var r={message:_(e,t),type:t.issue,tokenType:e};n.push(r)}else u.has(e,"LINE_BREAKS")?!0===e.LINE_BREAKS&&(i=!0):c.canMatchCharCode(l,e.PATTERN)&&(i=!0)})),t&&!i&&n.push({message:"Warning: No LINE_BREAKS Found.\n\tThis Lexer has been defined to track line and column information,\n\tBut none of the Token Types can be identified as matching a line terminator.\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n\tfor details.",type:s.LexerDefinitionErrorType.NO_LINE_BREAKS_FLAGS}),n},t.cloneEmptyGroups=function(e){var t={},r=u.keys(e);return u.forEach(r,(function(r){var n=e[r];if(!u.isArray(n))throw Error("non exhaustive match");t[r]=[]})),t},t.isCustomPattern=N,t.isShortPattern=S,t.LineTerminatorOptimizedTester={test:function(e){for(var t=e.length,r=this.lastIndex;r<t;r++){var n=e.charCodeAt(r);if(10===n)return this.lastIndex=r+1,!0;if(13===n)return 10===e.charCodeAt(r+1)?this.lastIndex=r+2:this.lastIndex=r+1,!0}return!1},lastIndex:0},t.buildLineBreakIssueMessage=_},function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(19),o=r(0),s=new a.RegExpParser,u="Complement Sets are not supported for first char optimization";function c(e){switch(e.type){case"Disjunction":return o.flatten(o.map(e.value,c));case"Alternative":for(var t=[],r=e.value,n=0;n<r.length;n++){var i=r[n];if(!o.contains(["GroupBackReference","Lookahead","NegativeLookahead","StartAnchor","EndAnchor","WordBoundary","NonWordBoundary"],i.type)){var a=i;switch(a.type){case"Character":t.push(a.value);break;case"Set":if(!0===a.complement)throw Error(u);o.forEach(a.value,(function(e){if("number"==typeof e)t.push(e);else for(var r=e,n=r.from;n<=r.to;n++)t.push(n)}));break;case"Group":var s=c(a.value);o.forEach(s,(function(e){return t.push(e)}));break;default:throw Error("Non Exhaustive Match")}var l=void 0!==a.quantifier&&0===a.quantifier.atLeast;if("Group"===a.type&&!1===h(a)||"Group"!==a.type&&!1===l)break}}return t;default:throw Error("non exhaustive match!")}}function l(e){var t=[];return o.forEach(e,(function(e){t.push(e);var r=String.fromCharCode(e);r.toUpperCase()!==r?t.push(r.toUpperCase().charCodeAt(0)):r.toLowerCase()!==r&&t.push(r.toLowerCase().charCodeAt(0))})),t}function p(e,t){return o.find(e.value,(function(e){if("number"==typeof e)return o.contains(t,e);var r=e;return void 0!==o.find(t,(function(e){return r.from<=e&&e<=r.to}))}))}function h(e){return!(!e.quantifier||0!==e.quantifier.atLeast)||!!e.value&&(o.isArray(e.value)?o.every(e.value,h):h(e.value))}t.failedOptimizationPrefixMsg='Unable to use "first char" lexer optimizations:\n',t.getStartCodes=function(e,r){void 0===r&&(r=!1);try{var n=s.pattern(e.toString()),i=c(n.value);return n.flags.ignoreCase&&(i=l(i)),i}catch(n){if(n.message===u)r&&o.PRINT_WARNING(t.failedOptimizationPrefixMsg+"\tUnable to optimize: < "+e.toString()+" >\n\tComplement Sets cannot be automatically optimized.\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.");else{var p="";r&&(p="\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."),o.PRINT_ERROR(t.failedOptimizationPrefixMsg+"\n\tFailed parsing: < "+e.toString()+" >\n\tUsing the regexp-to-ast library version: "+a.VERSION+"\n\tPlease open an issue at: https://github.com/bd82/regexp-to-ast/issues"+p)}}return[]},t.firstChar=c,t.applyIgnoreCase=l;var f=function(e){function t(t){var r=e.call(this)||this;return r.targetCharCodes=t,r.found=!1,r}return i(t,e),t.prototype.visitChildren=function(t){switch(t.type){case"Lookahead":return void this.visitLookahead(t);case"NegativeLookahead":return void this.visitNegativeLookahead(t)}e.prototype.visitChildren.call(this,t)},t.prototype.visitCharacter=function(e){o.contains(this.targetCharCodes,e.value)&&(this.found=!0)},t.prototype.visitSet=function(e){e.complement?void 0===p(e,this.targetCharCodes)&&(this.found=!0):void 0!==p(e,this.targetCharCodes)&&(this.found=!0)},t}(a.BaseRegExpVisitor);t.canMatchCharCode=function(e,t){if(t instanceof RegExp){var r=s.pattern(t.toString()),n=new f(e);return n.visit(r),n.found}return void 0!==o.find(t,(function(t){return o.contains(e,t.charCodeAt(0))}))}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){if(this.start=e,this.end=t,!i(e,t))throw new Error("INVALID RANGE")}return e.prototype.contains=function(e){return this.start<=e&&this.end>=e},e.prototype.containsRange=function(e){return this.start<=e.start&&this.end>=e.end},e.prototype.isContainedInRange=function(e){return e.containsRange(this)},e.prototype.strictlyContainsRange=function(e){return this.start<e.start&&this.end>e.end},e.prototype.isStrictlyContainedInRange=function(e){return e.strictlyContainsRange(this)},e}();function i(e,t){return!(e<0||t<e)}t.Range=n,t.isValidRange=i},function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(3),o=r(0),s=r(5);t.resolveGrammar=function(e,t){var r=new u(e,t);return r.resolveRefs(),r.errors};var u=function(e){function t(t,r){var n=e.call(this)||this;return n.nameToTopRule=t,n.errMsgProvider=r,n.errors=[],n}return i(t,e),t.prototype.resolveRefs=function(){var e=this;o.forEach(this.nameToTopRule.values(),(function(t){e.currTopLevel=t,t.accept(e)}))},t.prototype.visitNonTerminal=function(e){var t=this.nameToTopRule.get(e.nonTerminalName);if(t)e.referencedRule=t;else{var r=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:r,type:a.ParserDefinitionErrorType.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}},t}(s.GAstVisitor);t.GastRefResolverVisitor=u},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(12),i=r(0),a=r(3),o=r(9),s=function(){function e(){}return e.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=i.has(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:a.DEFAULT_PARSER_CONFIG.dynamicTokensEnabled,this.maxLookahead=i.has(e,"maxLookahead")?e.maxLookahead:a.DEFAULT_PARSER_CONFIG.maxLookahead,this.lookAheadFuncsCache=i.isES2015MapSupported()?new Map:[],i.isES2015MapSupported()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},e.prototype.lookAheadBuilderForOptional=function(e,t,r){return n.buildSingleAlternativeLookaheadFunction(e,t,r)},e.prototype.lookAheadBuilderForAlternatives=function(e,t,r,i){return n.buildAlternativesLookAheadFunc(e,t,r,i)},e.prototype.getKeyForAutomaticLookahead=function(e,t){var r=this.getLastExplicitRuleShortName();return o.getKeyForAutomaticLookahead(r,e,t)},e.prototype.getLookaheadFuncForOr=function(e,t){var r=this.getKeyForAutomaticLookahead(o.OR_IDX,e),a=this.getLaFuncFromCache(r);if(void 0===a){var s=this.getCurrRuleFullName(),u=this.getGAstProductions().get(s),c=i.some(t,(function(e){return i.isFunction(e.GATE)}));return a=n.buildLookaheadFuncForOr(e,u,this.maxLookahead,c,this.dynamicTokensEnabled,this.lookAheadBuilderForAlternatives),this.setLaFuncCache(r,a),a}return a},e.prototype.getLookaheadFuncForOption=function(e,t){return this.getLookaheadFuncFor(e,t,this.maxLookahead,n.PROD_TYPE.OPTION)},e.prototype.getLookaheadFuncForMany=function(e,t){return this.getLookaheadFuncFor(e,t,this.maxLookahead,n.PROD_TYPE.REPETITION)},e.prototype.getLookaheadFuncForManySep=function(e,t){return this.getLookaheadFuncFor(e,t,this.maxLookahead,n.PROD_TYPE.REPETITION_WITH_SEPARATOR)},e.prototype.getLookaheadFuncForAtLeastOne=function(e,t){return this.getLookaheadFuncFor(e,t,this.maxLookahead,n.PROD_TYPE.REPETITION_MANDATORY)},e.prototype.getLookaheadFuncForAtLeastOneSep=function(e,t){return this.getLookaheadFuncFor(e,t,this.maxLookahead,n.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR)},e.prototype.getLookaheadFuncFor=function(e,t,r,i){var a=this.getLaFuncFromCache(e);if(void 0===a){var o=this.getCurrRuleFullName(),s=this.getGAstProductions().get(o);return a=n.buildLookaheadFuncForOptionalProd(t,s,r,this.dynamicTokensEnabled,i,this.lookAheadBuilderForOptional),this.setLaFuncCache(e,a),a}return a},e.prototype.getLaFuncFromCache=function(e){},e.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},e.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},e.prototype.setLaFuncCache=function(e,t){},e.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},e.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},e}();t.LooksAhead=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(16),i=r(0),a=r(33),o=r(9),s=r(3),u=function(){function e(){}return e.prototype.initTreeBuilder=function(e){this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=i.has(e,"outputCst")?e.outputCst:s.DEFAULT_PARSER_CONFIG.outputCst,this.outputCst||(this.cstInvocationStateUpdate=i.NOOP,this.cstFinallyStateUpdate=i.NOOP,this.cstPostTerminal=i.NOOP,this.cstPostNonTerminal=i.NOOP,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst)},e.prototype.cstNestedInvocationStateUpdate=function(e,t){this.CST_STACK.push({name:e,fullName:this.shortRuleNameToFull.get(this.getLastExplicitRuleShortName())+e,children:{}})},e.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1),this.CST_STACK.push({name:e,children:{}})},e.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},e.prototype.cstNestedFinallyStateUpdate=function(){this.CST_STACK.pop()},e.prototype.cstPostTerminal=function(e,t){var r=this.CST_STACK[this.CST_STACK.length-1];n.addTerminalToCst(r,t,e)},e.prototype.cstPostNonTerminal=function(e,t){n.addNoneTerminalToCst(this.CST_STACK[this.CST_STACK.length-1],t,e)},e.prototype.getBaseCstVisitorConstructor=function(){if(i.isUndefined(this.baseCstVisitorConstructor)){var e=a.createBaseSemanticVisitorConstructor(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},e.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(i.isUndefined(this.baseCstVisitorWithDefaultsConstructor)){var e=a.createBaseVisitorConstructorWithDefaults(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},e.prototype.nestedRuleBeforeClause=function(e,t){var r;return void 0!==e.NAME?(r=e.NAME,this.nestedRuleInvocationStateUpdate(r,t),r):void 0},e.prototype.nestedAltBeforeClause=function(e,t,r,n){var i,a=this.getLastExplicitRuleShortName(),s=o.getKeyForAltIndex(a,r,t,n);return void 0!==e.NAME?(i=e.NAME,this.nestedRuleInvocationStateUpdate(i,s),{shortName:s,nestedName:i}):void 0},e.prototype.nestedRuleFinallyClause=function(e,t){var r=this.CST_STACK,i=r[r.length-1];this.nestedRuleFinallyStateUpdate();var a=r[r.length-1];n.addNoneTerminalToCst(a,t,i)},e.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},e.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},e.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},e.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},e.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},e.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},e.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},e.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},e}();t.TreeBuilder=u},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(0),a=r(4),o=r(11);function s(e,t){for(var r=i.keys(e),n=r.length,a=0;a<n;a++)for(var o=e[r[a]],s=o.length,u=0;u<s;u++){var c=o[u];void 0===c.tokenTypeIdx&&(void 0!==c.fullName?this[c.fullName](c.children,t):this[c.name](c.children,t))}}function u(e,t){var r=c(e,t),n=p(e,t);return r.concat(n)}function c(e,t){var r=i.map(t,(function(t){if(!i.isFunction(e[t]))return{msg:"Missing visitor method: <"+t+"> on "+a.functionName(e.constructor)+" CST Visitor.",type:n.MISSING_METHOD,methodName:t}}));return i.compact(r)}t.defaultVisit=s,t.createBaseSemanticVisitorConstructor=function(e,t){var r=function(){};return a.defineNameProp(r,e+"BaseSemantics"),(r.prototype={visit:function(e,t){if(i.isArray(e)&&(e=e[0]),!i.isUndefined(e))return void 0!==e.fullName?this[e.fullName](e.children,t):this[e.name](e.children,t)},validateVisitor:function(){var e=u(this,t);if(!i.isEmpty(e)){var r=i.map(e,(function(e){return e.msg}));throw Error("Errors Detected in CST Visitor <"+a.functionName(this.constructor)+">:\n\t"+r.join("\n\n").replace(/\n/g,"\n\t"))}}}).constructor=r,r._RULE_NAMES=t,r},t.createBaseVisitorConstructorWithDefaults=function(e,t,r){var n=function(){};a.defineNameProp(n,e+"BaseSemanticsWithDefaults");var o=Object.create(r.prototype);return i.forEach(t,(function(e){o[e]=s})),(n.prototype=o).constructor=n,n},function(e){e[e.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",e[e.MISSING_METHOD=1]="MISSING_METHOD"}(n=t.CstVisitorDefinitionError||(t.CstVisitorDefinitionError={})),t.validateVisitor=u,t.validateMissingCstMethods=c;var l=["constructor","visit","validateVisitor"];function p(e,t){var r=[];for(var s in e)o.validTermsPattern.test(s)&&i.isFunction(e[s])&&!i.contains(l,s)&&!i.contains(t,s)&&r.push({msg:"Redundant visitor method: <"+s+"> on "+a.functionName(e.constructor)+" CST Visitor\nThere is no Grammar Rule corresponding to this method's name.\nFor utility methods on visitor classes use methods names that do not match /"+o.validTermsPattern.source+"/.",type:n.REDUNDANT_METHOD,methodName:s});return r}t.validateRedundantMethods=p},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=function(){function e(){}return e.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(e.prototype,"input",{get:function(){return this.tokVector},set:function(e){this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),e.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):n.END_OF_FILE},e.prototype.LA=function(e){return this.currIdx+e<0||this.tokVectorLength<=this.currIdx+e?n.END_OF_FILE:this.tokVector[this.currIdx+e]},e.prototype.consumeToken=function(){this.currIdx++},e.prototype.exportLexerState=function(){return this.currIdx},e.prototype.importLexerState=function(e){this.currIdx=e},e.prototype.resetLexerState=function(){this.currIdx=-1},e.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},e.prototype.getLexerPosition=function(){return this.exportLexerState()},e}();t.LexerAdapter=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(6),a=r(3),o=r(10),s=r(23),u=r(11),c=r(1),l=function(){function e(){}return e.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},e.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},e.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},e.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},e.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},e.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},e.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},e.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},e.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},e.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},e.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},e.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},e.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},e.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},e.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},e.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},e.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},e.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},e.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},e.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},e.prototype.OPTION=function(e){return this.optionInternal(e,0)},e.prototype.OPTION1=function(e){return this.optionInternal(e,1)},e.prototype.OPTION2=function(e){return this.optionInternal(e,2)},e.prototype.OPTION3=function(e){return this.optionInternal(e,3)},e.prototype.OPTION4=function(e){return this.optionInternal(e,4)},e.prototype.OPTION5=function(e){return this.optionInternal(e,5)},e.prototype.OPTION6=function(e){return this.optionInternal(e,6)},e.prototype.OPTION7=function(e){return this.optionInternal(e,7)},e.prototype.OPTION8=function(e){return this.optionInternal(e,8)},e.prototype.OPTION9=function(e){return this.optionInternal(e,9)},e.prototype.OR=function(e){return this.orInternal(e,0)},e.prototype.OR1=function(e){return this.orInternal(e,1)},e.prototype.OR2=function(e){return this.orInternal(e,2)},e.prototype.OR3=function(e){return this.orInternal(e,3)},e.prototype.OR4=function(e){return this.orInternal(e,4)},e.prototype.OR5=function(e){return this.orInternal(e,5)},e.prototype.OR6=function(e){return this.orInternal(e,6)},e.prototype.OR7=function(e){return this.orInternal(e,7)},e.prototype.OR8=function(e){return this.orInternal(e,8)},e.prototype.OR9=function(e){return this.orInternal(e,9)},e.prototype.MANY=function(e){this.manyInternal(0,e)},e.prototype.MANY1=function(e){this.manyInternal(1,e)},e.prototype.MANY2=function(e){this.manyInternal(2,e)},e.prototype.MANY3=function(e){this.manyInternal(3,e)},e.prototype.MANY4=function(e){this.manyInternal(4,e)},e.prototype.MANY5=function(e){this.manyInternal(5,e)},e.prototype.MANY6=function(e){this.manyInternal(6,e)},e.prototype.MANY7=function(e){this.manyInternal(7,e)},e.prototype.MANY8=function(e){this.manyInternal(8,e)},e.prototype.MANY9=function(e){this.manyInternal(9,e)},e.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},e.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},e.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},e.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},e.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},e.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},e.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},e.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},e.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},e.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},e.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},e.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},e.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},e.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},e.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},e.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},e.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},e.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},e.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},e.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},e.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},e.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},e.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},e.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},e.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},e.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},e.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},e.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},e.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},e.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},e.prototype.RULE=function(e,t,r){if(void 0===r&&(r=a.DEFAULT_RULE_CONFIG),n.contains(this.definedRulesNames,e)){var i={message:o.defaultGrammarValidatorErrorProvider.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:a.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(i)}if(this.definedRulesNames.push(e),!this.gastProductionsCache.containsKey(e)&&!this.serializedGrammar){var u=s.buildTopProduction(t.toString(),e,this.tokensMap);this.gastProductionsCache.put(e,u)}var c=this.defineRule(e,t,r);return this[e]=c,c},e.prototype.OVERRIDE_RULE=function(e,t,r){void 0===r&&(r=a.DEFAULT_RULE_CONFIG);var n=[];if(n=n.concat(u.validateRuleIsOverridden(e,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,n),!this.serializedGrammar){var i=s.buildTopProduction(t.toString(),e,this.tokensMap);this.gastProductionsCache.put(e,i)}var o=this.defineRule(e,t,r);return this[e]=o,o},e.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var r=this.saveRecogState();try{return e.apply(this,t),!0}catch(e){if(i.isRecognitionException(e))return!1;throw e}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}},e.prototype.getGAstProductions=function(){return this.gastProductionsCache},e.prototype.getSerializedGastProductions=function(){return c.serializeGrammar(this.gastProductionsCache.values())},e}();t.RecognizerApi=l},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(9),a=r(6),o=r(12),s=r(13),u=r(3),c=r(25),l=r(2),p=r(7),h=r(4),f=function(){function e(){}return e.prototype.initRecognizerEngine=function(e,t){if(this.className=h.classNameFromInstance(this),this.shortRuleNameToFull=new h.HashTable,this.fullRuleNameToShort=new h.HashTable,this.ruleShortNameIdx=256,this.tokenMatcher=p.tokenStructuredMatcherNoCategories,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache=new h.HashTable,this.serializedGrammar=n.has(t,"serializedGrammar")?t.serializedGrammar:u.DEFAULT_PARSER_CONFIG.serializedGrammar,n.isArray(e)){if(n.isEmpty(e))throw Error("A Token Vocabulary cannot be empty.\n\tNote that the first argument for the parser constructor\n\tis no longer a Token vector (since v4.0).");if("number"==typeof e[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0\n\tFor Further details.")}if(n.isArray(e))this.tokensMap=n.reduce(e,(function(e,t){return e[l.tokenName(t)]=t,e}),{});else if(n.has(e,"modes")&&n.every(n.flatten(n.values(e.modes)),p.isTokenType)){var r=n.flatten(n.values(e.modes)),i=n.uniq(r);this.tokensMap=n.reduce(i,(function(e,t){return e[l.tokenName(t)]=t,e}),{})}else{if(!n.isObject(e))throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap=n.cloneObj(e)}this.tokensMap.EOF=l.EOF;var a=n.every(n.values(e),(function(e){return n.isEmpty(e.categoryMatches)}));this.tokenMatcher=a?p.tokenStructuredMatcherNoCategories:p.tokenStructuredMatcher,p.augmentTokenTypes(n.values(this.tokensMap))},e.prototype.defineRule=function(e,t,r){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+"> may not be defined after the 'performSelfAnalysis' method has been called'\nMake sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var o,s=n.has(r,"resyncEnabled")?r.resyncEnabled:u.DEFAULT_RULE_CONFIG.resyncEnabled,c=n.has(r,"recoveryValueFunc")?r.recoveryValueFunc:u.DEFAULT_RULE_CONFIG.recoveryValueFunc,l=this.ruleShortNameIdx<<i.BITS_FOR_METHOD_IDX+i.BITS_FOR_OCCURRENCE_IDX;return this.ruleShortNameIdx++,this.shortRuleNameToFull.put(l,e),this.fullRuleNameToShort.put(e,l),(o=function(r,n){return void 0===r&&(r=0),this.ruleInvocationStateUpdate(l,e,r),function(e){try{return!0===this.outputCst?(t.apply(this,e),this.CST_STACK[this.CST_STACK.length-1]):t.apply(this,e)}catch(e){var r=1===this.RULE_STACK.length,n=s&&!this.isBackTracking()&&this.recoveryEnabled;if(a.isRecognitionException(e)){if(n){var i,o=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(o))return e.resyncedTokens=this.reSyncTo(o),this.outputCst?((i=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,i):c();throw this.outputCst&&((i=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,e.partialCstResult=i),e}if(r)return this.moveToTerminatedState(),c();throw e}throw e}finally{this.ruleFinallyStateUpdate()}}.call(this,n)}).ruleName=e,o},e.prototype.optionInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.OPTION_IDX,t),n=this.nestedRuleBeforeClause(e,r);try{return this.optionInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.optionInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(i.OPTION_IDX,t);return this.optionInternalLogic(e,t,r)},e.prototype.optionInternalLogic=function(e,t,r){var n,i,a=this,o=this.getLookaheadFuncForOption(r,t);if(void 0!==e.DEF){if(n=e.DEF,void 0!==(i=e.GATE)){var s=o;o=function(){return i.call(a)&&s.call(a)}}}else n=e;if(!0===o.call(this))return n.call(this)},e.prototype.atLeastOneInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.AT_LEAST_ONE_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{return this.atLeastOneInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.atLeastOneInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(i.AT_LEAST_ONE_IDX,e);this.atLeastOneInternalLogic(e,t,r)},e.prototype.atLeastOneInternalLogic=function(e,t,r){var n,a,u=this,c=this.getLookaheadFuncForAtLeastOne(r,e);if(void 0!==t.DEF){if(n=t.DEF,void 0!==(a=t.GATE)){var l=c;c=function(){return a.call(u)&&l.call(u)}}}else n=t;if(!0!==c.call(this))throw this.raiseEarlyExitException(e,o.PROD_TYPE.REPETITION_MANDATORY,t.ERR_MSG);for(var p=this.doSingleRepetition(n);!0===c.call(this)&&!0===p;)p=this.doSingleRepetition(n);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],c,i.AT_LEAST_ONE_IDX,e,s.NextTerminalAfterAtLeastOneWalker)},e.prototype.atLeastOneSepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.AT_LEAST_ONE_SEP_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{this.atLeastOneSepFirstInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(i.AT_LEAST_ONE_SEP_IDX,e);this.atLeastOneSepFirstInternalLogic(e,t,r)},e.prototype.atLeastOneSepFirstInternalLogic=function(e,t,r){var n=this,a=t.DEF,u=t.SEP;if(!0!==this.getLookaheadFuncForAtLeastOneSep(r,e).call(this))throw this.raiseEarlyExitException(e,o.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG);a.call(this);for(var c=function(){return n.tokenMatcher(n.LA(1),u)};!0===this.tokenMatcher(this.LA(1),u);)this.CONSUME(u),a.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,u,c,a,s.NextTerminalAfterAtLeastOneSepWalker],c,i.AT_LEAST_ONE_SEP_IDX,e,s.NextTerminalAfterAtLeastOneSepWalker)},e.prototype.manyInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.MANY_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{return this.manyInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.manyInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(i.MANY_IDX,e);return this.manyInternalLogic(e,t,r)},e.prototype.manyInternalLogic=function(e,t,r){var n,a,o=this,u=this.getLookaheadFuncForMany(r,e);if(void 0!==t.DEF){if(n=t.DEF,void 0!==(a=t.GATE)){var c=u;u=function(){return a.call(o)&&c.call(o)}}}else n=t;for(var l=!0;!0===u.call(this)&&!0===l;)l=this.doSingleRepetition(n);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],u,i.MANY_IDX,e,s.NextTerminalAfterManyWalker)},e.prototype.manySepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.MANY_SEP_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{this.manySepFirstInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.manySepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(i.MANY_SEP_IDX,e);this.manySepFirstInternalLogic(e,t,r)},e.prototype.manySepFirstInternalLogic=function(e,t,r){var n=this,a=t.DEF,o=t.SEP;if(!0===this.getLookaheadFuncForManySep(r,e).call(this)){a.call(this);for(var u=function(){return n.tokenMatcher(n.LA(1),o)};!0===this.tokenMatcher(this.LA(1),o);)this.CONSUME(o),a.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,u,a,s.NextTerminalAfterManySepWalker],u,i.MANY_SEP_IDX,e,s.NextTerminalAfterManySepWalker)}},e.prototype.repetitionSepSecondInternal=function(e,t,r,n,a){for(;r();)this.CONSUME(t),n.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,r,n,a],r,i.AT_LEAST_ONE_SEP_IDX,e,a)},e.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();return e.call(this),this.getLexerPosition()>t},e.prototype.orInternalNoCst=function(e,t){var r=n.isArray(e)?e:e.DEF,i=this.getLookaheadFuncForOr(t,r).call(this,r);if(void 0!==i)return r[i].ALT.call(this);this.raiseNoAltException(t,e.ERR_MSG)},e.prototype.orInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.OR_IDX,t),a=this.nestedRuleBeforeClause(e,r);try{var o=n.isArray(e)?e:e.DEF,s=this.getLookaheadFuncForOr(t,o).call(this,o);if(void 0!==s){var u=o[s],c=this.nestedAltBeforeClause(u,t,i.OR_IDX,s);try{return u.ALT.call(this)}finally{void 0!==c&&this.nestedRuleFinallyClause(c.shortName,c.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{void 0!==a&&this.nestedRuleFinallyClause(r,a)}},e.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!this.isAtEndOfInput()){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new a.NotAllInputParsedException(t,e))}},e.prototype.subruleInternal=function(e,t,r){var n;try{var i=void 0!==r?r.ARGS:void 0;return n=e.call(this,t,i),this.cstPostNonTerminal(n,void 0!==r&&void 0!==r.LABEL?r.LABEL:e.ruleName),n}catch(t){throw a.isRecognitionException(t)&&void 0!==t.partialCstResult&&(this.cstPostNonTerminal(t.partialCstResult,void 0!==r&&void 0!==r.LABEL?r.LABEL:e.ruleName),delete t.partialCstResult),t}},e.prototype.consumeInternal=function(e,t,r){var n;try{var i=this.LA(1);if(!0!==this.tokenMatcher(i,e)){var o,s=this.LA(0);throw o=void 0!==r&&r.ERR_MSG?r.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:i,previous:s,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new a.MismatchedTokenException(o,i,s))}this.consumeToken(),n=i}catch(r){if(!this.recoveryEnabled||"MismatchedTokenException"!==r.name||this.isBackTracking())throw r;var u=this.getFollowsForInRuleRecovery(e,t);try{n=this.tryInRuleRecovery(e,u)}catch(e){throw e.name===c.IN_RULE_RECOVERY_EXCEPTION?r:e}}return this.cstPostTerminal(void 0!==r&&void 0!==r.LABEL?r.LABEL:e.tokenName,n),n},e.prototype.saveRecogState=function(){var e=this.errors,t=n.cloneArr(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},e.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},e.prototype.ruleInvocationStateUpdate=function(e,t,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},e.prototype.isBackTracking=function(){return!n.isEmpty(this.isBackTrackingStack)},e.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull.get(e)},e.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull.get(e)},e.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),l.EOF)},e.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},e}();t.RecognizerEngine=f},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=r(0),a=r(12),o=r(3),s=function(){function e(){}return e.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=i.defaults(e.errorMessageProvider,o.DEFAULT_PARSER_CONFIG.errorMessageProvider)},e.prototype.SAVE_ERROR=function(e){if(n.isRecognitionException(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:i.cloneArr(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(e.prototype,"errors",{get:function(){return i.cloneArr(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),e.prototype.raiseEarlyExitException=function(e,t,r){for(var i=this.getCurrRuleFullName(),o=this.getGAstProductions().get(i),s=a.getLookaheadPathsForOptionalProd(e,o,t,this.maxLookahead)[0],u=[],c=1;c<this.maxLookahead;c++)u.push(this.LA(c));var l=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:s,actual:u,previous:this.LA(0),customUserDescription:r,ruleName:i});throw this.SAVE_ERROR(new n.EarlyExitException(l,this.LA(1),this.LA(0)))},e.prototype.raiseNoAltException=function(e,t){for(var r=this.getCurrRuleFullName(),i=this.getGAstProductions().get(r),o=a.getLookaheadPathsForOr(e,i,this.maxLookahead),s=[],u=1;u<=this.maxLookahead;u++)s.push(this.LA(u));var c=this.LA(0),l=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:o,actual:s,previous:c,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new n.NoViableAltException(l,this.LA(1),c))},e}();t.ErrorHandler=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(13),i=r(0),a=function(){function e(){}return e.prototype.initContentAssist=function(){},e.prototype.computeContentAssist=function(e,t){var r=this.gastProductionsCache.get(e);if(i.isUndefined(r))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return n.nextPossibleTokensAfter([r],t,this.tokenMatcher,this.maxLookahead)},e.prototype.getNextPossibleTokenTypes=function(e){var t=i.first(e.ruleStack),r=this.getGAstProductions().get(t);return new n.NextAfterTokenWalker(r,e).startWalking()},e}();t.ContentAssist=a},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(17);t.createSyntaxDiagramsCode=function(e,t){var r=void 0===t?{}:t,i=r.resourceBase,a=void 0===i?"https://unpkg.com/chevrotain@"+n.VERSION+"/diagrams/":i,o=r.css;return"\n\x3c!-- This is a generated file --\x3e\n<!DOCTYPE html>\n<meta charset=\"utf-8\">\n<style>\n  body {\n    background-color: hsl(30, 20%, 95%)\n  }\n</style>\n\n\n<link rel='stylesheet' href='"+(void 0===o?"https://unpkg.com/chevrotain@"+n.VERSION+"/diagrams/diagrams.css":o)+"'>\n\n<script src='"+a+"vendor/railroad-diagrams.js'><\/script>\n<script src='"+a+"src/diagrams_builder.js'><\/script>\n<script src='"+a+"src/diagrams_behavior.js'><\/script>\n<script src='"+a+'src/main.js\'><\/script>\n\n<div id="diagrams" align="center"></div>    \n\n<script>\n    window.serializedGrammar = '+JSON.stringify(e,null,"  ")+';\n<\/script>\n\n<script>\n    var diagramsDiv = document.getElementById("diagrams");\n    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);\n<\/script>\n'}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(41);t.generateParserFactory=function(e){var t=n.genWrapperFunction({name:e.name,rules:e.rules}),i=new Function("tokenVocabulary","config","chevrotain",t);return function(t){return i(e.tokenVocabulary,t,r(18))}},t.generateParserModule=function(e){return n.genUmdModule({name:e.name,rules:e.rules})}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(2),a=r(1),o="\n";function s(e){return"\nfunction "+e.name+"(tokenVocabulary, config) {\n    // invoke super constructor\n    // No support for embedded actions currently, so we can 'hardcode'\n    // The use of CstParser.\n    chevrotain.CstParser.call(this, tokenVocabulary, config)\n\n    const $ = this\n\n    "+u(e.rules)+"\n\n    // very important to call this after all the rules have been defined.\n    // otherwise the parser may not work correctly as it will lack information\n    // derived during the self analysis phase.\n    this.performSelfAnalysis(this)\n}\n\n// inheritance as implemented in javascript in the previous decade... :(\n"+e.name+".prototype = Object.create(chevrotain.CstParser.prototype)\n"+e.name+".prototype.constructor = "+e.name+"    \n    "}function u(e){return n.map(e,(function(e){return c(e,1)})).join("\n")}function c(e,t){var r=g(t,'$.RULE("'+e.name+'", function() {')+o;return(r+=v(e.definition,t+1))+(g(t+1,"})")+o)}function l(e,t){var r=i.tokenName(e.terminalType);return g(t,"$.CONSUME"+e.idx+"(this.tokensMap."+r+")"+o)}function p(e,t){return g(t,"$.SUBRULE"+e.idx+"($."+e.nonTerminalName+")"+o)}function h(e,t){var r=g(t,"$.OR"+e.idx+"([")+o;return(r+=n.map(e.definition,(function(e){return f(e,t+1)})).join(",\n"))+(o+g(t,"])\n"))}function f(e,t){var r=g(t,"{")+o;return e.name&&(r+=g(t+1,'NAME: "'+e.name+'",')+o),r+=g(t+1,"ALT: function() {")+o,r+=v(e.definition,t+1),(r+=g(t+1,"}")+o)+g(t,"}")}function d(e,t,r){var n=g(r,"$."+(e+t.idx)+"(");return t.name||t.separator?(n+="{\n",t.name&&(n+=g(r+1,'NAME: "'+t.name+'"')+","+o),t.separator&&(n+=g(r+1,"SEP: this.tokensMap."+i.tokenName(t.separator))+","+o),n+="DEF: "+m(t.definition,r+2)+o,n+=g(r,"}")+o):n+=m(t.definition,r+1),n+(g(r,")")+o)}function m(e,t){var r="function() {\n";return(r+=v(e,t))+(g(t,"}")+o)}function v(e,t){var r="";return n.forEach(e,(function(e){r+=function(e,t){if(e instanceof a.NonTerminal)return p(e,t);if(e instanceof a.Option)return d("OPTION",e,t);if(e instanceof a.RepetitionMandatory)return d("AT_LEAST_ONE",e,t);if(e instanceof a.RepetitionMandatoryWithSeparator)return d("AT_LEAST_ONE_SEP",e,t);if(e instanceof a.RepetitionWithSeparator)return d("MANY_SEP",e,t);if(e instanceof a.Repetition)return d("MANY",e,t);if(e instanceof a.Alternation)return h(e,t);if(e instanceof a.Terminal)return l(e,t);if(e instanceof a.Flat)return v(e.definition,t);throw Error("non exhaustive match")}(e,t+1)})),r}function g(e,t){return Array(4*e+1).join(" ")+t}t.genUmdModule=function(e){return"\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(['chevrotain'], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory(require('chevrotain'));\n    } else {\n        // Browser globals (root is window)\n        root.returnExports = factory(root.b);\n    }\n}(typeof self !== 'undefined' ? self : this, function (chevrotain) {\n\n"+s(e)+"\n    \nreturn {\n    "+e.name+": "+e.name+" \n}\n}));\n"},t.genWrapperFunction=function(e){return"    \n"+s(e)+"\nreturn new "+e.name+"(tokenVocabulary, config)    \n"},t.genClass=s,t.genAllRules=u,t.genRule=c,t.genTerminal=l,t.genNonTerminal=p,t.genAlternation=h,t.genSingleAlt=f}])},"object"==typeof exports?e.exports=i():"function"==typeof define&&r.amdO?define("chevrotain",[],i):"object"==typeof exports?exports.chevrotain=i():n.chevrotain=i();var a=window.chevrotain},9225:function(e,t,r){"use strict";r.d(t,{G:function(){return a}});var n=r(2212),i=function(e){n.Loader.call(this,e)};i.prototype=Object.assign(Object.create(n.Loader.prototype),{constructor:i,load:function(e,t,r,i){var a=this,o=new n.Texture,s=new n.FileLoader(this.manager);return s.setResponseType("arraybuffer"),s.setPath(this.path),s.setWithCredentials(this.withCredentials),s.load(e,(function(e){o.image=a.parse(e),o.needsUpdate=!0,void 0!==t&&t(o)}),r,i),o},parse:function(e){var t=0,r=1,n=2,i=3,a=9,o=10,s=11,u=48,c=4,l=0,p=1,h=2,f=3;e.length<19&&console.error("THREE.TGALoader: Not enough data to contain header.");var d=new Uint8Array(e),m=0,v={id_length:d[m++],colormap_type:d[m++],image_type:d[m++],colormap_index:d[m++]|d[m++]<<8,colormap_length:d[m++]|d[m++]<<8,colormap_size:d[m++],origin:[d[m++]|d[m++]<<8,d[m++]|d[m++]<<8],width:d[m++]|d[m++]<<8,height:d[m++]|d[m++]<<8,pixel_size:d[m++],flags:d[m++]};!function(e){switch(e.image_type){case r:case a:(e.colormap_length>256||24!==e.colormap_size||1!==e.colormap_type)&&console.error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case n:case i:case o:case s:e.colormap_type&&console.error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case t:console.error("THREE.TGALoader: No data.");default:console.error('THREE.TGALoader: Invalid type "%s".',e.image_type)}(e.width<=0||e.height<=0)&&console.error("THREE.TGALoader: Invalid image size."),8!==e.pixel_size&&16!==e.pixel_size&&24!==e.pixel_size&&32!==e.pixel_size&&console.error('THREE.TGALoader: Invalid pixel size "%s".',e.pixel_size)}(v),v.id_length+m>e.length&&console.error("THREE.TGALoader: No data."),m+=v.id_length;var g=!1,y=!1,T=!1;switch(v.image_type){case a:g=!0,y=!0;break;case r:y=!0;break;case o:g=!0;break;case n:break;case s:g=!0,T=!0;break;case i:T=!0}var E="undefined"!==typeof OffscreenCanvas?new OffscreenCanvas(v.width,v.height):document.createElement("canvas");E.width=v.width,E.height=v.height;var A=E.getContext("2d"),x=A.createImageData(v.width,v.height),b=function(e,t,r,n,i){var a,o,s,u;if(o=r.pixel_size>>3,s=r.width*r.height*o,t&&(u=i.subarray(n,n+=r.colormap_length*(r.colormap_size>>3))),e){var c,l,p;a=new Uint8Array(s);for(var h=0,f=new Uint8Array(o);h<s;)if(l=1+(127&(c=i[n++])),128&c){for(p=0;p<o;++p)f[p]=i[n++];for(p=0;p<l;++p)a.set(f,h+p*o);h+=o*l}else{for(l*=o,p=0;p<l;++p)a[h+p]=i[n++];h+=l}}else a=i.subarray(n,n+=t?r.width*r.height:s);return{pixel_data:a,palettes:u}}(g,y,v,m,d);return function(e,t,r,n,i){var a,o,s,d,m,g;switch((v.flags&u)>>c){default:case h:a=0,s=1,m=t,o=0,d=1,g=r;break;case l:a=0,s=1,m=t,o=r-1,d=-1,g=-1;break;case f:a=t-1,s=-1,m=-1,o=0,d=1,g=r;break;case p:a=t-1,s=-1,m=-1,o=r-1,d=-1,g=-1}if(T)switch(v.pixel_size){case 8:!function(e,t,r,n,i,a,o,s){var u,c,l,p=0,h=v.width;for(l=t;l!==n;l+=r)for(c=i;c!==o;c+=a,p++)u=s[p],e[4*(c+h*l)+0]=u,e[4*(c+h*l)+1]=u,e[4*(c+h*l)+2]=u,e[4*(c+h*l)+3]=255}(e,o,d,g,a,s,m,n);break;case 16:!function(e,t,r,n,i,a,o,s){var u,c,l=0,p=v.width;for(c=t;c!==n;c+=r)for(u=i;u!==o;u+=a,l+=2)e[4*(u+p*c)+0]=s[l+0],e[4*(u+p*c)+1]=s[l+0],e[4*(u+p*c)+2]=s[l+0],e[4*(u+p*c)+3]=s[l+1]}(e,o,d,g,a,s,m,n);break;default:console.error("THREE.TGALoader: Format not supported.")}else switch(v.pixel_size){case 8:!function(e,t,r,n,i,a,o,s,u){var c,l,p,h=u,f=0,d=v.width;for(p=t;p!==n;p+=r)for(l=i;l!==o;l+=a,f++)c=s[f],e[4*(l+d*p)+3]=255,e[4*(l+d*p)+2]=h[3*c+0],e[4*(l+d*p)+1]=h[3*c+1],e[4*(l+d*p)+0]=h[3*c+2]}(e,o,d,g,a,s,m,n,i);break;case 16:!function(e,t,r,n,i,a,o,s){var u,c,l,p=0,h=v.width;for(l=t;l!==n;l+=r)for(c=i;c!==o;c+=a,p+=2)u=s[p+0]+(s[p+1]<<8),e[4*(c+h*l)+0]=(31744&u)>>7,e[4*(c+h*l)+1]=(992&u)>>2,e[4*(c+h*l)+2]=(31&u)>>3,e[4*(c+h*l)+3]=32768&u?0:255}(e,o,d,g,a,s,m,n);break;case 24:!function(e,t,r,n,i,a,o,s){var u,c,l=0,p=v.width;for(c=t;c!==n;c+=r)for(u=i;u!==o;u+=a,l+=3)e[4*(u+p*c)+3]=255,e[4*(u+p*c)+2]=s[l+0],e[4*(u+p*c)+1]=s[l+1],e[4*(u+p*c)+0]=s[l+2]}(e,o,d,g,a,s,m,n);break;case 32:!function(e,t,r,n,i,a,o,s){var u,c,l=0,p=v.width;for(c=t;c!==n;c+=r)for(u=i;u!==o;u+=a,l+=4)e[4*(u+p*c)+2]=s[l+0],e[4*(u+p*c)+1]=s[l+1],e[4*(u+p*c)+0]=s[l+2],e[4*(u+p*c)+3]=s[l+3]}(e,o,d,g,a,s,m,n);break;default:console.error("THREE.TGALoader: Format not supported.")}}(x.data,v.width,v.height,b.pixel_data,b.palettes),A.putImageData(x,0,0),E}});var a=function(e){n.Loader.call(this,e)};a.prototype=Object.assign(Object.create(n.Loader.prototype),{constructor:a,load:function(e,t,r,i){var a=this,o=""===a.path?n.LoaderUtils.extractUrlBase(e):a.path,s=new n.FileLoader(a.manager);s.setPath(a.path),s.setRequestHeader(a.requestHeader),s.setWithCredentials(a.withCredentials),s.load(e,(function(r){try{t(a.parse(r,o))}catch(n){i?i(n):console.error(n),a.manager.itemError(e)}}),r,i)},options:{set convertUpAxis(e){console.warn("THREE.ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.")}},parse:function(e,t){function r(e,t){for(var r=[],n=e.childNodes,i=0,a=n.length;i<a;i++){var o=n[i];o.nodeName===t&&r.push(o)}return r}function a(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=new Array(t.length),n=0,i=t.length;n<i;n++)r[n]=t[n];return r}function o(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=new Array(t.length),n=0,i=t.length;n<i;n++)r[n]=parseFloat(t[n]);return r}function s(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=new Array(t.length),n=0,i=t.length;n<i;n++)r[n]=parseInt(t[n]);return r}function u(e){return e.substring(1)}function c(e){return 0===Object.keys(e).length}function l(e){return void 0!==e&&!0===e.hasAttribute("meter")?parseFloat(e.getAttribute("meter")):1}function p(e){return void 0!==e?e.textContent:"Y_UP"}function h(e,t,n,i){var a=r(e,t)[0];if(void 0!==a)for(var o=r(a,n),s=0;s<o.length;s++)i(o[s])}function f(e,t){for(var r in e){e[r].build=t(e[r])}}function d(e,t){return void 0!==e.build||(e.build=t(e)),e.build}function m(e){for(var t={inputs:{}},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"input":var a=u(i.getAttribute("source")),o=i.getAttribute("semantic");t.inputs[o]=a}}return t}function v(e){var t={},r=e.getAttribute("target").split("/"),n=r.shift(),i=r.shift(),a=-1!==i.indexOf("("),o=-1!==i.indexOf(".");if(o)r=i.split("."),i=r.shift(),t.member=r.shift();else if(a){var s=i.split("(");i=s.shift();for(var c=0;c<s.length;c++)s[c]=parseInt(s[c].replace(/\)/,""));t.indices=s}return t.id=n,t.sid=i,t.arraySyntax=a,t.memberSyntax=o,t.sampler=u(e.getAttribute("source")),t}function g(e){var t=[],r=e.channels,n=e.samplers,i=e.sources;for(var a in r)if(r.hasOwnProperty(a)){var o=r[a],s=n[o.sampler],u=s.inputs.INPUT,c=s.inputs.OUTPUT;b(T(o,i[u],i[c]),t)}return t}function y(e){return d(Je.animations[e],g)}function T(e,t,r){var n,i,a,o,s,u,c=Je.nodes[e.id],l=Ue(c.id),p=c.transforms[e.sid],h=c.matrix.clone().transpose(),f={};switch(p){case"matrix":for(a=0,o=t.array.length;a<o;a++)if(n=t.array[a],i=a*r.stride,void 0===f[n]&&(f[n]={}),!0===e.arraySyntax){var d=r.array[i],m=e.indices[0]+4*e.indices[1];f[n][m]=d}else for(s=0,u=r.stride;s<u;s++)f[n][s]=r.array[i+s];break;case"translate":case"rotate":case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',p)}var v=function(e,t){var r=[];for(var n in e)r.push({time:parseFloat(n),value:e[n]});r.sort(a);for(var i=0;i<16;i++)R(r,i,t.elements[i]);return r;function a(e,t){return e.time-t.time}}(f,h);return{name:l.uuid,keyframes:v}}var E=new n.Vector3,A=new n.Vector3,x=new n.Quaternion;function b(e,t){for(var r=e.keyframes,i=e.name,a=[],o=[],s=[],u=[],c=0,l=r.length;c<l;c++){var p=r[c],h=p.time,f=p.value;Ne.fromArray(f).transpose(),Ne.decompose(E,x,A),a.push(h),o.push(E.x,E.y,E.z),s.push(x.x,x.y,x.z,x.w),u.push(A.x,A.y,A.z)}return o.length>0&&t.push(new n.VectorKeyframeTrack(i+".position",a,o)),s.length>0&&t.push(new n.QuaternionKeyframeTrack(i+".quaternion",a,s)),u.length>0&&t.push(new n.VectorKeyframeTrack(i+".scale",a,u)),t}function R(e,t,r){var n,i,a,o=!0;for(i=0,a=e.length;i<a;i++)void 0===(n=e[i]).value[t]?n.value[t]=null:o=!1;if(!0===o)for(i=0,a=e.length;i<a;i++)(n=e[i]).value[t]=r;else!function(e,t){for(var r,n,i=0,a=e.length;i<a;i++){var o=e[i];if(null===o.value[t]){if(r=w(e,i,t),n=N(e,i,t),null===r){o.value[t]=n.value[t];continue}if(null===n){o.value[t]=r.value[t];continue}S(o,r,n,t)}}}(e,t)}function w(e,t,r){for(;t>=0;){var n=e[t];if(null!==n.value[r])return n;t--}return null}function N(e,t,r){for(;t<e.length;){var n=e[t];if(null!==n.value[r])return n;t++}return null}function S(e,t,r,n){r.time-t.time!==0?e.value[n]=(e.time-t.time)*(r.value[n]-t.value[n])/(r.time-t.time)+t.value[n]:e.value[n]=t.value[n]}function k(e){for(var t=[],r=e.name,i=e.end-e.start||-1,a=e.animations,o=0,s=a.length;o<s;o++)for(var u=y(a[o]),c=0,l=u.length;c<l;c++)t.push(u[c]);return new n.AnimationClip(r,i,t)}function _(e){return d(Je.clips[e],k)}function L(e){for(var t={sources:{}},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"bind_shape_matrix":t.bindShapeMatrix=o(i.textContent);break;case"source":var a=i.getAttribute("id");t.sources[a]=oe(i);break;case"joints":t.joints=I(i);break;case"vertex_weights":t.vertexWeights=O(i)}}return t}function I(e){for(var t={inputs:{}},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"input":var a=i.getAttribute("semantic"),o=u(i.getAttribute("source"));t.inputs[a]=o}}return t}function O(e){for(var t={inputs:{}},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"input":var a=i.getAttribute("semantic"),o=u(i.getAttribute("source")),c=parseInt(i.getAttribute("offset"));t.inputs[a]={id:o,offset:c};break;case"vcount":t.vcount=s(i.textContent);break;case"v":t.v=s(i.textContent)}}return t}function M(e){var t={id:e.id},r=Je.geometries[t.id];return void 0!==e.skin&&(t.skin=function(e){var t,r,i,a=4,o={joints:[],indices:{array:[],stride:a},weights:{array:[],stride:a}},s=e.sources,u=e.vertexWeights,c=u.vcount,l=u.v,p=u.inputs.JOINT.offset,h=u.inputs.WEIGHT.offset,f=e.sources[e.joints.inputs.JOINT],d=e.sources[e.joints.inputs.INV_BIND_MATRIX],m=s[u.inputs.WEIGHT.id].array,v=0;for(t=0,i=c.length;t<i;t++){var g=c[t],y=[];for(r=0;r<g;r++){var T=l[v+p],E=m[l[v+h]];y.push({index:T,weight:E}),v+=2}for(y.sort(R),r=0;r<a;r++){var A=y[r];void 0!==A?(o.indices.array.push(A.index),o.weights.array.push(A.weight)):(o.indices.array.push(0),o.weights.array.push(0))}}e.bindShapeMatrix?o.bindMatrix=(new n.Matrix4).fromArray(e.bindShapeMatrix).transpose():o.bindMatrix=(new n.Matrix4).identity();for(t=0,i=f.array.length;t<i;t++){var x=f.array[t],b=(new n.Matrix4).fromArray(d.array,t*d.stride).transpose();o.joints.push({name:x,boneInverse:b})}return o;function R(e,t){return t.weight-e.weight}}(e.skin),r.sources.skinIndices=t.skin.indices,r.sources.skinWeights=t.skin.weights),t}function C(e){return void 0!==e.build?e.build:e.init_from}function P(e){var t=Je.images[e];return void 0!==t?d(t,C):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",e),null)}function F(e){for(var t={surfaces:{},samplers:{}},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"newparam":U(i,t);break;case"technique":t.technique=V(i);break;case"extra":t.extra=K(i)}}return t}function U(e,t){for(var r=e.getAttribute("sid"),n=0,i=e.childNodes.length;n<i;n++){var a=e.childNodes[n];if(1===a.nodeType)switch(a.nodeName){case"surface":t.surfaces[r]=D(a);break;case"sampler2D":t.samplers[r]=B(a)}}}function D(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"init_from":t.init_from=i.textContent}}return t}function B(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"source":t.source=i.textContent}}return t}function V(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"constant":case"lambert":case"blinn":case"phong":t.type=i.nodeName,t.parameters=j(i)}}return t}function j(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":t[i.nodeName]=G(i);break;case"transparent":t[i.nodeName]={opaque:i.getAttribute("opaque"),data:G(i)}}}return t}function G(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"color":t[i.nodeName]=o(i.textContent);break;case"float":t[i.nodeName]=parseFloat(i.textContent);break;case"texture":t[i.nodeName]={id:i.getAttribute("texture"),extra:H(i)}}}return t}function H(e){for(var t={technique:{}},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"extra":z(i,t)}}return t}function z(e,t){for(var r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"technique":W(i,t)}}}function W(e,t){for(var r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":t.technique[i.nodeName]=parseFloat(i.textContent);break;case"wrapU":case"wrapV":"TRUE"===i.textContent.toUpperCase()?t.technique[i.nodeName]=1:"FALSE"===i.textContent.toUpperCase()?t.technique[i.nodeName]=0:t.technique[i.nodeName]=parseInt(i.textContent)}}}function K(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"technique":t.technique=X(i)}}return t}function X(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"double_sided":t[i.nodeName]=parseInt(i.textContent)}}return t}function Y(e){return e}function q(e){var t,r,i=(t=e.url,d(Je.effects[t],Y)),a=i.profile.technique,o=i.profile.extra;switch(a.type){case"phong":case"blinn":r=new n.MeshPhongMaterial;break;case"lambert":r=new n.MeshLambertMaterial;break;default:r=new n.MeshBasicMaterial}function s(e){var t=i.profile.samplers[e.id],r=null;void 0!==t?r=P(i.profile.surfaces[t.source].init_from):(console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),r=P(e.id));if(null!==r){var a=function(e){var t,r=e.slice(2+(e.lastIndexOf(".")-1>>>0));switch(r=r.toLowerCase()){case"tga":t=Ke;break;default:t=Ye}return t}(r);if(void 0!==a){var o=a.load(r),s=e.extra;if(void 0!==s&&void 0!==s.technique&&!1===c(s.technique)){var u=s.technique;o.wrapS=u.wrapU?n.RepeatWrapping:n.ClampToEdgeWrapping,o.wrapT=u.wrapV?n.RepeatWrapping:n.ClampToEdgeWrapping,o.offset.set(u.offsetU||0,u.offsetV||0),o.repeat.set(u.repeatU||1,u.repeatV||1)}else o.wrapS=n.RepeatWrapping,o.wrapT=n.RepeatWrapping;return o}return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",r),null}return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",e.id),null}r.name=e.name||"";var u=a.parameters;for(var l in u){var p=u[l];switch(l){case"diffuse":p.color&&r.color.fromArray(p.color),p.texture&&(r.map=s(p.texture));break;case"specular":p.color&&r.specular&&r.specular.fromArray(p.color),p.texture&&(r.specularMap=s(p.texture));break;case"bump":p.texture&&(r.normalMap=s(p.texture));break;case"ambient":p.texture&&(r.lightMap=s(p.texture));break;case"shininess":p.float&&r.shininess&&(r.shininess=p.float);break;case"emission":p.color&&r.emissive&&r.emissive.fromArray(p.color),p.texture&&(r.emissiveMap=s(p.texture))}}var h=u.transparent,f=u.transparency;if(void 0===f&&h&&(f={float:1}),void 0===h&&f&&(h={opaque:"A_ONE",data:{color:[1,1,1,1]}}),h&&f)if(h.data.texture)r.transparent=!0;else{var m=h.data.color;switch(h.opaque){case"A_ONE":r.opacity=m[3]*f.float;break;case"RGB_ZERO":r.opacity=1-m[0]*f.float;break;case"A_ZERO":r.opacity=1-m[3]*f.float;break;case"RGB_ONE":r.opacity=m[0]*f.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',h.opaque)}r.opacity<1&&(r.transparent=!0)}return void 0!==o&&void 0!==o.technique&&1===o.technique.double_sided&&(r.side=n.DoubleSide),r}function Z(e){return d(Je.materials[e],q)}function $(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];switch(r.nodeName){case"technique_common":return J(r)}}return{}}function J(e){for(var t={},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];switch(n.nodeName){case"perspective":case"orthographic":t.technique=n.nodeName,t.parameters=Q(n)}}return t}function Q(e){for(var t={},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];switch(n.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":t[n.nodeName]=parseFloat(n.textContent)}}return t}function ee(e){var t;switch(e.optics.technique){case"perspective":t=new n.PerspectiveCamera(e.optics.parameters.yfov,e.optics.parameters.aspect_ratio,e.optics.parameters.znear,e.optics.parameters.zfar);break;case"orthographic":var r=e.optics.parameters.ymag,i=e.optics.parameters.xmag,a=e.optics.parameters.aspect_ratio;i=void 0===i?r*a:i,r=void 0===r?i/a:r,i*=.5,r*=.5,t=new n.OrthographicCamera(-i,i,r,-r,e.optics.parameters.znear,e.optics.parameters.zfar);break;default:t=new n.PerspectiveCamera}return t.name=e.name||"",t}function te(e){var t=Je.cameras[e];return void 0!==t?d(t,ee):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",e),null)}function re(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"directional":case"point":case"spot":case"ambient":t.technique=i.nodeName,t.parameters=ne(i)}}return t}function ne(e){for(var t={},r=0,i=e.childNodes.length;r<i;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"color":var s=o(a.textContent);t.color=(new n.Color).fromArray(s);break;case"falloff_angle":t.falloffAngle=parseFloat(a.textContent);break;case"quadratic_attenuation":var u=parseFloat(a.textContent);t.distance=u?Math.sqrt(1/u):0}}return t}function ie(e){var t;switch(e.technique){case"directional":t=new n.DirectionalLight;break;case"point":t=new n.PointLight;break;case"spot":t=new n.SpotLight;break;case"ambient":t=new n.AmbientLight}return e.parameters.color&&t.color.copy(e.parameters.color),e.parameters.distance&&(t.distance=e.parameters.distance),t}function ae(e){var t=Je.lights[e];return void 0!==t?d(t,ie):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",e),null)}function oe(e){for(var t={array:[],stride:3},n=0;n<e.childNodes.length;n++){var i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"float_array":t.array=o(i.textContent);break;case"Name_array":t.array=a(i.textContent);break;case"technique_common":var s=r(i,"accessor")[0];void 0!==s&&(t.stride=parseInt(s.getAttribute("stride")))}}return t}function se(e){for(var t={},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];1===n.nodeType&&(t[n.getAttribute("semantic")]=u(n.getAttribute("source")))}return t}function ue(e){for(var t={type:e.nodeName,material:e.getAttribute("material"),count:parseInt(e.getAttribute("count")),inputs:{},stride:0,hasUV:!1},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"input":var a=u(i.getAttribute("source")),o=i.getAttribute("semantic"),c=parseInt(i.getAttribute("offset")),l=parseInt(i.getAttribute("set")),p=l>0?o+l:o;t.inputs[p]={id:a,offset:c},t.stride=Math.max(t.stride,c+1),"TEXCOORD"===o&&(t.hasUV=!0);break;case"vcount":t.vcount=s(i.textContent);break;case"p":t.p=s(i.textContent)}}return t}function ce(e){for(var t=0,r=0,n=e.length;r<n;r++){!0===e[r].hasUV&&t++}t>0&&t<e.length&&(e.uvsNeedsFix=!0)}function le(e){var t={},r=e.sources,n=e.vertices,i=e.primitives;if(0===i.length)return{};var a=function(e){for(var t={},r=0;r<e.length;r++){var n=e[r];void 0===t[n.type]&&(t[n.type]=[]),t[n.type].push(n)}return t}(i);for(var o in a){var s=a[o];ce(s),t[o]=pe(s,r,n)}return t}function pe(e,t,r){for(var i={},a={array:[],stride:0},o={array:[],stride:0},s={array:[],stride:0},u={array:[],stride:0},c={array:[],stride:0},l=[],p=4,h=[],f=4,d=new n.BufferGeometry,m=[],v=0,g=0;g<e.length;g++){var y=e[g],T=y.inputs,E=0;switch(y.type){case"lines":case"linestrips":E=2*y.count;break;case"triangles":E=3*y.count;break;case"polylist":for(var A=0;A<y.count;A++){var x=y.vcount[A];switch(x){case 3:E+=3;break;case 4:E+=6;break;default:E+=3*(x-2)}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",y.type)}for(var b in d.addGroup(v,E,g),v+=E,y.material&&m.push(y.material),T){var R=T[b];switch(b){case"VERTEX":for(var w in r){var N=r[w];switch(w){case"POSITION":var S=a.array.length;if(he(y,t[N],R.offset,a.array),a.stride=t[N].stride,t.skinWeights&&t.skinIndices&&(he(y,t.skinIndices,R.offset,l),he(y,t.skinWeights,R.offset,h)),!1===y.hasUV&&!0===e.uvsNeedsFix){E=(a.array.length-S)/a.stride;for(var k=0;k<E;k++)s.array.push(0,0)}break;case"NORMAL":he(y,t[N],R.offset,o.array),o.stride=t[N].stride;break;case"COLOR":he(y,t[N],R.offset,c.array),c.stride=t[N].stride;break;case"TEXCOORD":he(y,t[N],R.offset,s.array),s.stride=t[N].stride;break;case"TEXCOORD1":he(y,t[N],R.offset,u.array),s.stride=t[N].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',w)}}break;case"NORMAL":he(y,t[R.id],R.offset,o.array),o.stride=t[R.id].stride;break;case"COLOR":he(y,t[R.id],R.offset,c.array),c.stride=t[R.id].stride;break;case"TEXCOORD":he(y,t[R.id],R.offset,s.array),s.stride=t[R.id].stride;break;case"TEXCOORD1":he(y,t[R.id],R.offset,u.array),u.stride=t[R.id].stride}}}return a.array.length>0&&d.setAttribute("position",new n.Float32BufferAttribute(a.array,a.stride)),o.array.length>0&&d.setAttribute("normal",new n.Float32BufferAttribute(o.array,o.stride)),c.array.length>0&&d.setAttribute("color",new n.Float32BufferAttribute(c.array,c.stride)),s.array.length>0&&d.setAttribute("uv",new n.Float32BufferAttribute(s.array,s.stride)),u.array.length>0&&d.setAttribute("uv2",new n.Float32BufferAttribute(u.array,u.stride)),l.length>0&&d.setAttribute("skinIndex",new n.Float32BufferAttribute(l,p)),h.length>0&&d.setAttribute("skinWeight",new n.Float32BufferAttribute(h,f)),i.data=d,i.type=e[0].type,i.materialKeys=m,i}function he(e,t,r,n){var i=e.p,a=e.stride,o=e.vcount;function s(e){for(var t=i[e+r]*c,a=t+c;t<a;t++)n.push(u[t])}var u=t.array,c=t.stride;if(void 0!==e.vcount)for(var l=0,p=0,h=o.length;p<h;p++){var f=o[p];if(4===f){var d=l+1*a,m=l+2*a,v=l+3*a;s(l+0*a),s(d),s(v),s(d),s(m),s(v)}else if(3===f){d=l+1*a,m=l+2*a;s(l+0*a),s(d),s(m)}else if(f>4)for(var g=1,y=f-2;g<=y;g++){d=l+a*g,m=l+a*(g+1);s(l+0*a),s(d),s(m)}l+=a*f}else for(p=0,h=i.length;p<h;p+=a)s(p)}function fe(e){return d(Je.geometries[e],le)}function de(e){return void 0!==e.build?e.build:e}function me(e,t){for(var r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"joint":t.joints[n.getAttribute("sid")]=ve(n);break;case"link":t.links.push(ye(n))}}}function ve(e){for(var t,r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"prismatic":case"revolute":t=ge(n)}}return t}function ge(e,t){t={sid:e.getAttribute("sid"),name:e.getAttribute("name")||"",axis:new n.Vector3,limits:{min:0,max:0},type:e.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"axis":var a=o(i.textContent);t.axis.fromArray(a);break;case"limits":var s=i.getElementsByTagName("max")[0],u=i.getElementsByTagName("min")[0];t.limits.max=parseFloat(s.textContent),t.limits.min=parseFloat(u.textContent)}}return t.limits.min>=t.limits.max&&(t.static=!0),t.middlePosition=(t.limits.min+t.limits.max)/2,t}function ye(e){for(var t={sid:e.getAttribute("sid"),name:e.getAttribute("name")||"",attachments:[],transforms:[]},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"attachment_full":t.attachments.push(Te(n));break;case"matrix":case"translate":case"rotate":t.transforms.push(Ee(n))}}return t}function Te(e){for(var t={joint:e.getAttribute("joint").split("/").pop(),transforms:[],links:[]},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"link":t.links.push(ye(n));break;case"matrix":case"translate":case"rotate":t.transforms.push(Ee(n))}}return t}function Ee(e){var t={type:e.nodeName},r=o(e.textContent);switch(t.type){case"matrix":t.obj=new n.Matrix4,t.obj.fromArray(r).transpose();break;case"translate":t.obj=new n.Vector3,t.obj.fromArray(r);break;case"rotate":t.obj=new n.Vector3,t.obj.fromArray(r),t.angle=n.MathUtils.degToRad(r[3])}return t}function Ae(e,t){for(var r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"technique_common":xe(n,t)}}}function xe(e,t){for(var r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"inertia":t.inertia=o(n.textContent);break;case"mass":t.mass=o(n.textContent)[0]}}}function be(e){for(var t={target:e.getAttribute("target").split("/").pop()},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"axis":var i=n.getElementsByTagName("param")[0];t.axis=i.textContent;var a=t.axis.split("inst_").pop().split("axis")[0];t.jointIndex=a.substr(0,a.length-1)}}return t}function Re(e){return void 0!==e.build?e.build:e}function we(e){for(var t=[],r=je.querySelector('[id="'+e.id+'"]'),i=0;i<r.childNodes.length;i++){var a=r.childNodes[i];if(1===a.nodeType)switch(a.nodeName){case"matrix":var s=o(a.textContent),u=(new n.Matrix4).fromArray(s).transpose();t.push({sid:a.getAttribute("sid"),type:a.nodeName,obj:u});break;case"translate":case"scale":s=o(a.textContent);var c=(new n.Vector3).fromArray(s);t.push({sid:a.getAttribute("sid"),type:a.nodeName,obj:c});break;case"rotate":s=o(a.textContent),c=(new n.Vector3).fromArray(s);var l=n.MathUtils.degToRad(s[3]);t.push({sid:a.getAttribute("sid"),type:a.nodeName,obj:c,angle:l})}}return t}var Ne=new n.Matrix4,Se=new n.Vector3;function ke(e){for(var t={name:e.getAttribute("name")||"",type:e.getAttribute("type"),id:e.getAttribute("id"),sid:e.getAttribute("sid"),matrix:new n.Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}},r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"node":t.nodes.push(i.getAttribute("id")),ke(i);break;case"instance_camera":t.instanceCameras.push(u(i.getAttribute("url")));break;case"instance_controller":t.instanceControllers.push(_e(i));break;case"instance_light":t.instanceLights.push(u(i.getAttribute("url")));break;case"instance_geometry":t.instanceGeometries.push(_e(i));break;case"instance_node":t.instanceNodes.push(u(i.getAttribute("url")));break;case"matrix":var a=o(i.textContent);t.matrix.multiply(Ne.fromArray(a).transpose()),t.transforms[i.getAttribute("sid")]=i.nodeName;break;case"translate":a=o(i.textContent);Se.fromArray(a),t.matrix.multiply(Ne.makeTranslation(Se.x,Se.y,Se.z)),t.transforms[i.getAttribute("sid")]=i.nodeName;break;case"rotate":a=o(i.textContent);var s=n.MathUtils.degToRad(a[3]);t.matrix.multiply(Ne.makeRotationAxis(Se.fromArray(a),s)),t.transforms[i.getAttribute("sid")]=i.nodeName;break;case"scale":a=o(i.textContent);t.matrix.scale(Se.fromArray(a)),t.transforms[i.getAttribute("sid")]=i.nodeName;break;case"extra":break;default:console.log(i)}}return Fe(t.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",t.id):Je.nodes[t.id]=t,t}function _e(e){for(var t={id:u(e.getAttribute("url")),materials:{},skeletons:[]},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];switch(n.nodeName){case"bind_material":for(var i=n.getElementsByTagName("instance_material"),a=0;a<i.length;a++){var o=i[a],s=o.getAttribute("symbol"),c=o.getAttribute("target");t.materials[s]=u(c)}break;case"skeleton":t.skeletons.push(u(n.textContent))}}return t}function Le(e,t){var r,i,a,o=[],s=[];for(r=0;r<e.length;r++){var u=e[r];if(Fe(u))Ie(Ue(u),t,o);else if(a=u,void 0!==Je.visualScenes[a])for(var c=Je.visualScenes[u].children,l=0;l<c.length;l++){var p=c[l];if("JOINT"===p.type)Ie(Ue(p.id),t,o)}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",u)}for(r=0;r<t.length;r++)for(l=0;l<o.length;l++)if((i=o[l]).bone.name===t[r].name){s[r]=i,i.processed=!0;break}for(r=0;r<o.length;r++)!1===(i=o[r]).processed&&(s.push(i),i.processed=!0);var h=[],f=[];for(r=0;r<s.length;r++)i=s[r],h.push(i.bone),f.push(i.boneInverse);return new n.Skeleton(h,f)}function Ie(e,t,r){e.traverse((function(e){if(!0===e.isBone){for(var i,a=0;a<t.length;a++){var o=t[a];if(o.name===e.name){i=o.boneInverse;break}}void 0===i&&(i=new n.Matrix4),r.push({bone:e,boneInverse:i,processed:!1})}}))}function Oe(e){for(var t,r=[],i=e.matrix,a=e.nodes,o=e.type,s=e.instanceCameras,u=e.instanceControllers,c=e.instanceLights,l=e.instanceGeometries,p=e.instanceNodes,h=0,f=a.length;h<f;h++)r.push(Ue(a[h]));for(h=0,f=s.length;h<f;h++){var m=te(s[h]);null!==m&&r.push(m.clone())}for(h=0,f=u.length;h<f;h++)for(var v=u[h],g=(t=v.id,d(Je.controllers[t],M)),y=Pe(fe(g.id),v.materials),T=Le(v.skeletons,g.skin.joints),E=0,A=y.length;E<A;E++){var x;(x=y[E]).isSkinnedMesh&&(x.bind(T,g.skin.bindMatrix),x.normalizeSkinWeights()),r.push(x)}for(h=0,f=c.length;h<f;h++){var b=ae(c[h]);null!==b&&r.push(b.clone())}for(h=0,f=l.length;h<f;h++)for(E=0,A=(y=Pe(fe((v=l[h]).id),v.materials)).length;E<A;E++)r.push(y[E]);for(h=0,f=p.length;h<f;h++)r.push(Ue(p[h]).clone());if(0===a.length&&1===r.length)x=r[0];else{x="JOINT"===o?new n.Bone:new n.Group;for(h=0;h<r.length;h++)x.add(r[h])}return x.name="JOINT"===o?e.sid:e.name,x.matrix.copy(i),x.matrix.decompose(x.position,x.quaternion,x.scale),x}var Me=new n.MeshBasicMaterial({color:16711935});function Ce(e,t){for(var r=[],n=0,i=e.length;n<i;n++){var a=t[e[n]];void 0===a?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",e[n]),r.push(Me)):r.push(Z(a))}return r}function Pe(e,t){var r=[];for(var i in e){var a=e[i],o=Ce(a.materialKeys,t);0===o.length&&("lines"===i||"linestrips"===i?o.push(new n.LineBasicMaterial):o.push(new n.MeshPhongMaterial));var s=void 0!==a.data.attributes.skinIndex;if(s)for(var u=0,c=o.length;u<c;u++)o[u].skinning=!0;var l,p=1===o.length?o[0]:o;switch(i){case"lines":l=new n.LineSegments(a.data,p);break;case"linestrips":l=new n.Line(a.data,p);break;case"triangles":case"polylist":l=s?new n.SkinnedMesh(a.data,p):new n.Mesh(a.data,p)}r.push(l)}return r}function Fe(e){return void 0!==Je.nodes[e]}function Ue(e){return d(Je.nodes[e],Oe)}function De(e){var t=new n.Group;t.name=e.name;for(var r=e.children,i=0;i<r.length;i++){var a=r[i];t.add(Ue(a.id))}return t}function Be(e){return d(Je.visualScenes[e],De)}if(0===e.length)return{scene:new n.Scene};var Ve=(new DOMParser).parseFromString(e,"application/xml"),je=r(Ve,"COLLADA")[0],Ge=Ve.getElementsByTagName("parsererror")[0];if(void 0!==Ge){var He,ze=r(Ge,"div")[0];return He=ze?ze.textContent:function(e){for(var t="",r=[e];r.length;){var n=r.shift();n.nodeType===Node.TEXT_NODE?t+=n.textContent:(t+="\n",r.push.apply(r,n.childNodes))}return t.trim()}(Ge),console.error("THREE.ColladaLoader: Failed to parse collada file.\n",He),null}var We=je.getAttribute("version");console.log("THREE.ColladaLoader: File version",We);var Ke,Xe=function(e){return{unit:l(r(e,"unit")[0]),upAxis:p(r(e,"up_axis")[0])}}(r(je,"asset")[0]),Ye=new n.TextureLoader(this.manager);Ye.setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin),i&&(Ke=new i(this.manager)).setPath(this.resourcePath||t);var qe=[],Ze={},$e=0,Je={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};h(je,"library_animations","animation",(function e(t){for(var r={sources:{},samplers:{},channels:{}},i=!1,a=0,o=t.childNodes.length;a<o;a++){var s,u=t.childNodes[a];if(1===u.nodeType)switch(u.nodeName){case"source":s=u.getAttribute("id"),r.sources[s]=oe(u);break;case"sampler":s=u.getAttribute("id"),r.samplers[s]=m(u);break;case"channel":s=u.getAttribute("target"),r.channels[s]=v(u);break;case"animation":e(u),i=!0;break;default:console.log(u)}}!1===i&&(Je.animations[t.getAttribute("id")||n.MathUtils.generateUUID()]=r)})),h(je,"library_animation_clips","animation_clip",(function(e){for(var t={name:e.getAttribute("id")||"default",start:parseFloat(e.getAttribute("start")||0),end:parseFloat(e.getAttribute("end")||0),animations:[]},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"instance_animation":t.animations.push(u(i.getAttribute("url")))}}Je.clips[e.getAttribute("id")]=t})),h(je,"library_controllers","controller",(function(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"skin":t.id=u(i.getAttribute("source")),t.skin=L(i);break;case"morph":t.id=u(i.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.")}}Je.controllers[e.getAttribute("id")]=t})),h(je,"library_images","image",(function(e){var t={init_from:r(e,"init_from")[0].textContent};Je.images[e.getAttribute("id")]=t})),h(je,"library_effects","effect",(function(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"profile_COMMON":t.profile=F(i)}}Je.effects[e.getAttribute("id")]=t})),h(je,"library_materials","material",(function(e){for(var t={name:e.getAttribute("name")},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"instance_effect":t.url=u(i.getAttribute("url"))}}Je.materials[e.getAttribute("id")]=t})),h(je,"library_cameras","camera",(function(e){for(var t={name:e.getAttribute("name")},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"optics":t.optics=$(i)}}Je.cameras[e.getAttribute("id")]=t})),h(je,"library_lights","light",(function(e){for(var t={},r=0,n=e.childNodes.length;r<n;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"technique_common":t=re(i)}}Je.lights[e.getAttribute("id")]=t})),h(je,"library_geometries","geometry",(function(e){var t={name:e.getAttribute("name"),sources:{},vertices:{},primitives:[]},n=r(e,"mesh")[0];if(void 0!==n){for(var i=0;i<n.childNodes.length;i++){var a=n.childNodes[i];if(1===a.nodeType){var o=a.getAttribute("id");switch(a.nodeName){case"source":t.sources[o]=oe(a);break;case"vertices":t.vertices=se(a);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",a.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":t.primitives.push(ue(a));break;default:console.log(a)}}}Je.geometries[e.getAttribute("id")]=t}})),h(je,"library_nodes","node",ke),h(je,"library_visual_scenes","visual_scene",(function(e){var t={name:e.getAttribute("name"),children:[]};!function(e){for(var t=e.getElementsByTagName("node"),r=0;r<t.length;r++){var n=t[r];!1===n.hasAttribute("id")&&n.setAttribute("id","three_default_"+$e++)}}(e);for(var n=r(e,"node"),i=0;i<n.length;i++)t.children.push(ke(n[i]));Je.visualScenes[e.getAttribute("id")]=t})),h(je,"library_kinematics_models","kinematics_model",(function(e){for(var t={name:e.getAttribute("name")||"",joints:{},links:[]},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"technique_common":me(n,t)}}Je.kinematicsModels[e.getAttribute("id")]=t})),h(je,"library_physics_models","physics_model",(function(e){for(var t={name:e.getAttribute("name")||"",rigidBodies:{}},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"rigid_body":t.rigidBodies[n.getAttribute("name")]={},Ae(n,t.rigidBodies[n.getAttribute("name")])}}Je.physicsModels[e.getAttribute("id")]=t})),h(je,"scene","instance_kinematics_scene",(function(e){for(var t={bindJointAxis:[]},r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"bind_joint_axis":t.bindJointAxis.push(be(n))}}Je.kinematicsScenes[u(e.getAttribute("url"))]=t})),f(Je.animations,g),f(Je.clips,k),f(Je.controllers,M),f(Je.images,C),f(Je.effects,Y),f(Je.materials,q),f(Je.cameras,ee),f(Je.lights,ie),f(Je.geometries,le),f(Je.visualScenes,De),function(){var e=Je.clips;if(!0===c(e)){if(!1===c(Je.animations)){var t=[];for(var r in Je.animations)for(var i=y(r),a=0,o=i.length;a<o;a++)t.push(i[a]);qe.push(new n.AnimationClip("default",-1,t))}}else for(var r in e)qe.push(_(r))}(),function(){var e=Object.keys(Je.kinematicsModels)[0],t=Object.keys(Je.kinematicsScenes)[0],r=Object.keys(Je.visualScenes)[0];if(void 0!==e&&void 0!==t){for(var i,a=(i=e,d(Je.kinematicsModels[i],de)),o=function(e){return d(Je.kinematicsScenes[e],Re)}(t),s=Be(r),u=o.bindJointAxis,c={},l=0,p=u.length;l<p;l++){var h=u[l],f=je.querySelector('[sid="'+h.target+'"]');if(f){var m=f.parentElement;g(h.jointIndex,m)}}var v=new n.Matrix4;Ze={joints:a&&a.joints,getJointValue:function(e){var t=c[e];if(t)return t.position;console.warn("THREE.ColladaLoader: Joint "+e+" doesn't exist.")},setJointValue:function(e,t){var r=c[e];if(r){var i=r.joint;if(t>i.limits.max||t<i.limits.min)console.warn("THREE.ColladaLoader: Joint "+e+" value "+t+" outside of limits (min: "+i.limits.min+", max: "+i.limits.max+").");else if(i.static)console.warn("THREE.ColladaLoader: Joint "+e+" is static.");else{var a=r.object,o=i.axis,s=r.transforms;Ne.identity();for(var u=0;u<s.length;u++){var l=s[u];if(l.sid&&-1!==l.sid.indexOf(e))switch(i.type){case"revolute":Ne.multiply(v.makeRotationAxis(o,n.MathUtils.degToRad(t)));break;case"prismatic":Ne.multiply(v.makeTranslation(o.x*t,o.y*t,o.z*t));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+i.type)}else switch(l.type){case"matrix":Ne.multiply(l.obj);break;case"translate":Ne.multiply(v.makeTranslation(l.obj.x,l.obj.y,l.obj.z));break;case"scale":Ne.scale(l.obj);break;case"rotate":Ne.multiply(v.makeRotationAxis(l.obj,l.angle))}}a.matrix.copy(Ne),a.matrix.decompose(a.position,a.quaternion,a.scale),c[e].position=t}}else console.log("THREE.ColladaLoader: "+e+" does not exist.")}}}function g(e,t){var r=t.getAttribute("name"),n=a.joints[e];s.traverse((function(i){i.name===r&&(c[e]={object:i,transforms:we(t),joint:n,position:n.zeroPosition})}))}}();var Qe=function(e){return Be(u(r(e,"instance_visual_scene")[0].getAttribute("url")))}(r(je,"scene")[0]);return Qe.animations=qe,"Z_UP"===Xe.upAxis&&Qe.quaternion.setFromEuler(new n.Euler(-Math.PI/2,0,0)),Qe.scale.multiplyScalar(Xe.unit),{get animations(){return console.warn("THREE.ColladaLoader: Please access animations over scene.animations now."),qe},kinematics:Ze,library:Je,scene:Qe}}})},1985:function(e,t,r){"use strict";r.d(t,{y:function(){return St}});var n={};r.r(n),r.d(n,{AsyncCompress:function(){return Ie},AsyncDecompress:function(){return Xe},AsyncDeflate:function(){return be},AsyncGunzip:function(){return Pe},AsyncGzip:function(){return Ie},AsyncInflate:function(){return Se},AsyncUnzipInflate:function(){return Et},AsyncUnzlib:function(){return He},AsyncZipDeflate:function(){return dt},AsyncZlib:function(){return Be},Compress:function(){return Le},DecodeUTF8:function(){return tt},Decompress:function(){return Ke},Deflate:function(){return xe},EncodeUTF8:function(){return rt},Gunzip:function(){return Ce},Gzip:function(){return Le},Inflate:function(){return Ne},Unzip:function(){return At},UnzipInflate:function(){return Tt},UnzipPassThrough:function(){return yt},Unzlib:function(){return Ge},Zip:function(){return mt},ZipDeflate:function(){return ft},ZipPassThrough:function(){return ht},Zlib:function(){return De},compress:function(){return Oe},compressSync:function(){return Me},decompress:function(){return Ye},decompressSync:function(){return qe},default:function(){return Rt},deflate:function(){return Re},deflateSync:function(){return we},gunzip:function(){return Fe},gunzipSync:function(){return Ue},gzip:function(){return Oe},gzipSync:function(){return Me},inflate:function(){return ke},inflateSync:function(){return _e},strFromU8:function(){return it},strToU8:function(){return nt},unzip:function(){return xt},unzipSync:function(){return bt},unzlib:function(){return ze},unzlibSync:function(){return We},zip:function(){return vt},zipSync:function(){return gt},zlib:function(){return Ve},zlibSync:function(){return je}});var i=r(2212),a={},o=Uint8Array,s=Uint16Array,u=Uint32Array,c=new o([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),l=new o([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),p=new o([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),h=function(e,t){for(var r=new s(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];var i=new u(r[30]);for(n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)i[a]=a-r[n]<<5|n;return[r,i]},f=h(c,2),d=f[0],m=f[1];d[28]=258,m[258]=28;for(var v=h(l,0),g=v[0],y=v[1],T=new s(32768),E=0;E<32768;++E){var A=(43690&E)>>>1|(21845&E)<<1;A=(61680&(A=(52428&A)>>>2|(13107&A)<<2))>>>4|(3855&A)<<4,T[E]=((65280&A)>>>8|(255&A)<<8)>>>1}var x=function(e,t,r){for(var n=e.length,i=0,a=new s(t);i<n;++i)++a[e[i]-1];var o,u=new s(t);for(i=0;i<t;++i)u[i]=u[i-1]+a[i-1]<<1;if(r){o=new s(1<<t);var c=15-t;for(i=0;i<n;++i)if(e[i])for(var l=i<<4|e[i],p=t-e[i],h=u[e[i]-1]++<<p,f=h|(1<<p)-1;h<=f;++h)o[T[h]>>>c]=l}else for(o=new s(n),i=0;i<n;++i)e[i]&&(o[i]=T[u[e[i]-1]++]>>>15-e[i]);return o},b=new o(288);for(E=0;E<144;++E)b[E]=8;for(E=144;E<256;++E)b[E]=9;for(E=256;E<280;++E)b[E]=7;for(E=280;E<288;++E)b[E]=8;var R=new o(32);for(E=0;E<32;++E)R[E]=5;var w=x(b,9,0),N=x(b,9,1),S=x(R,5,0),k=x(R,5,1),_=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},L=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(7&t)&r},I=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},O=function(e){return(e/8|0)+(7&e&&1)},M=function(e,t,r){(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length);var n=new(e instanceof s?s:e instanceof u?u:o)(r-t);return n.set(e.subarray(t,r)),n},C=function(e,t,r){var n=e.length;if(!n||r&&!r.l&&n<5)return t||new o(0);var i=!t||r,a=!r||r.i;r||(r={}),t||(t=new o(3*n));var s=function(e){var r=t.length;if(e>r){var n=new o(Math.max(2*r,e));n.set(t),t=n}},u=r.f||0,h=r.p||0,f=r.b||0,m=r.l,v=r.d,y=r.m,T=r.n,E=8*n;do{if(!m){r.f=u=L(e,h,1);var A=L(e,h+1,3);if(h+=3,!A){var b=e[(j=O(h)+4)-4]|e[j-3]<<8,R=j+b;if(R>n){if(a)throw"unexpected EOF";break}i&&s(f+b),t.set(e.subarray(j,R),f),r.b=f+=b,r.p=h=8*R;continue}if(1==A)m=N,v=k,y=9,T=5;else{if(2!=A)throw"invalid block type";var w=L(e,h,31)+257,S=L(e,h+10,15)+4,C=w+L(e,h+5,31)+1;h+=14;for(var P=new o(C),F=new o(19),U=0;U<S;++U)F[p[U]]=L(e,h+3*U,7);h+=3*S;var D=_(F),B=(1<<D)-1;if(!a&&h+C*(D+7)>E)break;var V=x(F,D,1);for(U=0;U<C;){var j,G=V[L(e,h,B)];if(h+=15&G,(j=G>>>4)<16)P[U++]=j;else{var H=0,z=0;for(16==j?(z=3+L(e,h,3),h+=2,H=P[U-1]):17==j?(z=3+L(e,h,7),h+=3):18==j&&(z=11+L(e,h,127),h+=7);z--;)P[U++]=H}}var W=P.subarray(0,w),K=P.subarray(w);y=_(W),T=_(K),m=x(W,y,1),v=x(K,T,1)}if(h>E)throw"unexpected EOF"}i&&s(f+131072);for(var X=(1<<y)-1,Y=(1<<T)-1,q=y+T+18;a||h+q<E;){var Z=(H=m[I(e,h)&X])>>>4;if((h+=15&H)>E)throw"unexpected EOF";if(!H)throw"invalid length/literal";if(Z<256)t[f++]=Z;else{if(256==Z){m=null;break}var $=Z-254;if(Z>264){var J=c[U=Z-257];$=L(e,h,(1<<J)-1)+d[U],h+=J}var Q=v[I(e,h)&Y],ee=Q>>>4;if(!Q)throw"invalid distance";h+=15&Q;K=g[ee];if(ee>3){J=l[ee];K+=I(e,h)&(1<<J)-1,h+=J}if(h>E)throw"unexpected EOF";i&&s(f+131072);for(var te=f+$;f<te;f+=4)t[f]=t[f-K],t[f+1]=t[f+1-K],t[f+2]=t[f+2-K],t[f+3]=t[f+3-K];f=te}}r.l=m,r.p=h,r.b=f,m&&(u=1,r.m=y,r.d=v,r.n=T)}while(!u);return f==t.length?t:M(t,0,f)},P=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>>8},F=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>>8,e[n+2]|=r>>>16},U=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,a=r.slice();if(!i)return[z,0];if(1==i){var u=new o(r[0].s+1);return u[r[0].s]=1,[u,1]}r.sort((function(e,t){return e.f-t.f})),r.push({s:-1,f:25001});var c=r[0],l=r[1],p=0,h=1,f=2;for(r[0]={s:-1,f:c.f+l.f,l:c,r:l};h!=i-1;)c=r[r[p].f<r[f].f?p++:f++],l=r[p!=h&&r[p].f<r[f].f?p++:f++],r[h++]={s:-1,f:c.f+l.f,l:c,r:l};var d=a[0].s;for(n=1;n<i;++n)a[n].s>d&&(d=a[n].s);var m=new s(d+1),v=D(r[h-1],m,0);if(v>t){n=0;var g=0,y=v-t,T=1<<y;for(a.sort((function(e,t){return m[t.s]-m[e.s]||e.f-t.f}));n<i;++n){var E=a[n].s;if(!(m[E]>t))break;g+=T-(1<<v-m[E]),m[E]=t}for(g>>>=y;g>0;){var A=a[n].s;m[A]<t?g-=1<<t-m[A]++-1:++n}for(;n>=0&&g;--n){var x=a[n].s;m[x]==t&&(--m[x],++g)}v=t}return[new o(m),v]},D=function(e,t,r){return-1==e.s?Math.max(D(e.l,t,r+1),D(e.r,t,r+1)):t[e.s]=r},B=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new s(++t),n=0,i=e[0],a=1,o=function(e){r[n++]=e},u=1;u<=t;++u)if(e[u]==i&&u!=t)++a;else{if(!i&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(i),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(i);a=1,i=e[u]}return[r.subarray(0,n),t]},V=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},j=function(e,t,r){var n=r.length,i=O(t+2);e[i]=255&n,e[i+1]=n>>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var a=0;a<n;++a)e[i+a+4]=r[a];return 8*(i+4+n)},G=function(e,t,r,n,i,a,o,u,h,f,d){P(t,d++,r),++i[256];for(var m=U(i,15),v=m[0],g=m[1],y=U(a,15),T=y[0],E=y[1],A=B(v),N=A[0],k=A[1],_=B(T),L=_[0],I=_[1],O=new s(19),M=0;M<N.length;++M)O[31&N[M]]++;for(M=0;M<L.length;++M)O[31&L[M]]++;for(var C=U(O,7),D=C[0],G=C[1],H=19;H>4&&!D[p[H-1]];--H);var z,W,K,X,Y=f+5<<3,q=V(i,b)+V(a,R)+o,Z=V(i,v)+V(a,T)+o+14+3*H+V(O,D)+(2*O[16]+3*O[17]+7*O[18]);if(Y<=q&&Y<=Z)return j(t,d,e.subarray(h,h+f));if(P(t,d,1+(Z<q)),d+=2,Z<q){z=x(v,g,0),W=v,K=x(T,E,0),X=T;var $=x(D,G,0);P(t,d,k-257),P(t,d+5,I-1),P(t,d+10,H-4),d+=14;for(M=0;M<H;++M)P(t,d+3*M,D[p[M]]);d+=3*H;for(var J=[N,L],Q=0;Q<2;++Q){var ee=J[Q];for(M=0;M<ee.length;++M){var te=31&ee[M];P(t,d,$[te]),d+=D[te],te>15&&(P(t,d,ee[M]>>>5&127),d+=ee[M]>>>12)}}}else z=w,W=b,K=S,X=R;for(M=0;M<u;++M)if(n[M]>255){te=n[M]>>>18&31;F(t,d,z[te+257]),d+=W[te+257],te>7&&(P(t,d,n[M]>>>23&31),d+=c[te]);var re=31&n[M];F(t,d,K[re]),d+=X[re],re>3&&(F(t,d,n[M]>>>5&8191),d+=l[re])}else F(t,d,z[n[M]]),d+=W[n[M]];return F(t,d,z[256]),d+W[256]},H=new u([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),z=new o(0),W=function(e,t,r,n,i,a){var p=e.length,h=new o(n+p+5*(1+Math.ceil(p/7e3))+i),f=h.subarray(n,h.length-i),d=0;if(!t||p<8)for(var v=0;v<=p;v+=65535){var g=v+65535;g<p?d=j(f,d,e.subarray(v,g)):(f[v]=a,d=j(f,d,e.subarray(v,p)))}else{for(var T=H[t-1],E=T>>>13,A=8191&T,x=(1<<r)-1,b=new s(32768),R=new s(x+1),w=Math.ceil(r/3),N=2*w,S=function(t){return(e[t]^e[t+1]<<w^e[t+2]<<N)&x},k=new u(25e3),_=new s(288),L=new s(32),I=0,C=0,P=(v=0,0),F=0,U=0;v<p;++v){var D=S(v),B=32767&v,V=R[D];if(b[B]=V,R[D]=B,F<=v){var W=p-v;if((I>7e3||P>24576)&&W>423){d=G(e,f,0,k,_,L,C,P,U,v-U,d),P=I=C=0,U=v;for(var K=0;K<286;++K)_[K]=0;for(K=0;K<30;++K)L[K]=0}var X=2,Y=0,q=A,Z=B-V&32767;if(W>2&&D==S(v-Z))for(var $=Math.min(E,W)-1,J=Math.min(32767,v),Q=Math.min(258,W);Z<=J&&--q&&B!=V;){if(e[v+X]==e[v+X-Z]){for(var ee=0;ee<Q&&e[v+ee]==e[v+ee-Z];++ee);if(ee>X){if(X=ee,Y=Z,ee>$)break;var te=Math.min(Z,ee-2),re=0;for(K=0;K<te;++K){var ne=v-Z+K+32768&32767,ie=ne-b[ne]+32768&32767;ie>re&&(re=ie,V=ne)}}}Z+=(B=V)-(V=b[B])+32768&32767}if(Y){k[P++]=268435456|m[X]<<18|y[Y];var ae=31&m[X],oe=31&y[Y];C+=c[ae]+l[oe],++_[257+ae],++L[oe],F=v+X,++I}else k[P++]=e[v],++_[e[v]]}}d=G(e,f,a,k,_,L,C,P,U,v-U,d),!a&&7&d&&(d=j(f,d+1,z))}return M(h,0,n+O(d)+i)},K=function(){for(var e=new u(256),t=0;t<256;++t){for(var r=t,n=9;--n;)r=(1&r&&3988292384)^r>>>1;e[t]=r}return e}(),X=function(){var e=-1;return{p:function(t){for(var r=e,n=0;n<t.length;++n)r=K[255&r^t[n]]^r>>>8;e=r},d:function(){return~e}}},Y=function(){var e=1,t=0;return{p:function(r){for(var n=e,i=t,a=r.length,o=0;o!=a;){for(var s=Math.min(o+2655,a);o<s;++o)i+=n+=r[o];n=(65535&n)+15*(n>>16),i=(65535&i)+15*(i>>16)}e=n,t=i},d:function(){return((e%=65521)>>>8<<16|(255&(t%=65521))<<8|t>>>8)+2*((255&e)<<23)}}},q=function(e,t,r,n,i){return W(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,r,n,!i)},Z=function(e,t){var r={};for(var n in e)r[n]=e[n];for(var n in t)r[n]=t[n];return r},$=function(e,t,r){for(var n=e(),i=e.toString(),a=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/ /g,"").split(","),o=0;o<n.length;++o){var s=n[o],u=a[o];if("function"==typeof s){t+=";"+u+"=";var c=s.toString();if(s.prototype)if(-1!=c.indexOf("[native code]")){var l=c.indexOf(" ",8)+1;t+=c.slice(l,c.indexOf("(",l))}else for(var p in t+=c,s.prototype)t+=";"+u+".prototype."+p+"="+s.prototype[p].toString();else t+=c}else r[u]=s}return[t,r]},J=[],Q=function(e,t,r,n){var i;if(!J[r]){for(var c="",l={},p=e.length-1,h=0;h<p;++h)c=(i=$(e[h],c,l))[0],l=i[1];J[r]=$(e[p],c,l)}var f=Z({},J[r][1]);return function(e,t,r,n,i){var o=a[t]||(a[t]=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))),s=new Worker(o);return s.onerror=function(e){return i(e.error,null)},s.onmessage=function(e){return i(null,e.data)},s.postMessage(r,n),s}(J[r][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",r,f,function(e){var t=[];for(var r in e)(e[r]instanceof o||e[r]instanceof s||e[r]instanceof u)&&t.push((e[r]=new e[r].constructor(e[r])).buffer);return t}(f),n)},ee=function(){return[o,s,u,c,l,p,d,g,N,k,T,x,_,L,I,O,M,C,_e,oe,se]},te=function(){return[o,s,u,c,l,p,m,y,w,b,S,R,T,H,z,x,P,F,U,D,B,V,j,G,O,M,W,q,we,oe]},re=function(){return[me,ye,de,X,K]},ne=function(){return[ve,ge]},ie=function(){return[Te,de,Y]},ae=function(){return[Ee]},oe=function(e){return postMessage(e,[e.buffer])},se=function(e){return e&&e.size&&new o(e.size)},ue=function(e,t,r,n,i,a){var o=Q(r,n,i,(function(e,t){o.terminate(),a(e,t)}));return o.postMessage([e,t],t.consume?[e.buffer]:[]),function(){o.terminate()}},ce=function(e){return e.ondata=function(e,t){return postMessage([e,t],[e.buffer])},function(t){return e.push(t.data[0],t.data[1])}},le=function(e,t,r,n,i){var a,o=Q(e,n,i,(function(e,r){e?(o.terminate(),t.ondata.call(t,e)):(r[1]&&o.terminate(),t.ondata.call(t,e,r[0],r[1]))}));o.postMessage(r),t.push=function(e,r){if(a)throw"stream finished";if(!t.ondata)throw"no stream handler";o.postMessage([e,a=r],[e.buffer])},t.terminate=function(){o.terminate()}},pe=function(e,t){return e[t]|e[t+1]<<8},he=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+2*(e[t+3]<<23)},fe=function(e,t){return he(e,t)|4294967296*he(e,t)},de=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},me=function(e,t){var r=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:9==t.level?2:0,e[9]=3,0!=t.mtime&&de(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),r){e[3]=8;for(var n=0;n<=r.length;++n)e[n+10]=r.charCodeAt(n)}},ve=function(e){if(31!=e[0]||139!=e[1]||8!=e[2])throw"invalid gzip data";var t=e[3],r=10;4&t&&(r+=e[10]|2+(e[11]<<8));for(var n=(t>>3&1)+(t>>4&1);n>0;n-=!e[r++]);return r+(2&t)},ge=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16)+2*(e[t-1]<<23)},ye=function(e){return 10+(e.filename&&e.filename.length+1||0)},Te=function(e,t){var r=t.level,n=0==r?0:r<6?1:9==r?3:2;e[0]=120,e[1]=n<<6|(n?32-2*n:1)},Ee=function(e){if(8!=(15&e[0])||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(32&e[1])throw"invalid zlib data: preset dictionaries not supported"};function Ae(e,t){return!t&&"function"==typeof e&&(t=e,e={}),this.ondata=t,e}var xe=function(){function e(e,t){!t&&"function"==typeof e&&(t=e,e={}),this.ondata=t,this.o=e||{}}return e.prototype.p=function(e,t){this.ondata(q(e,this.o,0,0,!t),t)},e.prototype.push=function(e,t){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";this.d=t,this.p(e,t||!1)},e}(),be=function(e,t){le([te,function(){return[ce,xe]}],this,Ae.call(this,e,t),(function(e){var t=new xe(e.data);onmessage=ce(t)}),6)};function Re(e,t,r){if(r||(r=t,t={}),"function"!=typeof r)throw"no callback";return ue(e,t,[te],(function(e){return oe(we(e.data[0],e.data[1]))}),0,r)}function we(e,t){return q(e,t||{},0,0)}var Ne=function(){function e(e){this.s={},this.p=new o(0),this.ondata=e}return e.prototype.e=function(e){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";var t=this.p.length,r=new o(t+e.length);r.set(this.p),r.set(e,t),this.p=r},e.prototype.c=function(e){this.d=this.s.i=e||!1;var t=this.s.b,r=C(this.p,this.o,this.s);this.ondata(M(r,t,this.s.b),this.d),this.o=M(r,this.s.b-32768),this.s.b=this.o.length,this.p=M(this.p,this.s.p/8|0),this.s.p&=7},e.prototype.push=function(e,t){this.e(e),this.c(t)},e}(),Se=function(e){this.ondata=e,le([ee,function(){return[ce,Ne]}],this,0,(function(){var e=new Ne;onmessage=ce(e)}),7)};function ke(e,t,r){if(r||(r=t,t={}),"function"!=typeof r)throw"no callback";return ue(e,t,[ee],(function(e){return oe(_e(e.data[0],se(e.data[1])))}),1,r)}function _e(e,t){return C(e,t)}var Le=function(){function e(e,t){this.c=X(),this.l=0,this.v=1,xe.call(this,e,t)}return e.prototype.push=function(e,t){xe.prototype.push.call(this,e,t)},e.prototype.p=function(e,t){this.c.p(e),this.l+=e.length;var r=q(e,this.o,this.v&&ye(this.o),t&&8,!t);this.v&&(me(r,this.o),this.v=0),t&&(de(r,r.length-8,this.c.d()),de(r,r.length-4,this.l)),this.ondata(r,t)},e}(),Ie=function(e,t){le([te,re,function(){return[ce,xe,Le]}],this,Ae.call(this,e,t),(function(e){var t=new Le(e.data);onmessage=ce(t)}),8)};function Oe(e,t,r){if(r||(r=t,t={}),"function"!=typeof r)throw"no callback";return ue(e,t,[te,re,function(){return[Me]}],(function(e){return oe(Me(e.data[0],e.data[1]))}),2,r)}function Me(e,t){t||(t={});var r=X(),n=e.length;r.p(e);var i=q(e,t,ye(t),8),a=i.length;return me(i,t),de(i,a-8,r.d()),de(i,a-4,n),i}var Ce=function(){function e(e){this.v=1,Ne.call(this,e)}return e.prototype.push=function(e,t){if(Ne.prototype.e.call(this,e),this.v){var r=this.p.length>3?ve(this.p):4;if(r>=this.p.length&&!t)return;this.p=this.p.subarray(r),this.v=0}if(t){if(this.p.length<8)throw"invalid gzip stream";this.p=this.p.subarray(0,-8)}Ne.prototype.c.call(this,t)},e}(),Pe=function(e){this.ondata=e,le([ee,ne,function(){return[ce,Ne,Ce]}],this,0,(function(){var e=new Ce;onmessage=ce(e)}),9)};function Fe(e,t,r){if(r||(r=t,t={}),"function"!=typeof r)throw"no callback";return ue(e,t,[ee,ne,function(){return[Ue]}],(function(e){return oe(Ue(e.data[0]))}),3,r)}function Ue(e,t){return C(e.subarray(ve(e),-8),t||new o(ge(e)))}var De=function(){function e(e,t){this.c=Y(),this.v=1,xe.call(this,e,t)}return e.prototype.push=function(e,t){xe.prototype.push.call(this,e,t)},e.prototype.p=function(e,t){this.c.p(e);var r=q(e,this.o,this.v&&2,t&&4,!t);this.v&&(Te(r,this.o),this.v=0),t&&de(r,r.length-4,this.c.d()),this.ondata(r,t)},e}(),Be=function(e,t){le([te,ie,function(){return[ce,xe,De]}],this,Ae.call(this,e,t),(function(e){var t=new De(e.data);onmessage=ce(t)}),10)};function Ve(e,t,r){if(r||(r=t,t={}),"function"!=typeof r)throw"no callback";return ue(e,t,[te,ie,function(){return[je]}],(function(e){return oe(je(e.data[0],e.data[1]))}),4,r)}function je(e,t){t||(t={});var r=Y();r.p(e);var n=q(e,t,2,4);return Te(n,t),de(n,n.length-4,r.d()),n}var Ge=function(){function e(e){this.v=1,Ne.call(this,e)}return e.prototype.push=function(e,t){if(Ne.prototype.e.call(this,e),this.v){if(this.p.length<2&&!t)return;this.p=this.p.subarray(2),this.v=0}if(t){if(this.p.length<4)throw"invalid zlib stream";this.p=this.p.subarray(0,-4)}Ne.prototype.c.call(this,t)},e}(),He=function(e){this.ondata=e,le([ee,ae,function(){return[ce,Ne,Ge]}],this,0,(function(){var e=new Ge;onmessage=ce(e)}),11)};function ze(e,t,r){if(r||(r=t,t={}),"function"!=typeof r)throw"no callback";return ue(e,t,[ee,ae,function(){return[We]}],(function(e){return oe(We(e.data[0],se(e.data[1])))}),5,r)}function We(e,t){return C((Ee(e),e.subarray(2,-4)),t)}var Ke=function(){function e(e){this.G=Ce,this.I=Ne,this.Z=Ge,this.ondata=e}return e.prototype.push=function(e,t){if(!this.ondata)throw"no stream handler";if(this.s)this.s.push(e,t);else{if(this.p&&this.p.length){var r=new o(this.p.length+e.length);r.set(this.p),r.set(e,this.p.length)}else this.p=e;if(this.p.length>2){var n=this,i=function(){n.ondata.apply(n,arguments)};this.s=31==this.p[0]&&139==this.p[1]&&8==this.p[2]?new this.G(i):8!=(15&this.p[0])||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(i):new this.Z(i),this.s.push(this.p,t),this.p=null}}},e}(),Xe=function(){function e(e){this.G=Pe,this.I=Se,this.Z=He,this.ondata=e}return e.prototype.push=function(e,t){Ke.prototype.push.call(this,e,t)},e}();function Ye(e,t,r){if(r||(r=t,t={}),"function"!=typeof r)throw"no callback";return 31==e[0]&&139==e[1]&&8==e[2]?Fe(e,t,r):8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31?ke(e,t,r):ze(e,t,r)}function qe(e,t){return 31==e[0]&&139==e[1]&&8==e[2]?Ue(e,t):8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31?_e(e,t):We(e,t)}var Ze=function(e,t,r,n){for(var i in e){var a=e[i],s=t+i;a instanceof o?r[s]=[a,n]:Array.isArray(a)?r[s]=[a[0],Z(n,a[1])]:Ze(a,s+"/",r,n)}},$e="undefined"!=typeof TextEncoder&&new TextEncoder,Je="undefined"!=typeof TextDecoder&&new TextDecoder,Qe=0;try{Je.decode(z,{stream:!0}),Qe=1}catch(kt){}var et=function(e){for(var t="",r=0;;){var n=e[r++],i=(n>127)+(n>223)+(n>239);if(r+i>e.length)return[t,M(e,r-1)];i?3==i?(n=((15&n)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536,t+=String.fromCharCode(55296|n>>10,56320|1023&n)):t+=1&i?String.fromCharCode((31&n)<<6|63&e[r++]):String.fromCharCode((15&n)<<12|(63&e[r++])<<6|63&e[r++]):t+=String.fromCharCode(n)}},tt=function(){function e(e){this.ondata=e,Qe?this.t=new TextDecoder:this.p=z}return e.prototype.push=function(e,t){if(!this.ondata)throw"no callback";if(t||(t=!1),this.t)return this.ondata(this.t.decode(e,{stream:!t}),t);var r=new o(this.p.length+e.length);r.set(this.p),r.set(e,this.p.length);var n=et(r),i=n[0],a=n[1];if(t&&a.length)throw"invalid utf-8 data";this.p=a,this.ondata(i,t)},e}(),rt=function(){function e(e){this.ondata=e}return e.prototype.push=function(e,t){if(!this.ondata)throw"no callback";this.ondata(nt(e),t||!1)},e}();function nt(e,t){if(t){for(var r=new o(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}if($e)return $e.encode(e);var i=e.length,a=new o(e.length+(e.length>>1)),s=0,u=function(e){a[s++]=e};for(n=0;n<i;++n){if(s+5>a.length){var c=new o(s+8+(i-n<<1));c.set(a),a=c}var l=e.charCodeAt(n);l<128||t?u(l):l<2048?(u(192|l>>>6),u(128|63&l)):l>55295&&l<57344?(u(240|(l=65536+(1047552&l)|1023&e.charCodeAt(++n))>>>18),u(128|l>>>12&63),u(128|l>>>6&63),u(128|63&l)):(u(224|l>>>12),u(128|l>>>6&63),u(128|63&l))}return M(a,0,s)}function it(e,t){if(t){for(var r="",n=0;n<e.length;n+=16384)r+=String.fromCharCode.apply(null,e.subarray(n,n+16384));return r}if(Je)return Je.decode(e);var i=et(e),a=i[0];if(i[1].length)throw"invalid utf-8 data";return a}var at=function(e){return 1==e?3:e<6?2:9==e?1:0},ot=function(e,t){return t+30+pe(e,t+26)+pe(e,t+28)},st=function(e,t,r){var n=pe(e,t+28),i=it(e.subarray(t+46,t+46+n),!(2048&pe(e,t+8))),a=t+46+n,o=he(e,t+20),s=r&&4294967295==o?ut(e,a):[o,he(e,t+24),he(e,t+42)],u=s[0],c=s[1],l=s[2];return[pe(e,t+10),u,c,i,a+pe(e,t+30)+pe(e,t+32),l]},ut=function(e,t){for(;1!=pe(e,t);t+=4+pe(e,t+2));return[fe(e,t+12),fe(e,t+4),fe(e,t+20)]},ct=function(e){var t=0;if(e)for(var r in e){var n=e[r].length;if(n>65535)throw"extra field too long";t+=n+4}return t},lt=function(e,t,r,n,i,a,o,s){var u=n.length,c=r.extra,l=s&&s.length,p=ct(c);de(e,t,null!=o?33639248:67324752),t+=4,null!=o&&(e[t++]=20,e[t++]=r.os),e[t]=20,t+=2,e[t++]=r.flag<<1|(null==a&&8),e[t++]=i&&8,e[t++]=255&r.compression,e[t++]=r.compression>>8;var h=new Date(null==r.mtime?Date.now():r.mtime),f=h.getFullYear()-1980;if(f<0||f>119)throw"date not in range 1980-2099";if(de(e,t,2*(f<<24)|h.getMonth()+1<<21|h.getDate()<<16|h.getHours()<<11|h.getMinutes()<<5|h.getSeconds()>>>1),t+=4,null!=a&&(de(e,t,r.crc),de(e,t+4,a),de(e,t+8,r.size)),de(e,t+12,u),de(e,t+14,p),t+=16,null!=o&&(de(e,t,l),de(e,t+6,r.attrs),de(e,t+10,o),t+=14),e.set(n,t),t+=u,p)for(var d in c){var m=c[d],v=m.length;de(e,t,+d),de(e,t+2,v),e.set(m,t+4),t+=4+v}return l&&(e.set(s,t),t+=l),t},pt=function(e,t,r,n,i){de(e,t,101010256),de(e,t+8,r),de(e,t+10,r),de(e,t+12,n),de(e,t+16,i)},ht=function(){function e(e){this.filename=e,this.c=X(),this.size=0,this.compression=0}return e.prototype.process=function(e,t){this.ondata(null,e,t)},e.prototype.push=function(e,t){if(!this.ondata)throw"no callback - add to ZIP archive before pushing";this.c.p(e),this.size+=e.length,t&&(this.crc=this.c.d()),this.process(e,t||!1)},e}(),ft=function(){function e(e,t){var r=this;t||(t={}),ht.call(this,e),this.d=new xe(t,(function(e,t){r.ondata(null,e,t)})),this.compression=8,this.flag=at(t.level)}return e.prototype.process=function(e,t){try{this.d.push(e,t)}catch(r){this.ondata(r,null,t)}},e.prototype.push=function(e,t){ht.prototype.push.call(this,e,t)},e}(),dt=function(){function e(e,t){var r=this;t||(t={}),ht.call(this,e),this.d=new be(t,(function(e,t,n){r.ondata(e,t,n)})),this.compression=8,this.flag=at(t.level),this.terminate=this.d.terminate}return e.prototype.process=function(e,t){this.d.push(e,t)},e.prototype.push=function(e,t){ht.prototype.push.call(this,e,t)},e}(),mt=function(){function e(e){this.ondata=e,this.u=[],this.d=1}return e.prototype.add=function(e){var t=this;if(2&this.d)throw"stream finished";var r=nt(e.filename),n=r.length,i=e.comment,a=i&&nt(i),s=n!=e.filename.length||a&&i.length!=a.length,u=n+ct(e.extra)+30;if(n>65535)throw"filename too long";var c=new o(u);lt(c,0,e,r,s);var l=[c],p=function(){for(var e=0,r=l;e<r.length;e++){var n=r[e];t.ondata(null,n,!1)}l=[]},h=this.d;this.d=0;var f=this.u.length,d=Z(e,{f:r,u:s,o:a,t:function(){e.terminate&&e.terminate()},r:function(){if(p(),h){var e=t.u[f+1];e?e.r():t.d=1}h=1}}),m=0;e.ondata=function(r,n,i){if(r)t.ondata(r,n,i),t.terminate();else if(m+=n.length,l.push(n),i){var a=new o(16);de(a,0,134695760),de(a,4,e.crc),de(a,8,m),de(a,12,e.size),l.push(a),d.c=m,d.b=u+m+16,d.crc=e.crc,d.size=e.size,h&&d.r(),h=1}else h&&p()},this.u.push(d)},e.prototype.end=function(){var e=this;if(2&this.d)throw 1&this.d?"stream finishing":"stream finished";this.d?this.e():this.u.push({r:function(){1&e.d&&(e.u.splice(-1,1),e.e())},t:function(){}}),this.d=3},e.prototype.e=function(){for(var e=0,t=0,r=0,n=0,i=this.u;n<i.length;n++){r+=46+(c=i[n]).f.length+ct(c.extra)+(c.o?c.o.length:0)}for(var a=new o(r+22),s=0,u=this.u;s<u.length;s++){var c=u[s];lt(a,e,c,c.f,c.u,c.c,t,c.o),e+=46+c.f.length+ct(c.extra)+(c.o?c.o.length:0),t+=c.b}pt(a,e,this.u.length,r,t),this.ondata(null,a,!0),this.d=2},e.prototype.terminate=function(){for(var e=0,t=this.u;e<t.length;e++){t[e].t()}this.d=2},e}();function vt(e,t,r){if(r||(r=t,t={}),"function"!=typeof r)throw"no callback";var n={};Ze(e,"",n,t);var i=Object.keys(n),a=i.length,s=0,u=0,c=a,l=new Array(a),p=[],h=function(){for(var e=0;e<p.length;++e)p[e]()},f=function(){var e=new o(u+22),t=s,n=u-s;u=0;for(var i=0;i<c;++i){var a=l[i];try{var p=a.c.length;lt(e,u,a,a.f,a.u,p);var h=30+a.f.length+ct(a.extra),f=u+h;e.set(a.c,f),lt(e,s,a,a.f,a.u,p,u,a.m),s+=16+h+(a.m?a.m.length:0),u=f+p}catch(d){return r(d,null)}}pt(e,s,l.length,n,t),r(null,e)};a||f();for(var d=function(e){var t=i[e],o=n[t],c=o[0],d=o[1],m=X(),v=c.length;m.p(c);var g=nt(t),y=g.length,T=d.comment,E=T&&nt(T),A=E&&E.length,x=ct(d.extra),b=0==d.level?0:8,R=function(n,i){if(n)h(),r(n,null);else{var o=i.length;l[e]=Z(d,{size:v,crc:m.d(),c:i,f:g,m:E,u:y!=t.length||E&&T.length!=A,compression:b}),s+=30+y+x+o,u+=76+2*(y+x)+(A||0)+o,--a||f()}};if(y>65535&&R("filename too long",null),b)if(v<16e4)try{R(null,we(c,d))}catch(w){R(w,null)}else p.push(Re(c,d,R));else R(null,c)},m=0;m<c;++m)d(m);return h}function gt(e,t){t||(t={});var r={},n=[];Ze(e,"",r,t);var i=0,a=0;for(var s in r){var u=r[s],c=u[0],l=u[1],p=0==l.level?0:8,h=(R=nt(s)).length,f=l.comment,d=f&&nt(f),m=d&&d.length,v=ct(l.extra);if(h>65535)throw"filename too long";var g=p?we(c,l):c,y=g.length,T=X();T.p(c),n.push(Z(l,{size:c.length,crc:T.d(),c:g,f:R,m:d,u:h!=s.length||d&&f.length!=m,o:i,compression:p})),i+=30+h+v+y,a+=76+2*(h+v)+(m||0)+y}for(var E=new o(a+22),A=i,x=a-i,b=0;b<n.length;++b){var R=n[b];lt(E,R.o,R,R.f,R.u,R.c.length);var w=30+R.f.length+ct(R.extra);E.set(R.c,R.o+w),lt(E,i,R,R.f,R.u,R.c.length,R.o,R.m),i+=16+w+(R.m?R.m.length:0)}return pt(E,i,n.length,x,A),E}var yt=function(){function e(){}return e.prototype.push=function(e,t){this.ondata(null,e,t)},e.compression=0,e}(),Tt=function(){function e(){var e=this;this.i=new Ne((function(t,r){e.ondata(null,t,r)}))}return e.prototype.push=function(e,t){try{this.i.push(e,t)}catch(r){this.ondata(r,e,t)}},e.compression=8,e}(),Et=function(){function e(e,t){var r=this;t<32e4?this.i=new Ne((function(e,t){r.ondata(null,e,t)})):(this.i=new Se((function(e,t,n){r.ondata(e,t,n)})),this.terminate=this.i.terminate)}return e.prototype.push=function(e,t){this.i.terminate&&(e=M(e,0)),this.i.push(e,t)},e.compression=8,e}(),At=function(){function e(e){this.onfile=e,this.k=[],this.o={0:yt},this.p=z}return e.prototype.push=function(e,t){var r=this;if(!this.onfile)throw"no callback";if(this.c>0){var n=Math.min(this.c,e.length),i=e.subarray(0,n);if(this.c-=n,this.d?this.d.push(i,!this.c):this.k[0].push(i),(e=e.subarray(n)).length)return this.push(e,t)}else{var a=0,s=0,u=void 0,c=void 0;this.p.length?e.length?((c=new o(this.p.length+e.length)).set(this.p),c.set(e,this.p.length)):c=this.p:c=e;for(var l=c.length,p=this.c,h=p&&this.d,f=function(){var e,t=he(c,s);if(67324752==t){a=1,u=s,d.d=null,d.c=0;var n=pe(c,s+6),i=pe(c,s+8),o=2048&n,h=8&n,f=pe(c,s+26),m=pe(c,s+28);if(l>s+30+f+m){var v=[];d.k.unshift(v),a=2;var g=he(c,s+18),y=he(c,s+22),T=it(c.subarray(s+30,s+=30+f),!o);4294967295==g?(e=h?[-2]:ut(c,s),g=e[0],y=e[1]):h&&(g=-1),s+=m,d.c=g;var E={name:T,compression:i,start:function(){if(!E.ondata)throw"no callback";if(g){var e=r.o[i];if(!e)throw"unknown compression type "+i;var t=g<0?new e(T):new e(T,g,y);t.ondata=function(e,t,r){E.ondata(e,t,r)};for(var n=0,a=v;n<a.length;n++){var o=a[n];t.push(o,!1)}r.k[0]==v?r.d=t:t.push(z,!0)}else E.ondata(null,z,!0)},terminate:function(){r.k[0]==v&&r.d.terminate&&r.d.terminate()}};g>=0&&(E.size=g,E.originalSize=y),d.onfile(E)}return"break"}if(p){if(134695760==t)return u=s+=12+(-2==p&&8),a=2,d.c=0,"break";if(33639248==t)return u=s-=4,a=2,d.c=0,"break"}},d=this;s<l-4;++s){if("break"===f())break}if(this.p=z,p<0){var m=a?c.subarray(0,u-12-(-2==p&&8)-(134695760==he(c,u-16)&&4)):c.subarray(0,s);h?h.push(m,!!a):this.k[+(2==a)].push(m)}if(2&a)return this.push(c.subarray(s),t);this.p=c.subarray(s)}if(t&&this.c)throw"invalid zip file"},e.prototype.register=function(e){this.o[e.compression]=e},e}();function xt(e,t){if("function"!=typeof t)throw"no callback";for(var r=[],n=function(){for(var e=0;e<r.length;++e)r[e]()},i={},a=e.length-22;101010256!=he(e,a);--a)if(!a||e.length-a>65558)return void t("invalid zip file",null);var s=pe(e,a+8);s||t(null,{});var u=s,c=he(e,a+16),l=4294967295==c;if(l){if(a=he(e,a-12),101075792!=he(e,a))return void t("invalid zip file",null);u=s=he(e,a+32),c=he(e,a+48)}for(var p=function(a){var u=st(e,c,l),p=u[0],h=u[1],f=u[2],d=u[3],m=u[4],v=u[5],g=ot(e,v);c=m;var y=function(e,r){e?(n(),t(e,null)):(i[d]=r,--s||t(null,i))};if(p)if(8==p){var T=e.subarray(g,g+h);if(h<32e4)try{y(null,_e(T,new o(f)))}catch(E){y(E,null)}else r.push(ke(T,{size:f},y))}else y("unknown compression type "+p,null);else y(null,M(e,g,g+h))},h=0;h<u;++h)p();return n}function bt(e){for(var t={},r=e.length-22;101010256!=he(e,r);--r)if(!r||e.length-r>65558)throw"invalid zip file";var n=pe(e,r+8);if(!n)return{};var i=he(e,r+16),a=4294967295==i;if(a){if(r=he(e,r-12),101075792!=he(e,r))throw"invalid zip file";n=he(e,r+32),i=he(e,r+48)}for(var s=0;s<n;++s){var u=st(e,i,a),c=u[0],l=u[1],p=u[2],h=u[3],f=u[4],d=u[5],m=ot(e,d);if(i=f,c){if(8!=c)throw"unknown compression type "+c;t[h]=_e(e.subarray(m,m+l),new o(p))}else t[h]=M(e,m,m+l)}return t}var Rt=null,wt={findSpan:function(e,t,r){var n=r.length-e-1;if(t>=r[n])return n-1;if(t<=r[e])return e;for(var i=e,a=n,o=Math.floor((i+a)/2);t<r[o]||t>=r[o+1];)t<r[o]?a=o:i=o,o=Math.floor((i+a)/2);return o},calcBasisFunctions:function(e,t,r,n){var i=[],a=[],o=[];i[0]=1;for(var s=1;s<=r;++s){a[s]=t-n[e+1-s],o[s]=n[e+s]-t;for(var u=0,c=0;c<s;++c){var l=o[c+1],p=a[s-c],h=i[c]/(l+p);i[c]=u+l*h,u=p*h}i[s]=u}return i},calcBSplinePoint:function(e,t,r,n){for(var a=this.findSpan(e,n,t),o=this.calcBasisFunctions(a,n,e,t),s=new i.Vector4(0,0,0,0),u=0;u<=e;++u){var c=r[a-e+u],l=o[u],p=c.w*l;s.x+=c.x*p,s.y+=c.y*p,s.z+=c.z*p,s.w+=c.w*l}return s},calcBasisFunctionDerivatives:function(e,t,r,n,i){for(var a=[],o=0;o<=r;++o)a[o]=0;var s=[];for(o=0;o<=n;++o)s[o]=a.slice(0);var u=[];for(o=0;o<=r;++o)u[o]=a.slice(0);u[0][0]=1;for(var c=a.slice(0),l=a.slice(0),p=1;p<=r;++p){c[p]=t-i[e+1-p],l[p]=i[e+p]-t;for(var h=0,f=0;f<p;++f){var d=l[f+1],m=c[p-f];u[p][f]=d+m;var v=u[f][p-1]/u[p][f];u[f][p]=h+d*v,h=m*v}u[p][p]=h}for(p=0;p<=r;++p)s[0][p]=u[p][r];for(f=0;f<=r;++f){var g=0,y=1,T=[];for(o=0;o<=r;++o)T[o]=a.slice(0);T[0][0]=1;for(var E=1;E<=n;++E){var A=0,x=f-E,b=r-E;f>=E&&(T[y][0]=T[g][0]/u[b+1][x],A=T[y][0]*u[x][b]);var R=f-1<=b?E-1:r-f;for(p=x>=-1?1:-x;p<=R;++p)T[y][p]=(T[g][p]-T[g][p-1])/u[b+1][x+p],A+=T[y][p]*u[x+p][b];f<=b&&(T[y][E]=-T[g][E-1]/u[b+1][f],A+=T[y][E]*u[f][b]),s[E][f]=A;p=g;g=y,y=p}}for(f=r,E=1;E<=n;++E){for(p=0;p<=r;++p)s[E][p]*=f;f*=r-E}return s},calcBSplineDerivatives:function(e,t,r,n,a){for(var o=a<e?a:e,s=[],u=this.findSpan(e,n,t),c=this.calcBasisFunctionDerivatives(u,n,e,o,t),l=[],p=0;p<r.length;++p){var h=(d=r[p].clone()).w;d.x*=h,d.y*=h,d.z*=h,l[p]=d}for(var f=0;f<=o;++f){for(var d=l[u-e].clone().multiplyScalar(c[f][0]),m=1;m<=e;++m)d.add(l[u-e+m].clone().multiplyScalar(c[f][m]));s[f]=d}for(f=o+1;f<=a+1;++f)s[f]=new i.Vector4(0,0,0);return s},calcKoverI:function(e,t){for(var r=1,n=2;n<=e;++n)r*=n;var i=1;for(n=2;n<=t;++n)i*=n;for(n=2;n<=e-t;++n)i*=n;return r/i},calcRationalCurveDerivatives:function(e){for(var t=e.length,r=[],n=[],a=0;a<t;++a){var o=e[a];r[a]=new i.Vector3(o.x,o.y,o.z),n[a]=o.w}for(var s=[],u=0;u<t;++u){var c=r[u].clone();for(a=1;a<=u;++a)c.sub(s[u-a].clone().multiplyScalar(this.calcKoverI(u,a)*n[a]));s[u]=c.divideScalar(n[0])}return s},calcNURBSDerivatives:function(e,t,r,n,i){var a=this.calcBSplineDerivatives(e,t,r,n,i);return this.calcRationalCurveDerivatives(a)},calcSurfacePoint:function(e,t,r,n,a,o,s,u){for(var c=this.findSpan(e,o,r),l=this.findSpan(t,s,n),p=this.calcBasisFunctions(c,o,e,r),h=this.calcBasisFunctions(l,s,t,n),f=[],d=0;d<=t;++d){f[d]=new i.Vector4(0,0,0,0);for(var m=0;m<=e;++m){var v=a[c-e+m][l-t+d].clone(),g=v.w;v.x*=g,v.y*=g,v.z*=g,f[d].add(v.multiplyScalar(p[m]))}}var y=new i.Vector4(0,0,0,0);for(d=0;d<=t;++d)y.add(f[d].multiplyScalar(h[d]));y.divideScalar(y.w),u.set(y.x,y.y,y.z)}},Nt=function(e,t,r,n,a){i.Curve.call(this),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=n||0,this.endKnot=a||this.knots.length-1;for(var o=0;o<r.length;++o){var s=r[o];this.controlPoints[o]=new i.Vector4(s.x,s.y,s.z,s.w)}};(Nt.prototype=Object.create(i.Curve.prototype)).constructor=Nt,Nt.prototype.getPoint=function(e,t){var r=t||new i.Vector3,n=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),a=wt.calcBSplinePoint(this.degree,this.knots,this.controlPoints,n);return 1!=a.w&&a.divideScalar(a.w),r.set(a.x,a.y,a.z)},Nt.prototype.getTangent=function(e,t){var r=t||new i.Vector3,n=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),a=wt.calcNURBSDerivatives(this.degree,this.knots,this.controlPoints,n,1);return r.copy(a[1]).normalize(),r};var St=function(){var e,t,r;function a(e){i.Loader.call(this,e)}function o(e,t){this.textureLoader=e,this.manager=t}function s(){}function u(){}function c(){}function l(){}function p(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t}function h(){}function f(e){var t=e.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function d(e){return e/46186158e3}a.prototype=Object.assign(Object.create(i.Loader.prototype),{constructor:a,load:function(e,t,r,n){var a=this,o=""===a.path?i.LoaderUtils.extractUrlBase(e):a.path,s=new i.FileLoader(this.manager);s.setPath(a.path),s.setResponseType("arraybuffer"),s.setRequestHeader(a.requestHeader),s.setWithCredentials(a.withCredentials),s.load(e,(function(r){try{t(a.parse(r,o))}catch(i){n?n(i):console.error(i),a.manager.itemError(e)}}),r,n)},parse:function(t,r){if(function(e){var t="Kaydara FBX Binary  \0";return e.byteLength>=t.length&&t===x(e,0,t.length)}(t))e=(new l).parse(t);else{var n=x(t);if(!function(e){var t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],r=0;function n(t){var n=e[t-1];return e=e.slice(r+t),r++,n}for(var i=0;i<t.length;++i){if(n(1)===t[i])return!1}return!0}(n))throw new Error("THREE.FBXLoader: Unknown format.");if(f(n)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+f(n));e=(new c).parse(n)}return new o(new i.TextureLoader(this.manager).setPath(this.resourcePath||r).setCrossOrigin(this.crossOrigin),this.manager).parse(e)}}),o.prototype={constructor:o,parse:function(){t=this.parseConnections();var e=this.parseImages(),n=this.parseTextures(e),i=this.parseMaterials(n),a=this.parseDeformers(),o=(new s).parse(a);return this.parseScene(a,o,i),r},parseConnections:function(){var t=new Map;"Connections"in e&&e.Connections.connections.forEach((function(e){var r=e[0],n=e[1],i=e[2];t.has(r)||t.set(r,{parents:[],children:[]});var a={ID:n,relationship:i};t.get(r).parents.push(a),t.has(n)||t.set(n,{parents:[],children:[]});var o={ID:r,relationship:i};t.get(n).children.push(o)}));return t},parseImages:function(){var t={},r={};if("Video"in e.Objects){var n=e.Objects.Video;for(var i in n){var a=n[i];if(t[c=parseInt(i)]=a.RelativeFilename||a.Filename,"Content"in a){var o=a.Content instanceof ArrayBuffer&&a.Content.byteLength>0,s="string"===typeof a.Content&&""!==a.Content;if(o||s){var u=this.parseImage(n[i]);r[a.RelativeFilename||a.Filename]=u}}}}for(var c in t){var l=t[c];void 0!==r[l]?t[c]=r[l]:t[c]=t[c].split("\\").pop()}return t},parseImage:function(e){var t,r=e.Content,n=e.RelativeFilename||e.Filename,i=n.slice(n.lastIndexOf(".")+1).toLowerCase();switch(i){case"bmp":t="image/bmp";break;case"jpg":case"jpeg":t="image/jpeg";break;case"png":t="image/png";break;case"tif":t="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",n),t="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+i+'" is not supported.')}if("string"===typeof r)return"data:"+t+";base64,"+r;var a=new Uint8Array(r);return window.URL.createObjectURL(new Blob([a],{type:t}))},parseTextures:function(t){var r=new Map;if("Texture"in e.Objects){var n=e.Objects.Texture;for(var i in n){var a=this.parseTexture(n[i],t);r.set(parseInt(i),a)}}return r},parseTexture:function(e,t){var r=this.loadTexture(e,t);r.ID=e.id,r.name=e.attrName;var n=e.WrapModeU,a=e.WrapModeV,o=void 0!==n?n.value:0,s=void 0!==a?a.value:0;if(r.wrapS=0===o?i.RepeatWrapping:i.ClampToEdgeWrapping,r.wrapT=0===s?i.RepeatWrapping:i.ClampToEdgeWrapping,"Scaling"in e){var u=e.Scaling.value;r.repeat.x=u[0],r.repeat.y=u[1]}return r},loadTexture:function(e,r){var n,a,o=this.textureLoader.path,s=t.get(e.id).children;void 0!==s&&s.length>0&&void 0!==r[s[0].ID]&&(0!==(n=r[s[0].ID]).indexOf("blob:")&&0!==n.indexOf("data:")||this.textureLoader.setPath(void 0));var u=e.FileName.slice(-3).toLowerCase();if("tga"===u){var c=this.manager.getHandler(".tga");null===c?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),a=new i.Texture):a=c.load(n)}else"psd"===u?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),a=new i.Texture):a=this.textureLoader.load(n);return this.textureLoader.setPath(o),a},parseMaterials:function(t){var r=new Map;if("Material"in e.Objects){var n=e.Objects.Material;for(var i in n){var a=this.parseMaterial(n[i],t);null!==a&&r.set(parseInt(i),a)}}return r},parseMaterial:function(e,r){var n=e.id,a=e.attrName,o=e.ShadingModel;if("object"===typeof o&&(o=o.value),!t.has(n))return null;var s,u=this.parseParameters(e,r,n);switch(o.toLowerCase()){case"phong":s=new i.MeshPhongMaterial;break;case"lambert":s=new i.MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',o),s=new i.MeshPhongMaterial}return s.setValues(u),s.name=a,s},parseParameters:function(e,r,n){var a={};e.BumpFactor&&(a.bumpScale=e.BumpFactor.value),e.Diffuse?a.color=(new i.Color).fromArray(e.Diffuse.value):!e.DiffuseColor||"Color"!==e.DiffuseColor.type&&"ColorRGB"!==e.DiffuseColor.type||(a.color=(new i.Color).fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(a.displacementScale=e.DisplacementFactor.value),e.Emissive?a.emissive=(new i.Color).fromArray(e.Emissive.value):!e.EmissiveColor||"Color"!==e.EmissiveColor.type&&"ColorRGB"!==e.EmissiveColor.type||(a.emissive=(new i.Color).fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(a.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(a.opacity=parseFloat(e.Opacity.value)),a.opacity<1&&(a.transparent=!0),e.ReflectionFactor&&(a.reflectivity=e.ReflectionFactor.value),e.Shininess&&(a.shininess=e.Shininess.value),e.Specular?a.specular=(new i.Color).fromArray(e.Specular.value):e.SpecularColor&&"Color"===e.SpecularColor.type&&(a.specular=(new i.Color).fromArray(e.SpecularColor.value));var o=this;return t.get(n).children.forEach((function(e){var t=e.relationship;switch(t){case"Bump":a.bumpMap=o.getTexture(r,e.ID);break;case"Maya|TEX_ao_map":a.aoMap=o.getTexture(r,e.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":a.map=o.getTexture(r,e.ID),a.map.encoding=i.sRGBEncoding;break;case"DisplacementColor":a.displacementMap=o.getTexture(r,e.ID);break;case"EmissiveColor":a.emissiveMap=o.getTexture(r,e.ID),a.emissiveMap.encoding=i.sRGBEncoding;break;case"NormalMap":case"Maya|TEX_normal_map":a.normalMap=o.getTexture(r,e.ID);break;case"ReflectionColor":a.envMap=o.getTexture(r,e.ID),a.envMap.mapping=i.EquirectangularReflectionMapping,a.envMap.encoding=i.sRGBEncoding;break;case"SpecularColor":a.specularMap=o.getTexture(r,e.ID),a.specularMap.encoding=i.sRGBEncoding;break;case"TransparentColor":case"TransparencyFactor":a.alphaMap=o.getTexture(r,e.ID),a.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",t)}})),a},getTexture:function(r,n){return"LayeredTexture"in e.Objects&&n in e.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),n=t.get(n).children[0].ID),r.get(n)},parseDeformers:function(){var r={},n={};if("Deformer"in e.Objects){var i=e.Objects.Deformer;for(var a in i){var o=i[a],s=t.get(parseInt(a));if("Skin"===o.attrType){var u=this.parseSkeleton(s,i);u.ID=a,s.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),u.geometryID=s.parents[0].ID,r[a]=u}else if("BlendShape"===o.attrType){var c={id:a};c.rawTargets=this.parseMorphTargets(s,i),c.id=a,s.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),n[a]=c}}}return{skeletons:r,morphTargets:n}},parseSkeleton:function(e,t){var r=[];return e.children.forEach((function(e){var n=t[e.ID];if("Cluster"===n.attrType){var a={ID:e.ID,indices:[],weights:[],transformLink:(new i.Matrix4).fromArray(n.TransformLink.a)};"Indexes"in n&&(a.indices=n.Indexes.a,a.weights=n.Weights.a),r.push(a)}})),{rawBones:r,bones:[]}},parseMorphTargets:function(e,r){for(var n=[],i=0;i<e.children.length;i++){var a=e.children[i],o=r[a.ID],s={name:o.attrName,initialWeight:o.DeformPercent,id:o.id,fullWeights:o.FullWeights.a};if("BlendShapeChannel"!==o.attrType)return;s.geoID=t.get(parseInt(a.ID)).children.filter((function(e){return void 0===e.relationship}))[0].ID,n.push(s)}return n},parseScene:function(n,a,o){r=new i.Group;var s=this.parseModels(n.skeletons,a,o),c=e.Objects.Model,l=this;s.forEach((function(e){var n=c[e.ID];l.setLookAtProperties(e,n),t.get(e.ID).parents.forEach((function(t){var r=s.get(t.ID);void 0!==r&&r.add(e)})),null===e.parent&&r.add(e)})),this.bindSkeleton(n.skeletons,a,s),this.createAmbientLight(),this.setupMorphMaterials(),r.traverse((function(e){if(e.userData.transformData){e.parent&&(e.userData.transformData.parentMatrix=e.parent.matrix,e.userData.transformData.parentMatrixWorld=e.parent.matrixWorld);var t=T(e.userData.transformData);e.applyMatrix4(t),e.updateWorldMatrix()}}));var p=(new u).parse();1===r.children.length&&r.children[0].isGroup&&(r.children[0].animations=p,r=r.children[0]),r.animations=p},parseModels:function(r,n,a){var o=new Map,s=e.Objects.Model;for(var u in s){var c=parseInt(u),l=s[u],p=t.get(c),h=this.buildSkeleton(p,r,c,l.attrName);if(!h){switch(l.attrType){case"Camera":h=this.createCamera(p);break;case"Light":h=this.createLight(p);break;case"Mesh":h=this.createMesh(p,n,a);break;case"NurbsCurve":h=this.createCurve(p,n);break;case"LimbNode":case"Root":h=new i.Bone;break;case"Null":default:h=new i.Group}h.name=l.attrName?i.PropertyBinding.sanitizeNodeName(l.attrName):"",h.ID=c}this.getTransformData(h,l),o.set(c,h)}return o},buildSkeleton:function(e,t,r,n){var a=null;return e.parents.forEach((function(e){for(var o in t){var s=t[o];s.rawBones.forEach((function(t,o){if(t.ID===e.ID){var u=a;(a=new i.Bone).matrixWorld.copy(t.transformLink),a.name=n?i.PropertyBinding.sanitizeNodeName(n):"",a.ID=r,s.bones[o]=a,null!==u&&a.add(u)}}))}})),a},createCamera:function(t){var r,n;if(t.children.forEach((function(t){var r=e.Objects.NodeAttribute[t.ID];void 0!==r&&(n=r)})),void 0===n)r=new i.Object3D;else{var a=0;void 0!==n.CameraProjectionType&&1===n.CameraProjectionType.value&&(a=1);var o=1;void 0!==n.NearPlane&&(o=n.NearPlane.value/1e3);var s=1e3;void 0!==n.FarPlane&&(s=n.FarPlane.value/1e3);var u=window.innerWidth,c=window.innerHeight;void 0!==n.AspectWidth&&void 0!==n.AspectHeight&&(u=n.AspectWidth.value,c=n.AspectHeight.value);var l=u/c,p=45;void 0!==n.FieldOfView&&(p=n.FieldOfView.value);var h=n.FocalLength?n.FocalLength.value:null;switch(a){case 0:r=new i.PerspectiveCamera(p,l,o,s),null!==h&&r.setFocalLength(h);break;case 1:r=new i.OrthographicCamera(-u/2,u/2,c/2,-c/2,o,s);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+a+"."),r=new i.Object3D}}return r},createLight:function(t){var r,n;if(t.children.forEach((function(t){var r=e.Objects.NodeAttribute[t.ID];void 0!==r&&(n=r)})),void 0===n)r=new i.Object3D;else{var a;a=void 0===n.LightType?0:n.LightType.value;var o=16777215;void 0!==n.Color&&(o=(new i.Color).fromArray(n.Color.value));var s=void 0===n.Intensity?1:n.Intensity.value/100;void 0!==n.CastLightOnObject&&0===n.CastLightOnObject.value&&(s=0);var u=0;void 0!==n.FarAttenuationEnd&&(u=void 0!==n.EnableFarAttenuation&&0===n.EnableFarAttenuation.value?0:n.FarAttenuationEnd.value);switch(a){case 0:r=new i.PointLight(o,s,u,1);break;case 1:r=new i.DirectionalLight(o,s);break;case 2:var c=Math.PI/3;void 0!==n.InnerAngle&&(c=i.MathUtils.degToRad(n.InnerAngle.value));var l=0;void 0!==n.OuterAngle&&(l=i.MathUtils.degToRad(n.OuterAngle.value),l=Math.max(l,1)),r=new i.SpotLight(o,s,u,c,l,1);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),r=new i.PointLight(o,s)}void 0!==n.CastShadows&&1===n.CastShadows.value&&(r.castShadow=!0)}return r},createMesh:function(e,t,r){var n,a=null,o=null,s=[];return e.children.forEach((function(e){t.has(e.ID)&&(a=t.get(e.ID)),r.has(e.ID)&&s.push(r.get(e.ID))})),s.length>1?o=s:s.length>0?o=s[0]:(o=new i.MeshPhongMaterial({color:13421772}),s.push(o)),"color"in a.attributes&&s.forEach((function(e){e.vertexColors=!0})),a.FBX_Deformer?(s.forEach((function(e){e.skinning=!0})),(n=new i.SkinnedMesh(a,o)).normalizeSkinWeights()):n=new i.Mesh(a,o),n},createCurve:function(e,t){var r=e.children.reduce((function(e,r){return t.has(r.ID)&&(e=t.get(r.ID)),e}),null),n=new i.LineBasicMaterial({color:3342591,linewidth:1});return new i.Line(r,n)},getTransformData:function(e,t){var r={};"InheritType"in t&&(r.inheritType=parseInt(t.InheritType.value)),r.eulerOrder="RotationOrder"in t?E(t.RotationOrder.value):"ZYX","Lcl_Translation"in t&&(r.translation=t.Lcl_Translation.value),"PreRotation"in t&&(r.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(r.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(r.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(r.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(r.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(r.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(r.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(r.rotationPivot=t.RotationPivot.value),e.userData.transformData=r},setLookAtProperties:function(n,a){"LookAtProperty"in a&&t.get(n.ID).children.forEach((function(t){if("LookAtProperty"===t.relationship){var a=e.Objects.Model[t.ID];if("Lcl_Translation"in a){var o=a.Lcl_Translation.value;void 0!==n.target?(n.target.position.fromArray(o),r.add(n.target)):n.lookAt((new i.Vector3).fromArray(o))}}}))},bindSkeleton:function(e,r,n){var a=this.parsePoseNodes();for(var o in e){var s=e[o];t.get(parseInt(s.ID)).parents.forEach((function(e){if(r.has(e.ID)){var o=e.ID;t.get(o).parents.forEach((function(e){n.has(e.ID)&&n.get(e.ID).bind(new i.Skeleton(s.bones),a[e.ID])}))}}))}},parsePoseNodes:function(){var t={};if("Pose"in e.Objects){var r=e.Objects.Pose;for(var n in r)if("BindPose"===r[n].attrType){var a=r[n].PoseNode;Array.isArray(a)?a.forEach((function(e){t[e.Node]=(new i.Matrix4).fromArray(e.Matrix.a)})):t[a.Node]=(new i.Matrix4).fromArray(a.Matrix.a)}}return t},createAmbientLight:function(){if("GlobalSettings"in e&&"AmbientColor"in e.GlobalSettings){var t=e.GlobalSettings.AmbientColor.value,n=t[0],a=t[1],o=t[2];if(0!==n||0!==a||0!==o){var s=new i.Color(n,a,o);r.add(new i.AmbientLight(s,1))}}},setupMorphMaterials:function(){var e=this;r.traverse((function(t){t.isMesh&&t.geometry.morphAttributes.position&&t.geometry.morphAttributes.position.length&&(Array.isArray(t.material)?t.material.forEach((function(r,n){e.setupMorphMaterial(t,r,n)})):e.setupMorphMaterial(t,t.material))}))},setupMorphMaterial:function(e,t,n){var i=e.uuid,a=t.uuid,o=!1;if(r.traverse((function(e){e.isMesh&&(Array.isArray(e.material)?e.material.forEach((function(t){t.uuid===a&&e.uuid!==i&&(o=!0)})):e.material.uuid===a&&e.uuid!==i&&(o=!0))})),!0===o){var s=t.clone();s.morphTargets=!0,void 0===n?e.material=s:e.material[n]=s}else t.morphTargets=!0}},s.prototype={constructor:s,parse:function(r){var n=new Map;if("Geometry"in e.Objects){var i=e.Objects.Geometry;for(var a in i){var o=t.get(parseInt(a)),s=this.parseGeometry(o,i[a],r);n.set(parseInt(a),s)}}return n},parseGeometry:function(e,t,r){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,r);case"NurbsCurve":return this.parseNurbsGeometry(t)}},parseMeshGeometry:function(t,r,n){var i=n.skeletons,a=[],o=t.parents.map((function(t){return e.Objects.Model[t.ID]}));if(0!==o.length){var s=t.children.reduce((function(e,t){return void 0!==i[t.ID]&&(e=i[t.ID]),e}),null);t.children.forEach((function(e){void 0!==n.morphTargets[e.ID]&&a.push(n.morphTargets[e.ID])}));var u=o[0],c={};"RotationOrder"in u&&(c.eulerOrder=E(u.RotationOrder.value)),"InheritType"in u&&(c.inheritType=parseInt(u.InheritType.value)),"GeometricTranslation"in u&&(c.translation=u.GeometricTranslation.value),"GeometricRotation"in u&&(c.rotation=u.GeometricRotation.value),"GeometricScaling"in u&&(c.scale=u.GeometricScaling.value);var l=T(c);return this.genGeometry(r,s,a,l)}},genGeometry:function(e,t,r,n){var a=new i.BufferGeometry;e.attrName&&(a.name=e.attrName);var o=this.parseGeoNode(e,t),s=this.genBuffers(o),u=new i.Float32BufferAttribute(s.vertex,3);if(u.applyMatrix4(n),a.setAttribute("position",u),s.colors.length>0&&a.setAttribute("color",new i.Float32BufferAttribute(s.colors,3)),t&&(a.setAttribute("skinIndex",new i.Uint16BufferAttribute(s.weightsIndices,4)),a.setAttribute("skinWeight",new i.Float32BufferAttribute(s.vertexWeights,4)),a.FBX_Deformer=t),s.normal.length>0){var c=(new i.Matrix3).getNormalMatrix(n),l=new i.Float32BufferAttribute(s.normal,3);l.applyNormalMatrix(c),a.setAttribute("normal",l)}if(s.uvs.forEach((function(e,t){var r="uv"+(t+1).toString();0===t&&(r="uv"),a.setAttribute(r,new i.Float32BufferAttribute(s.uvs[t],2))})),o.material&&"AllSame"!==o.material.mappingType){var p=s.materialIndex[0],h=0;if(s.materialIndex.forEach((function(e,t){e!==p&&(a.addGroup(h,t-h,p),p=e,h=t)})),a.groups.length>0){var f=a.groups[a.groups.length-1],d=f.start+f.count;d!==s.materialIndex.length&&a.addGroup(d,s.materialIndex.length-d,p)}0===a.groups.length&&a.addGroup(0,s.materialIndex.length,s.materialIndex[0])}return this.addMorphTargets(a,e,r,n),a},parseGeoNode:function(e,t){var r={};if(r.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],r.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(r.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(r.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(r.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){r.uv=[];for(var n=0;e.LayerElementUV[n];)e.LayerElementUV[n].UV&&r.uv.push(this.parseUVs(e.LayerElementUV[n])),n++}return r.weightTable={},null!==t&&(r.skeleton=t,t.rawBones.forEach((function(e,t){e.indices.forEach((function(n,i){void 0===r.weightTable[n]&&(r.weightTable[n]=[]),r.weightTable[n].push({id:t,weight:e.weights[i]})}))}))),r},genBuffers:function(e){var t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},r=0,n=0,i=!1,a=[],o=[],s=[],u=[],c=[],l=[],p=this;return e.vertexIndices.forEach((function(h,f){var d=!1;h<0&&(h^=-1,d=!0);var m=[],g=[];if(a.push(3*h,3*h+1,3*h+2),e.color){var y=v(f,r,h,e.color);s.push(y[0],y[1],y[2])}if(e.skeleton){if(void 0!==e.weightTable[h]&&e.weightTable[h].forEach((function(e){g.push(e.weight),m.push(e.id)})),g.length>4){i||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),i=!0);var T=[0,0,0,0],E=[0,0,0,0];g.forEach((function(e,t){var r=e,n=m[t];E.forEach((function(e,t,i){if(r>e){i[t]=r,r=e;var a=T[t];T[t]=n,n=a}}))})),m=T,g=E}for(;g.length<4;)g.push(0),m.push(0);for(var A=0;A<4;++A)c.push(g[A]),l.push(m[A])}if(e.normal){y=v(f,r,h,e.normal);o.push(y[0],y[1],y[2])}if(e.material&&"AllSame"!==e.material.mappingType)var x=v(f,r,h,e.material)[0];e.uv&&e.uv.forEach((function(e,t){var n=v(f,r,h,e);void 0===u[t]&&(u[t]=[]),u[t].push(n[0]),u[t].push(n[1])})),n++,d&&(p.genFace(t,e,a,x,o,s,u,c,l,n),r++,n=0,a=[],o=[],s=[],u=[],c=[],l=[])})),t},genFace:function(e,t,r,n,i,a,o,s,u,c){for(var l=2;l<c;l++)e.vertex.push(t.vertexPositions[r[0]]),e.vertex.push(t.vertexPositions[r[1]]),e.vertex.push(t.vertexPositions[r[2]]),e.vertex.push(t.vertexPositions[r[3*(l-1)]]),e.vertex.push(t.vertexPositions[r[3*(l-1)+1]]),e.vertex.push(t.vertexPositions[r[3*(l-1)+2]]),e.vertex.push(t.vertexPositions[r[3*l]]),e.vertex.push(t.vertexPositions[r[3*l+1]]),e.vertex.push(t.vertexPositions[r[3*l+2]]),t.skeleton&&(e.vertexWeights.push(s[0]),e.vertexWeights.push(s[1]),e.vertexWeights.push(s[2]),e.vertexWeights.push(s[3]),e.vertexWeights.push(s[4*(l-1)]),e.vertexWeights.push(s[4*(l-1)+1]),e.vertexWeights.push(s[4*(l-1)+2]),e.vertexWeights.push(s[4*(l-1)+3]),e.vertexWeights.push(s[4*l]),e.vertexWeights.push(s[4*l+1]),e.vertexWeights.push(s[4*l+2]),e.vertexWeights.push(s[4*l+3]),e.weightsIndices.push(u[0]),e.weightsIndices.push(u[1]),e.weightsIndices.push(u[2]),e.weightsIndices.push(u[3]),e.weightsIndices.push(u[4*(l-1)]),e.weightsIndices.push(u[4*(l-1)+1]),e.weightsIndices.push(u[4*(l-1)+2]),e.weightsIndices.push(u[4*(l-1)+3]),e.weightsIndices.push(u[4*l]),e.weightsIndices.push(u[4*l+1]),e.weightsIndices.push(u[4*l+2]),e.weightsIndices.push(u[4*l+3])),t.color&&(e.colors.push(a[0]),e.colors.push(a[1]),e.colors.push(a[2]),e.colors.push(a[3*(l-1)]),e.colors.push(a[3*(l-1)+1]),e.colors.push(a[3*(l-1)+2]),e.colors.push(a[3*l]),e.colors.push(a[3*l+1]),e.colors.push(a[3*l+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(n),e.materialIndex.push(n),e.materialIndex.push(n)),t.normal&&(e.normal.push(i[0]),e.normal.push(i[1]),e.normal.push(i[2]),e.normal.push(i[3*(l-1)]),e.normal.push(i[3*(l-1)+1]),e.normal.push(i[3*(l-1)+2]),e.normal.push(i[3*l]),e.normal.push(i[3*l+1]),e.normal.push(i[3*l+2])),t.uv&&t.uv.forEach((function(t,r){void 0===e.uvs[r]&&(e.uvs[r]=[]),e.uvs[r].push(o[r][0]),e.uvs[r].push(o[r][1]),e.uvs[r].push(o[r][2*(l-1)]),e.uvs[r].push(o[r][2*(l-1)+1]),e.uvs[r].push(o[r][2*l]),e.uvs[r].push(o[r][2*l+1])}))},addMorphTargets:function(t,r,n,i){if(0!==n.length){t.morphTargetsRelative=!0,t.morphAttributes.position=[];var a=this;n.forEach((function(n){n.rawTargets.forEach((function(n){var o=e.Objects.Geometry[n.geoID];void 0!==o&&a.genMorphGeometry(t,r,o,i,n.name)}))}))}},genMorphGeometry:function(e,t,r,n,a){for(var o=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],s=void 0!==r.Vertices?r.Vertices.a:[],u=void 0!==r.Indexes?r.Indexes.a:[],c=3*e.attributes.position.count,l=new Float32Array(c),p=0;p<u.length;p++){var h=3*u[p];l[h]=s[3*p],l[h+1]=s[3*p+1],l[h+2]=s[3*p+2]}var f={vertexIndices:o,vertexPositions:l},d=this.genBuffers(f),m=new i.Float32BufferAttribute(d.vertex,3);m.name=a||r.attrName,m.applyMatrix4(n),e.morphAttributes.position.push(m)},parseNormals:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.Normals.a,i=[];return"IndexToDirect"===r&&("NormalIndex"in e?i=e.NormalIndex.a:"NormalsIndex"in e&&(i=e.NormalsIndex.a)),{dataSize:3,buffer:n,indices:i,mappingType:t,referenceType:r}},parseUVs:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.UV.a,i=[];return"IndexToDirect"===r&&(i=e.UVIndex.a),{dataSize:2,buffer:n,indices:i,mappingType:t,referenceType:r}},parseVertexColors:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.Colors.a,i=[];return"IndexToDirect"===r&&(i=e.ColorIndex.a),{dataSize:4,buffer:n,indices:i,mappingType:t,referenceType:r}},parseMaterialIndices:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:r};for(var n=e.Materials.a,i=[],a=0;a<n.length;++a)i.push(a);return{dataSize:1,buffer:n,indices:i,mappingType:t,referenceType:r}},parseNurbsGeometry:function(e){if(void 0===Nt)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new i.BufferGeometry;var t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new i.BufferGeometry;for(var r,n,a=t-1,o=e.KnotVector.a,s=[],u=e.Points.a,c=0,l=u.length;c<l;c+=4)s.push((new i.Vector4).fromArray(u,c));if("Closed"===e.Form)s.push(s[0]);else if("Periodic"===e.Form){r=a,n=o.length-1-r;for(c=0;c<a;++c)s.push(s[c])}var p=new Nt(a,o,s,r,n).getPoints(7*s.length),h=new Float32Array(3*p.length);p.forEach((function(e,t){e.toArray(h,3*t)}));var f=new i.BufferGeometry;return f.setAttribute("position",new i.BufferAttribute(h,3)),f}},u.prototype={constructor:u,parse:function(){var e=[],t=this.parseClips();if(void 0!==t)for(var r in t){var n=t[r],i=this.addClip(n);e.push(i)}return e},parseClips:function(){if(void 0!==e.Objects.AnimationCurve){var t=this.parseAnimationCurveNodes();this.parseAnimationCurves(t);var r=this.parseAnimationLayers(t);return this.parseAnimStacks(r)}},parseAnimationCurveNodes:function(){var t=e.Objects.AnimationCurveNode,r=new Map;for(var n in t){var i=t[n];if(null!==i.attrName.match(/S|R|T|DeformPercent/)){var a={id:i.id,attr:i.attrName,curves:{}};r.set(a.id,a)}}return r},parseAnimationCurves:function(r){var n=e.Objects.AnimationCurve;for(var i in n){var a={id:n[i].id,times:n[i].KeyTime.a.map(d),values:n[i].KeyValueFloat.a},o=t.get(a.id);if(void 0!==o){var s=o.parents[0].ID,u=o.parents[0].relationship;u.match(/X/)?r.get(s).curves.x=a:u.match(/Y/)?r.get(s).curves.y=a:u.match(/Z/)?r.get(s).curves.z=a:u.match(/d|DeformPercent/)&&r.has(s)&&(r.get(s).curves.morph=a)}}},parseAnimationLayers:function(n){var a=e.Objects.AnimationLayer,o=new Map;for(var s in a){var u=[],c=t.get(parseInt(s));if(void 0!==c)c.children.forEach((function(a,o){if(n.has(a.ID)){var s=n.get(a.ID);if(void 0!==s.curves.x||void 0!==s.curves.y||void 0!==s.curves.z){if(void 0===u[o])if(void 0!==(d=t.get(a.ID).parents.filter((function(e){return void 0!==e.relationship}))[0].ID)){if(void 0===(l=e.Objects.Model[d.toString()]))return void console.warn("THREE.FBXLoader: Encountered a unused curve.",a);var c={modelName:l.attrName?i.PropertyBinding.sanitizeNodeName(l.attrName):"",ID:l.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};r.traverse((function(e){e.ID===l.id&&(c.transform=e.matrix,e.userData.transformData&&(c.eulerOrder=e.userData.transformData.eulerOrder))})),c.transform||(c.transform=new i.Matrix4),"PreRotation"in l&&(c.preRotation=l.PreRotation.value),"PostRotation"in l&&(c.postRotation=l.PostRotation.value),u[o]=c}u[o]&&(u[o][s.attr]=s)}else if(void 0!==s.curves.morph){if(void 0===u[o]){var l,p=t.get(a.ID).parents.filter((function(e){return void 0!==e.relationship}))[0].ID,h=t.get(p).parents[0].ID,f=t.get(h).parents[0].ID,d=t.get(f).parents[0].ID;c={modelName:(l=e.Objects.Model[d]).attrName?i.PropertyBinding.sanitizeNodeName(l.attrName):"",morphName:e.Objects.Deformer[p].attrName};u[o]=c}u[o][s.attr]=s}}})),o.set(parseInt(s),u)}return o},parseAnimStacks:function(r){var n=e.Objects.AnimationStack,i={};for(var a in n){var o=t.get(parseInt(a)).children;o.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var s=r.get(o[0].ID);i[a]={name:n[a].attrName,layer:s}}return i},addClip:function(e){var t=[],r=this;return e.layer.forEach((function(e){t=t.concat(r.generateTracks(e))})),new i.AnimationClip(e.name,-1,t)},generateTracks:function(e){var t=[],r=new i.Vector3,n=new i.Quaternion,a=new i.Vector3;if(e.transform&&e.transform.decompose(r,n,a),r=r.toArray(),n=(new i.Euler).setFromQuaternion(n,e.eulerOrder).toArray(),a=a.toArray(),void 0!==e.T&&Object.keys(e.T.curves).length>0){var o=this.generateVectorTrack(e.modelName,e.T.curves,r,"position");void 0!==o&&t.push(o)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){var s=this.generateRotationTrack(e.modelName,e.R.curves,n,e.preRotation,e.postRotation,e.eulerOrder);void 0!==s&&t.push(s)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){var u=this.generateVectorTrack(e.modelName,e.S.curves,a,"scale");void 0!==u&&t.push(u)}if(void 0!==e.DeformPercent){var c=this.generateMorphTrack(e);void 0!==c&&t.push(c)}return t},generateVectorTrack:function(e,t,r,n){var a=this.getTimesForAllAxes(t),o=this.getKeyframeTrackValues(a,t,r);return new i.VectorKeyframeTrack(e+"."+n,a,o)},generateRotationTrack:function(e,t,r,n,a,o){void 0!==t.x&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(i.MathUtils.degToRad)),void 0!==t.y&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(i.MathUtils.degToRad)),void 0!==t.z&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(i.MathUtils.degToRad));var s=this.getTimesForAllAxes(t),u=this.getKeyframeTrackValues(s,t,r);void 0!==n&&((n=n.map(i.MathUtils.degToRad)).push(o),n=(new i.Euler).fromArray(n),n=(new i.Quaternion).setFromEuler(n)),void 0!==a&&((a=a.map(i.MathUtils.degToRad)).push(o),a=(new i.Euler).fromArray(a),a=(new i.Quaternion).setFromEuler(a).invert());for(var c=new i.Quaternion,l=new i.Euler,p=[],h=0;h<u.length;h+=3)l.set(u[h],u[h+1],u[h+2],o),c.setFromEuler(l),void 0!==n&&c.premultiply(n),void 0!==a&&c.multiply(a),c.toArray(p,h/3*4);return new i.QuaternionKeyframeTrack(e+".quaternion",s,p)},generateMorphTrack:function(e){var t=e.DeformPercent.curves.morph,n=t.values.map((function(e){return e/100})),a=r.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new i.NumberKeyframeTrack(e.modelName+".morphTargetInfluences["+a+"]",t.times,n)},getTimesForAllAxes:function(e){var t=[];if(void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),(t=t.sort((function(e,t){return e-t}))).length>1){for(var r=1,n=t[0],i=1;i<t.length;i++){var a=t[i];a!==n&&(t[r]=a,n=a,r++)}t=t.slice(0,r)}return t},getKeyframeTrackValues:function(e,t,r){var n=r,i=[],a=-1,o=-1,s=-1;return e.forEach((function(e){if(t.x&&(a=t.x.times.indexOf(e)),t.y&&(o=t.y.times.indexOf(e)),t.z&&(s=t.z.times.indexOf(e)),-1!==a){var r=t.x.values[a];i.push(r),n[0]=r}else i.push(n[0]);if(-1!==o){var u=t.y.values[o];i.push(u),n[1]=u}else i.push(n[1]);if(-1!==s){var c=t.z.values[s];i.push(c),n[2]=c}else i.push(n[2])})),i},interpolateRotations:function(e){for(var t=1;t<e.values.length;t++){var r=e.values[t-1],n=e.values[t]-r,i=Math.abs(n);if(i>=180){for(var a=i/180,o=n/a,s=r+o,u=e.times[t-1],c=(e.times[t]-u)/a,l=u+c,p=[],h=[];l<e.times[t];)p.push(l),l+=c,h.push(s),s+=o;e.times=b(e.times,t,p),e.values=b(e.values,t,h)}}}},c.prototype={constructor:c,getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(e){this.nodeStack.push(e),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(e,t){this.currentProp=e,this.currentPropName=t},parse:function(e){this.currentIndent=0,this.allNodes=new h,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var t=this,r=e.split(/[\r\n]+/);return r.forEach((function(e,n){var i=e.match(/^[\s\t]*;/),a=e.match(/^[\s\t]*$/);if(!i&&!a){var o=e.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),s=e.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),u=e.match("^\\t{"+(t.currentIndent-1)+"}}");o?t.parseNodeBegin(e,o):s?t.parseNodeProperty(e,s,r[++n]):u?t.popStack():e.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(e)}})),this.allNodes},parseNodeBegin:function(e,t){var r=t[1].trim().replace(/^"/,"").replace(/"$/,""),n=t[2].split(",").map((function(e){return e.trim().replace(/^"/,"").replace(/"$/,"")})),i={name:r},a=this.parseNodeAttr(n),o=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(r,i):r in o?("PoseNode"===r?o.PoseNode.push(i):void 0!==o[r].id&&(o[r]={},o[r][o[r].id]=o[r]),""!==a.id&&(o[r][a.id]=i)):"number"===typeof a.id?(o[r]={},o[r][a.id]=i):"Properties70"!==r&&(o[r]="PoseNode"===r?[i]:i),"number"===typeof a.id&&(i.id=a.id),""!==a.name&&(i.attrName=a.name),""!==a.type&&(i.attrType=a.type),this.pushStack(i)},parseNodeAttr:function(e){var t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));var r="",n="";return e.length>1&&(r=e[1].replace(/^(\w+)::/,""),n=e[2]),{id:t,name:r,type:n}},parseNodeProperty:function(e,t,r){var n=t[1].replace(/^"/,"").replace(/"$/,"").trim(),i=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===n&&","===i&&(i=r.replace(/"/g,"").replace(/,$/,"").trim());var a=this.getCurrentNode();if("Properties70"!==a.name){if("C"===n){var o=i.split(",").slice(1),s=parseInt(o[0]),u=parseInt(o[1]),c=i.split(",").slice(3);n="connections",function(e,t){for(var r=0,n=e.length,i=t.length;r<i;r++,n++)e[n]=t[r]}(i=[s,u],c=c.map((function(e){return e.trim().replace(/^"/,"")}))),void 0===a[n]&&(a[n]=[])}"Node"===n&&(a.id=i),n in a&&Array.isArray(a[n])?a[n].push(i):"a"!==n?a[n]=i:a.a=i,this.setCurrentProp(a,n),"a"===n&&","!==i.slice(-1)&&(a.a=A(i))}else this.parseNodeSpecialProperty(e,n,i)},parseNodePropertyContinued:function(e){var t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=A(t.a))},parseNodeSpecialProperty:function(e,t,r){var n=r.split('",').map((function(e){return e.trim().replace(/^\"/,"").replace(/\s/,"_")})),i=n[0],a=n[1],o=n[2],s=n[3],u=n[4];switch(a){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":u=parseFloat(u);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":u=A(u)}this.getPrevNode()[i]={type:a,type2:o,flag:s,value:u},this.setCurrentProp(this.getPrevNode(),i)}},l.prototype={constructor:l,parse:function(e){var t=new p(e);t.skip(23);var r=t.getUint32();if(r<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+r);for(var n=new h;!this.endOfContent(t);){var i=this.parseNode(t,r);null!==i&&n.add(i.name,i)}return n},endOfContent:function(e){return e.size()%16===0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()},parseNode:function(e,t){var r={},n=t>=7500?e.getUint64():e.getUint32(),i=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();var a=e.getUint8(),o=e.getString(a);if(0===n)return null;for(var s=[],u=0;u<i;u++)s.push(this.parseProperty(e));var c=s.length>0?s[0]:"",l=s.length>1?s[1]:"",p=s.length>2?s[2]:"";for(r.singleProperty=1===i&&e.getOffset()===n;n>e.getOffset();){var h=this.parseNode(e,t);null!==h&&this.parseSubNode(o,r,h)}return r.propertyList=s,"number"===typeof c&&(r.id=c),""!==l&&(r.attrName=l),""!==p&&(r.attrType=p),""!==o&&(r.name=o),r},parseSubNode:function(e,t,r){if(!0===r.singleProperty){var n=r.propertyList[0];Array.isArray(n)?(t[r.name]=r,r.a=n):t[r.name]=n}else if("Connections"===e&&"C"===r.name){var i=[];r.propertyList.forEach((function(e,t){0!==t&&i.push(e)})),void 0===t.connections&&(t.connections=[]),t.connections.push(i)}else if("Properties70"===r.name){Object.keys(r).forEach((function(e){t[e]=r[e]}))}else if("Properties70"===e&&"P"===r.name){var a,o=r.propertyList[0],s=r.propertyList[1],u=r.propertyList[2],c=r.propertyList[3];0===o.indexOf("Lcl ")&&(o=o.replace("Lcl ","Lcl_")),0===s.indexOf("Lcl ")&&(s=s.replace("Lcl ","Lcl_")),a="Color"===s||"ColorRGB"===s||"Vector"===s||"Vector3D"===s||0===s.indexOf("Lcl_")?[r.propertyList[4],r.propertyList[5],r.propertyList[6]]:r.propertyList[4],t[o]={type:s,type2:u,flag:c,value:a}}else void 0===t[r.name]?"number"===typeof r.id?(t[r.name]={},t[r.name][r.id]=r):t[r.name]=r:"PoseNode"===r.name?(Array.isArray(t[r.name])||(t[r.name]=[t[r.name]]),t[r.name].push(r)):void 0===t[r.name][r.id]&&(t[r.name][r.id]=r)},parseProperty:function(e){var t=e.getString(1);switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":var r=e.getUint32();return e.getArrayBuffer(r);case"S":r=e.getUint32();return e.getString(r);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var i=e.getUint32(),a=e.getUint32(),o=e.getUint32();if(0===a)switch(t){case"b":case"c":return e.getBooleanArray(i);case"d":return e.getFloat64Array(i);case"f":return e.getFloat32Array(i);case"i":return e.getInt32Array(i);case"l":return e.getInt64Array(i)}"undefined"===typeof n&&console.error("THREE.FBXLoader: External library fflate.min.js required.");var s=new p(We(new Uint8Array(e.getArrayBuffer(o))).buffer);switch(t){case"b":case"c":return s.getBooleanArray(i);case"d":return s.getFloat64Array(i);case"f":return s.getFloat32Array(i);case"i":return s.getInt32Array(i);case"l":return s.getInt64Array(i)}default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}},p.prototype={constructor:p,getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(e){this.offset+=e},getBoolean:function(){return 1===(1&this.getUint8())},getBooleanArray:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getBoolean());return t},getUint8:function(){var e=this.dv.getUint8(this.offset);return this.offset+=1,e},getInt16:function(){var e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e},getInt32:function(){var e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e},getInt32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt32());return t},getUint32:function(){var e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e},getInt64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,4294967295===(e=4294967295&~e)&&(t=t+1&4294967295),-(4294967296*t+(e=e+1&4294967295))):4294967296*t+e},getInt64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt64());return t},getUint64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e},getFloat32:function(){var e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e},getFloat32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat32());return t},getFloat64:function(){var e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},getFloat64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat64());return t},getArrayBuffer:function(e){var t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t},getString:function(e){for(var t=[],r=0;r<e;r++)t[r]=this.getUint8();var n=t.indexOf(0);return n>=0&&(t=t.slice(0,n)),i.LoaderUtils.decodeText(new Uint8Array(t))}},h.prototype={constructor:h,add:function(e,t){this[e]=t}};var m=[];function v(e,t,r,n){var i;switch(n.mappingType){case"ByPolygonVertex":i=e;break;case"ByPolygon":i=t;break;case"ByVertice":i=r;break;case"AllSame":i=n.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+n.mappingType)}"IndexToDirect"===n.referenceType&&(i=n.indices[i]);var a=i*n.dataSize,o=a+n.dataSize;return function(e,t,r,n){for(var i=r,a=0;i<n;i++,a++)e[a]=t[i];return e}(m,n.buffer,a,o)}var g=new i.Euler,y=new i.Vector3;function T(e){var t,r=new i.Matrix4,n=new i.Matrix4,a=new i.Matrix4,o=new i.Matrix4,s=new i.Matrix4,u=new i.Matrix4,c=new i.Matrix4,l=new i.Matrix4,p=new i.Matrix4,h=new i.Matrix4,f=new i.Matrix4,d=new i.Matrix4,m=e.inheritType?e.inheritType:0;(e.translation&&r.setPosition(y.fromArray(e.translation)),e.preRotation)&&((t=e.preRotation.map(i.MathUtils.degToRad)).push(e.eulerOrder),n.makeRotationFromEuler(g.fromArray(t)));e.rotation&&((t=e.rotation.map(i.MathUtils.degToRad)).push(e.eulerOrder),a.makeRotationFromEuler(g.fromArray(t)));e.postRotation&&((t=e.postRotation.map(i.MathUtils.degToRad)).push(e.eulerOrder),o.makeRotationFromEuler(g.fromArray(t)),o.invert());e.scale&&s.scale(y.fromArray(e.scale)),e.scalingOffset&&c.setPosition(y.fromArray(e.scalingOffset)),e.scalingPivot&&u.setPosition(y.fromArray(e.scalingPivot)),e.rotationOffset&&l.setPosition(y.fromArray(e.rotationOffset)),e.rotationPivot&&p.setPosition(y.fromArray(e.rotationPivot)),e.parentMatrixWorld&&(f.copy(e.parentMatrix),h.copy(e.parentMatrixWorld));var v=(new i.Matrix4).copy(n).multiply(a).multiply(o),T=new i.Matrix4;T.extractRotation(h);var E=new i.Matrix4;E.copyPosition(h);var A=new i.Matrix4,x=(new i.Matrix4).copy(E).invert().multiply(h);A.copy(T).invert().multiply(x);var b=s,R=new i.Matrix4;if(0===m)R.copy(T).multiply(v).multiply(A).multiply(b);else if(1===m)R.copy(T).multiply(A).multiply(v).multiply(b);else{var w=(new i.Matrix4).scale((new i.Vector3).setFromMatrixScale(f)),N=(new i.Matrix4).copy(w).invert(),S=(new i.Matrix4).copy(A).multiply(N);R.copy(T).multiply(v).multiply(S).multiply(b)}var k=new i.Matrix4;k.copy(p).invert();var _=new i.Matrix4;_.copy(u).invert();var L=new i.Matrix4;L.copy(r).multiply(l).multiply(p).multiply(n).multiply(a).multiply(o).multiply(k).multiply(c).multiply(u).multiply(s).multiply(_);var I=(new i.Matrix4).copyPosition(L),O=(new i.Matrix4).copy(h).multiply(I);return d.copyPosition(O),(L=(new i.Matrix4).copy(d).multiply(R)).premultiply(h.invert()),L}function E(e){var t=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(e=e||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),t[0]):t[e]}function A(e){return e.split(",").map((function(e){return parseFloat(e)}))}function x(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=e.byteLength),i.LoaderUtils.decodeText(new Uint8Array(e,t,r))}function b(e,t,r){return e.slice(0,t).concat(r).concat(e.slice(t))}return a}()},7047:function(e,t,r){"use strict";r.d(t,{E:function(){return i}});var n=r(2212),i=function(){function e(e){n.Loader.call(this,e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new o(e)})),this.register((function(e){return new u(e)})),this.register((function(e){return new c(e)})),this.register((function(e){return new s(e)})),this.register((function(e){return new i(e)})),this.register((function(e){return new l(e)}))}function t(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype=Object.assign(Object.create(n.Loader.prototype),{constructor:e,load:function(e,t,r,i){var a,o=this;a=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:n.LoaderUtils.extractUrlBase(e),this.manager.itemStart(e);var s=function(t){i?i(t):console.error(t),o.manager.itemError(e),o.manager.itemEnd(e)},u=new n.FileLoader(this.manager);u.setPath(this.path),u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(e,(function(r){try{o.parse(r,a,(function(r){t(r),o.manager.itemEnd(e)}),s)}catch(n){s(n)}}),r,s)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')},setKTX2Loader:function(e){return this.ktx2Loader=e,this},setMeshoptDecoder:function(e){return this.meshoptDecoder=e,this},register:function(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this},unregister:function(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this},parse:function(e,t,i,o){var s,u={},c={};if("string"===typeof e)s=e;else if(n.LoaderUtils.decodeText(new Uint8Array(e,0,4))===p){try{u[r.KHR_BINARY_GLTF]=new d(e)}catch(x){return void(o&&o(x))}s=u[r.KHR_BINARY_GLTF].content}else s=n.LoaderUtils.decodeText(new Uint8Array(e));var l=JSON.parse(s);if(void 0===l.asset||l.asset.version[0]<2)o&&o(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{var h=new z(l,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});h.fileLoader.setRequestHeader(this.requestHeader);for(var f=0;f<this.pluginCallbacks.length;f++){var g=this.pluginCallbacks[f](h);c[g.name]=g,u[g.name]=!0}if(l.extensionsUsed)for(f=0;f<l.extensionsUsed.length;++f){var E=l.extensionsUsed[f],A=l.extensionsRequired||[];switch(E){case r.KHR_MATERIALS_UNLIT:u[E]=new a;break;case r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:u[E]=new y;break;case r.KHR_DRACO_MESH_COMPRESSION:u[E]=new m(l,this.dracoLoader);break;case r.KHR_TEXTURE_TRANSFORM:u[E]=new v;break;case r.KHR_MESH_QUANTIZATION:u[E]=new T;break;default:A.indexOf(E)>=0&&void 0===c[E]&&console.warn('THREE.GLTFLoader: Unknown extension "'+E+'".')}}h.setExtensions(u),h.setPlugins(c),h.parse(i,o)}}});var r={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};function i(e){this.parser=e,this.name=r.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}function a(){this.name=r.KHR_MATERIALS_UNLIT}function o(e){this.parser=e,this.name=r.KHR_MATERIALS_CLEARCOAT}function s(e){this.parser=e,this.name=r.KHR_MATERIALS_TRANSMISSION}function u(e){this.parser=e,this.name=r.KHR_TEXTURE_BASISU}function c(e){this.parser=e,this.name=r.EXT_TEXTURE_WEBP,this.isSupported=null}function l(e){this.name=r.EXT_MESHOPT_COMPRESSION,this.parser=e}i.prototype._markDefs=function(){for(var e=this.parser,t=this.parser.json.nodes||[],r=0,n=t.length;r<n;r++){var i=t[r];i.extensions&&i.extensions[this.name]&&void 0!==i.extensions[this.name].light&&e._addNodeRef(this.cache,i.extensions[this.name].light)}},i.prototype._loadLight=function(e){var t=this.parser,r="light:"+e,i=t.cache.get(r);if(i)return i;var a,o=t.json,s=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e],u=new n.Color(16777215);void 0!==s.color&&u.fromArray(s.color);var c=void 0!==s.range?s.range:0;switch(s.type){case"directional":(a=new n.DirectionalLight(u)).target.position.set(0,0,-1),a.add(a.target);break;case"point":(a=new n.PointLight(u)).distance=c;break;case"spot":(a=new n.SpotLight(u)).distance=c,s.spot=s.spot||{},s.spot.innerConeAngle=void 0!==s.spot.innerConeAngle?s.spot.innerConeAngle:0,s.spot.outerConeAngle=void 0!==s.spot.outerConeAngle?s.spot.outerConeAngle:Math.PI/4,a.angle=s.spot.outerConeAngle,a.penumbra=1-s.spot.innerConeAngle/s.spot.outerConeAngle,a.target.position.set(0,0,-1),a.add(a.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+s.type)}return a.position.set(0,0,0),a.decay=2,void 0!==s.intensity&&(a.intensity=s.intensity),a.name=t.createUniqueName(s.name||"light_"+e),i=Promise.resolve(a),t.cache.add(r,i),i},i.prototype.createNodeAttachment=function(e){var t=this,r=this.parser,n=r.json.nodes[e],i=(n.extensions&&n.extensions[this.name]||{}).light;return void 0===i?null:this._loadLight(i).then((function(e){return r._getNodeRef(t.cache,i,e)}))},a.prototype.getMaterialType=function(){return n.MeshBasicMaterial},a.prototype.extendParams=function(e,t,r){var i=[];e.color=new n.Color(1,1,1),e.opacity=1;var a=t.pbrMetallicRoughness;if(a){if(Array.isArray(a.baseColorFactor)){var o=a.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==a.baseColorTexture&&i.push(r.assignTexture(e,"map",a.baseColorTexture))}return Promise.all(i)},o.prototype.getMaterialType=function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.MeshPhysicalMaterial:null},o.prototype.extendMaterialParams=function(e,t){var r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();var a=[],o=i.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&a.push(r.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&a.push(r.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(a.push(r.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){var s=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new n.Vector2(s,-s)}return Promise.all(a)},s.prototype.getMaterialType=function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.MeshPhysicalMaterial:null},s.prototype.extendMaterialParams=function(e,t){var r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();var i=[],a=n.extensions[this.name];return void 0!==a.transmissionFactor&&(t.transmission=a.transmissionFactor),void 0!==a.transmissionTexture&&i.push(r.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(i)},u.prototype.loadTexture=function(e){var t=this.parser,r=t.json,n=r.textures[e];if(!n.extensions||!n.extensions[this.name])return null;var i=n.extensions[this.name],a=r.images[i.source],o=t.options.ktx2Loader;if(!o){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,a,o)},c.prototype.loadTexture=function(e){var t=this.name,r=this.parser,n=r.json,i=n.textures[e];if(!i.extensions||!i.extensions[t])return null;var a=i.extensions[t],o=n.images[a.source],s=r.textureLoader;if(o.uri){var u=r.options.manager.getHandler(o.uri);null!==u&&(s=u)}return this.detectSupport().then((function(i){if(i)return r.loadTextureImage(e,o,s);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)}))},c.prototype.detectSupport=function(){return this.isSupported||(this.isSupported=new Promise((function(e){var t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported},l.prototype.loadBufferView=function(e){var t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){var n=r.extensions[this.name],i=this.parser.getDependency("buffer",n.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([i,a.ready]).then((function(e){var t=n.byteOffset||0,r=n.byteLength||0,i=n.count,o=n.byteStride,s=new ArrayBuffer(i*o),u=new Uint8Array(e[0],t,r);return a.decodeGltfBuffer(new Uint8Array(s),i,o,u,n.mode,n.filter),s}))}return null};var p="glTF",h=1313821514,f=5130562;function d(e){this.name=r.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,12);if(this.header={magic:n.LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==p)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var i=this.header.length-12,a=new DataView(e,12),o=0;o<i;){var s=a.getUint32(o,!0);o+=4;var u=a.getUint32(o,!0);if(o+=4,u===h){var c=new Uint8Array(e,12+o,s);this.content=n.LoaderUtils.decodeText(c)}else if(u===f){var l=12+o;this.body=e.slice(l,l+s)}o+=s}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function m(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=r.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}function v(){this.name=r.KHR_TEXTURE_TRANSFORM}function g(e){n.MeshStandardMaterial.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),r=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),i=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),a=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),o=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),s={specular:{value:(new n.Color).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=s,this.onBeforeCompile=function(e){for(var n in s)e.uniforms[n]=s[n];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",r).replace("#include <roughnessmap_fragment>",i).replace("#include <metalnessmap_fragment>",a).replace("#include <lights_physical_fragment>",o)},Object.defineProperties(this,{specular:{get:function(){return s.specular.value},set:function(e){s.specular.value=e}},specularMap:{get:function(){return s.specularMap.value},set:function(e){s.specularMap.value=e,e?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return s.glossiness.value},set:function(e){s.glossiness.value=e}},glossinessMap:{get:function(){return s.glossinessMap.value},set:function(e){s.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}function y(){return{name:r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return g},extendParams:function(e,t,r){var i=t.extensions[this.name];e.color=new n.Color(1,1,1),e.opacity=1;var a=[];if(Array.isArray(i.diffuseFactor)){var o=i.diffuseFactor;e.color.fromArray(o),e.opacity=o[3]}if(void 0!==i.diffuseTexture&&a.push(r.assignTexture(e,"map",i.diffuseTexture)),e.emissive=new n.Color(0,0,0),e.glossiness=void 0!==i.glossinessFactor?i.glossinessFactor:1,e.specular=new n.Color(1,1,1),Array.isArray(i.specularFactor)&&e.specular.fromArray(i.specularFactor),void 0!==i.specularGlossinessTexture){var s=i.specularGlossinessTexture;a.push(r.assignTexture(e,"glossinessMap",s)),a.push(r.assignTexture(e,"specularMap",s))}return Promise.all(a)},createMaterial:function(e){var t=new g(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=n.TangentSpaceNormalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}}function T(){this.name=r.KHR_MESH_QUANTIZATION}function E(e,t,r,i){n.Interpolant.call(this,e,t,r,i)}m.prototype.decodePrimitive=function(e,t){var r=this.json,n=this.dracoLoader,i=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,o={},s={},u={};for(var c in a){var l=O[c]||c.toLowerCase();o[l]=a[c]}for(c in e.attributes){l=O[c]||c.toLowerCase();if(void 0!==a[c]){var p=r.accessors[e.attributes[c]],h=k[p.componentType];u[l]=h,s[l]=!0===p.normalized}}return t.getDependency("bufferView",i).then((function(e){return new Promise((function(t){n.decodeDracoFile(e,(function(e){for(var r in e.attributes){var n=e.attributes[r],i=s[r];void 0!==i&&(n.normalized=i)}t(e)}),o,u)}))}))},v.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},g.prototype=Object.create(n.MeshStandardMaterial.prototype),g.prototype.constructor=g,g.prototype.copy=function(e){return n.MeshStandardMaterial.prototype.copy.call(this,e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},E.prototype=Object.create(n.Interpolant.prototype),E.prototype.constructor=E,E.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n*3+n,a=0;a!==n;a++)t[a]=r[i+a];return t},E.prototype.beforeStart_=E.prototype.copySampleValue_,E.prototype.afterEnd_=E.prototype.copySampleValue_,E.prototype.interpolate_=function(e,t,r,n){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=2*o,u=3*o,c=n-t,l=(r-t)/c,p=l*l,h=p*l,f=e*u,d=f-u,m=-2*h+3*p,v=h-p,g=1-m,y=v-p+l,T=0;T!==o;T++){var E=a[d+T+o],A=a[d+T+s]*c,x=a[f+T+o],b=a[f+T]*c;i[T]=g*E+y*A+m*x+v*b}return i};var A=0,x=1,b=2,R=3,w=4,N=5,S=6,k={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},_={9728:n.NearestFilter,9729:n.LinearFilter,9984:n.NearestMipmapNearestFilter,9985:n.LinearMipmapNearestFilter,9986:n.NearestMipmapLinearFilter,9987:n.LinearMipmapLinearFilter},L={33071:n.ClampToEdgeWrapping,33648:n.MirroredRepeatWrapping,10497:n.RepeatWrapping},I={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},O={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},M={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},C={CUBICSPLINE:void 0,LINEAR:n.InterpolateLinear,STEP:n.InterpolateDiscrete},P="OPAQUE",F="MASK",U="BLEND";function D(e,t){return"string"!==typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}function B(e,t,r){for(var n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])}function V(e,t){void 0!==t.extras&&("object"===typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function j(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){var i=t.extras.targetNames;if(e.morphTargetInfluences.length===i.length){e.morphTargetDictionary={};for(r=0,n=i.length;r<n;r++)e.morphTargetDictionary[i[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function G(e){var t=e.extensions&&e.extensions[r.KHR_DRACO_MESH_COMPRESSION];return t?"draco:"+t.bufferView+":"+t.indices+":"+H(t.attributes):e.indices+":"+H(e.attributes)+":"+e.mode}function H(e){for(var t="",r=Object.keys(e).sort(),n=0,i=r.length;n<i;n++)t+=r[n]+":"+e[r[n]]+";";return t}function z(e,r){this.json=e||{},this.extensions={},this.plugins={},this.options=r||{},this.cache=new t,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},"undefined"!==typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new n.ImageBitmapLoader(this.options.manager):this.textureLoader=new n.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new n.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function W(e,t,r){var i=t.attributes,a=[];function o(t,n){return r.getDependency("accessor",t).then((function(t){e.setAttribute(n,t)}))}for(var s in i){var u=O[s]||s.toLowerCase();u in e.attributes||a.push(o(i[s],u))}if(void 0!==t.indices&&!e.index){var c=r.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));a.push(c)}return V(e,t),function(e,t,r){var i=t.attributes,a=new n.Box3;if(void 0!==i.POSITION){var o=(f=r.json.accessors[i.POSITION]).min,s=f.max;if(void 0!==o&&void 0!==s){a.set(new n.Vector3(o[0],o[1],o[2]),new n.Vector3(s[0],s[1],s[2]));var u=t.targets;if(void 0!==u){for(var c=new n.Vector3,l=new n.Vector3,p=0,h=u.length;p<h;p++){var f,d=u[p];if(void 0!==d.POSITION)o=(f=r.json.accessors[d.POSITION]).min,s=f.max,void 0!==o&&void 0!==s?(l.setX(Math.max(Math.abs(o[0]),Math.abs(s[0]))),l.setY(Math.max(Math.abs(o[1]),Math.abs(s[1]))),l.setZ(Math.max(Math.abs(o[2]),Math.abs(s[2]))),c.max(l)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}a.expandByVector(c)}e.boundingBox=a;var m=new n.Sphere;a.getCenter(m.center),m.radius=a.min.distanceTo(a.max)/2,e.boundingSphere=m}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(e,t,r),Promise.all(a).then((function(){return void 0!==t.targets?function(e,t,r){for(var n=!1,i=!1,a=0,o=t.length;a<o&&(void 0!==(c=t[a]).POSITION&&(n=!0),void 0!==c.NORMAL&&(i=!0),!n||!i);a++);if(!n&&!i)return Promise.resolve(e);var s=[],u=[];for(a=0,o=t.length;a<o;a++){var c=t[a];if(n){var l=void 0!==c.POSITION?r.getDependency("accessor",c.POSITION):e.attributes.position;s.push(l)}i&&(l=void 0!==c.NORMAL?r.getDependency("accessor",c.NORMAL):e.attributes.normal,u.push(l))}return Promise.all([Promise.all(s),Promise.all(u)]).then((function(t){var r=t[0],a=t[1];return n&&(e.morphAttributes.position=r),i&&(e.morphAttributes.normal=a),e.morphTargetsRelative=!0,e}))}(e,t.targets,r):e}))}function K(e,t){var r=e.getIndex();if(null===r){var i=[],a=e.getAttribute("position");if(void 0===a)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var o=0;o<a.count;o++)i.push(o);e.setIndex(i),r=e.getIndex()}var s=r.count-2,u=[];if(t===n.TriangleFanDrawMode)for(o=1;o<=s;o++)u.push(r.getX(0)),u.push(r.getX(o)),u.push(r.getX(o+1));else for(o=0;o<s;o++)o%2===0?(u.push(r.getX(o)),u.push(r.getX(o+1)),u.push(r.getX(o+2))):(u.push(r.getX(o+2)),u.push(r.getX(o+1)),u.push(r.getX(o)));u.length/3!==s&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var c=e.clone();return c.setIndex(u),c}return z.prototype.setExtensions=function(e){this.extensions=e},z.prototype.setPlugins=function(e){this.plugins=e},z.prototype.parse=function(e,t){var r=this,n=this.json,i=this.extensions;this.cache.removeAll(),this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])})).then((function(t){var a={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:r,userData:{}};B(i,a,n),V(a,n),Promise.all(r._invokeAll((function(e){return e.afterRoot&&e.afterRoot(a)}))).then((function(){e(a)}))})).catch(t)},z.prototype._markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[],n=0,i=t.length;n<i;n++)for(var a=t[n].joints,o=0,s=a.length;o<s;o++)e[a[o]].isBone=!0;for(var u=0,c=e.length;u<c;u++){var l=e[u];void 0!==l.mesh&&(this._addNodeRef(this.meshCache,l.mesh),void 0!==l.skin&&(r[l.mesh].isSkinnedMesh=!0)),void 0!==l.camera&&this._addNodeRef(this.cameraCache,l.camera)}},z.prototype._addNodeRef=function(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)},z.prototype._getNodeRef=function(e,t,r){if(e.refs[t]<=1)return r;var n=r.clone();return n.name+="_instance_"+e.uses[t]++,n},z.prototype._invokeOne=function(e){var t=Object.values(this.plugins);t.push(this);for(var r=0;r<t.length;r++){var n=e(t[r]);if(n)return n}},z.prototype._invokeAll=function(e){var t=Object.values(this.plugins);t.unshift(this);for(var r=[],n=0;n<t.length;n++){var i=e(t[n]);i&&r.push(i)}return r},z.prototype.getDependency=function(e,t){var r=e+":"+t,n=this.cache.get(r);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this.loadNode(t);break;case"mesh":n=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":n=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":n=this.loadSkin(t);break;case"animation":n=this.loadAnimation(t);break;case"camera":n=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(r,n)}return n},z.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var r=this,n=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(n.map((function(t,n){return r.getDependency(e,n)}))),this.cache.add(e,t)}return t},z.prototype.loadBuffer=function(e){var t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[r.KHR_BINARY_GLTF].body);var i=this.options;return new Promise((function(e,r){n.load(D(t.uri,i.path),e,void 0,(function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))},z.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var r=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+r)}))},z.prototype.loadAccessor=function(e){var t=this,r=this.json,i=this.json.accessors[e];if(void 0===i.bufferView&&void 0===i.sparse)return Promise.resolve(null);var a=[];return void 0!==i.bufferView?a.push(this.getDependency("bufferView",i.bufferView)):a.push(null),void 0!==i.sparse&&(a.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),a.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(a).then((function(e){var a,o,s=e[0],u=I[i.type],c=k[i.componentType],l=c.BYTES_PER_ELEMENT,p=l*u,h=i.byteOffset||0,f=void 0!==i.bufferView?r.bufferViews[i.bufferView].byteStride:void 0,d=!0===i.normalized;if(f&&f!==p){var m=Math.floor(h/f),v="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+m+":"+i.count,g=t.cache.get(v);g||(a=new c(s,m*f,i.count*f/l),g=new n.InterleavedBuffer(a,f/l),t.cache.add(v,g)),o=new n.InterleavedBufferAttribute(g,u,h%f/l,d)}else a=null===s?new c(i.count*u):new c(s,h,i.count*u),o=new n.BufferAttribute(a,u,d);if(void 0!==i.sparse){var y=I.SCALAR,T=k[i.sparse.indices.componentType],E=i.sparse.indices.byteOffset||0,A=i.sparse.values.byteOffset||0,x=new T(e[1],E,i.sparse.count*y),b=new c(e[2],A,i.sparse.count*u);null!==s&&(o=new n.BufferAttribute(o.array.slice(),o.itemSize,o.normalized));for(var R=0,w=x.length;R<w;R++){var N=x[R];if(o.setX(N,b[R*u]),u>=2&&o.setY(N,b[R*u+1]),u>=3&&o.setZ(N,b[R*u+2]),u>=4&&o.setW(N,b[R*u+3]),u>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return o}))},z.prototype.loadTexture=function(e){var t=this.json,r=this.options,n=t.textures[e],i=t.images[n.source],a=this.textureLoader;if(i.uri){var o=r.manager.getHandler(i.uri);null!==o&&(a=o)}return this.loadTextureImage(e,i,a)},z.prototype.loadTextureImage=function(e,t,r){var i=this,a=this.json,o=this.options,s=a.textures[e],u=self.URL||self.webkitURL,c=t.uri,l=!1,p=!0;if("image/jpeg"===t.mimeType&&(p=!1),void 0!==t.bufferView)c=i.getDependency("bufferView",t.bufferView).then((function(e){if("image/png"===t.mimeType){var r=new DataView(e,25,1).getUint8(0,!1);p=6===r||4===r||3===r}l=!0;var n=new Blob([e],{type:t.mimeType});return c=u.createObjectURL(n)}));else if(void 0===t.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");return Promise.resolve(c).then((function(e){return new Promise((function(t,i){var a=t;!0===r.isImageBitmapLoader&&(a=function(e){t(new n.CanvasTexture(e))}),r.load(D(e,o.path),a,void 0,i)}))})).then((function(t){!0===l&&u.revokeObjectURL(c),t.flipY=!1,s.name&&(t.name=s.name),p||(t.format=n.RGBFormat);var r=(a.samplers||{})[s.sampler]||{};return t.magFilter=_[r.magFilter]||n.LinearFilter,t.minFilter=_[r.minFilter]||n.LinearMipmapLinearFilter,t.wrapS=L[r.wrapS]||n.RepeatWrapping,t.wrapT=L[r.wrapT]||n.RepeatWrapping,i.associations.set(t,{type:"textures",index:e}),t}))},z.prototype.assignTexture=function(e,t,n){var i=this;return this.getDependency("texture",n.index).then((function(a){if(void 0===n.texCoord||0==n.texCoord||"aoMap"===t&&1==n.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),i.extensions[r.KHR_TEXTURE_TRANSFORM]){var o=void 0!==n.extensions?n.extensions[r.KHR_TEXTURE_TRANSFORM]:void 0;if(o){var s=i.associations.get(a);a=i.extensions[r.KHR_TEXTURE_TRANSFORM].extendTexture(a,o),i.associations.set(a,s)}}e[t]=a}))},z.prototype.assignFinalMaterial=function(e){var t=e.geometry,r=e.material,i=void 0!==t.attributes.tangent,a=void 0!==t.attributes.color,o=void 0===t.attributes.normal,s=!0===e.isSkinnedMesh,u=Object.keys(t.morphAttributes).length>0,c=u&&void 0!==t.morphAttributes.normal;if(e.isPoints){var l="PointsMaterial:"+r.uuid,p=this.cache.get(l);p||(p=new n.PointsMaterial,n.Material.prototype.copy.call(p,r),p.color.copy(r.color),p.map=r.map,p.sizeAttenuation=!1,this.cache.add(l,p)),r=p}else if(e.isLine){l="LineBasicMaterial:"+r.uuid;var h=this.cache.get(l);h||(h=new n.LineBasicMaterial,n.Material.prototype.copy.call(h,r),h.color.copy(r.color),this.cache.add(l,h)),r=h}if(i||a||o||s||u){l="ClonedMaterial:"+r.uuid+":";r.isGLTFSpecularGlossinessMaterial&&(l+="specular-glossiness:"),s&&(l+="skinning:"),i&&(l+="vertex-tangents:"),a&&(l+="vertex-colors:"),o&&(l+="flat-shading:"),u&&(l+="morph-targets:"),c&&(l+="morph-normals:");var f=this.cache.get(l);f||(f=r.clone(),s&&(f.skinning=!0),a&&(f.vertexColors=!0),o&&(f.flatShading=!0),u&&(f.morphTargets=!0),c&&(f.morphNormals=!0),i&&(f.vertexTangents=!0,f.normalScale&&(f.normalScale.y*=-1),f.clearcoatNormalScale&&(f.clearcoatNormalScale.y*=-1)),this.cache.add(l,f),this.associations.set(f,this.associations.get(r))),r=f}r.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=r},z.prototype.getMaterialType=function(){return n.MeshStandardMaterial},z.prototype.loadMaterial=function(e){var t,i=this,a=this.json,o=this.extensions,s=a.materials[e],u={},c=s.extensions||{},l=[];if(c[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var p=o[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=p.getMaterialType(),l.push(p.extendParams(u,s,i))}else if(c[r.KHR_MATERIALS_UNLIT]){var h=o[r.KHR_MATERIALS_UNLIT];t=h.getMaterialType(),l.push(h.extendParams(u,s,i))}else{var f=s.pbrMetallicRoughness||{};if(u.color=new n.Color(1,1,1),u.opacity=1,Array.isArray(f.baseColorFactor)){var d=f.baseColorFactor;u.color.fromArray(d),u.opacity=d[3]}void 0!==f.baseColorTexture&&l.push(i.assignTexture(u,"map",f.baseColorTexture)),u.metalness=void 0!==f.metallicFactor?f.metallicFactor:1,u.roughness=void 0!==f.roughnessFactor?f.roughnessFactor:1,void 0!==f.metallicRoughnessTexture&&(l.push(i.assignTexture(u,"metalnessMap",f.metallicRoughnessTexture)),l.push(i.assignTexture(u,"roughnessMap",f.metallicRoughnessTexture))),t=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),l.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,u)}))))}!0===s.doubleSided&&(u.side=n.DoubleSide);var m=s.alphaMode||P;return m===U?(u.transparent=!0,u.depthWrite=!1):(u.transparent=!1,m===F&&(u.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&t!==n.MeshBasicMaterial&&(l.push(i.assignTexture(u,"normalMap",s.normalTexture)),u.normalScale=new n.Vector2(1,-1),void 0!==s.normalTexture.scale&&u.normalScale.set(s.normalTexture.scale,-s.normalTexture.scale)),void 0!==s.occlusionTexture&&t!==n.MeshBasicMaterial&&(l.push(i.assignTexture(u,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(u.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&t!==n.MeshBasicMaterial&&(u.emissive=(new n.Color).fromArray(s.emissiveFactor)),void 0!==s.emissiveTexture&&t!==n.MeshBasicMaterial&&l.push(i.assignTexture(u,"emissiveMap",s.emissiveTexture)),Promise.all(l).then((function(){var a;return a=t===g?o[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(u):new t(u),s.name&&(a.name=s.name),a.map&&(a.map.encoding=n.sRGBEncoding),a.emissiveMap&&(a.emissiveMap.encoding=n.sRGBEncoding),V(a,s),i.associations.set(a,{type:"materials",index:e}),s.extensions&&B(o,a,s),a}))},z.prototype.createUniqueName=function(e){for(var t=n.PropertyBinding.sanitizeNodeName(e||""),r=t,i=1;this.nodeNamesUsed[r];++i)r=t+"_"+i;return this.nodeNamesUsed[r]=!0,r},z.prototype.loadGeometries=function(e){var t=this,i=this.extensions,a=this.primitiveCache;function o(e){return i[r.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(r){return W(r,e,t)}))}for(var s=[],u=0,c=e.length;u<c;u++){var l,p=e[u],h=G(p),f=a[h];if(f)s.push(f.promise);else l=p.extensions&&p.extensions[r.KHR_DRACO_MESH_COMPRESSION]?o(p):W(new n.BufferGeometry,p,t),a[h]={primitive:p,promise:l},s.push(l)}return Promise.all(s)},z.prototype.loadMesh=function(e){for(var t,r=this,i=this.json,a=this.extensions,o=i.meshes[e],s=o.primitives,u=[],c=0,l=s.length;c<l;c++){var p=void 0===s[c].material?(void 0===(t=this.cache).DefaultMaterial&&(t.DefaultMaterial=new n.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:n.FrontSide})),t.DefaultMaterial):this.getDependency("material",s[c].material);u.push(p)}return u.push(r.loadGeometries(s)),Promise.all(u).then((function(t){for(var i=t.slice(0,t.length-1),u=t[t.length-1],c=[],l=0,p=u.length;l<p;l++){var h,f=u[l],d=s[l],m=i[l];if(d.mode===w||d.mode===N||d.mode===S||void 0===d.mode)!0!==(h=!0===o.isSkinnedMesh?new n.SkinnedMesh(f,m):new n.Mesh(f,m)).isSkinnedMesh||h.geometry.attributes.skinWeight.normalized||h.normalizeSkinWeights(),d.mode===N?h.geometry=K(h.geometry,n.TriangleStripDrawMode):d.mode===S&&(h.geometry=K(h.geometry,n.TriangleFanDrawMode));else if(d.mode===x)h=new n.LineSegments(f,m);else if(d.mode===R)h=new n.Line(f,m);else if(d.mode===b)h=new n.LineLoop(f,m);else{if(d.mode!==A)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+d.mode);h=new n.Points(f,m)}Object.keys(h.geometry.morphAttributes).length>0&&j(h,o),h.name=r.createUniqueName(o.name||"mesh_"+e),V(h,o),d.extensions&&B(a,h,d),r.assignFinalMaterial(h),c.push(h)}if(1===c.length)return c[0];var v=new n.Group;for(l=0,p=c.length;l<p;l++)v.add(c[l]);return v}))},z.prototype.loadCamera=function(e){var t,r=this.json.cameras[e],i=r[r.type];if(i)return"perspective"===r.type?t=new n.PerspectiveCamera(n.MathUtils.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===r.type&&(t=new n.OrthographicCamera(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),V(t,r),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},z.prototype.loadSkin=function(e){var t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return r.inverseBindMatrices=e,r}))},z.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],r=[],i=[],a=[],o=[],s=[],u=0,c=t.channels.length;u<c;u++){var l=t.channels[u],p=t.samplers[l.sampler],h=l.target,f=void 0!==h.node?h.node:h.id,d=void 0!==t.parameters?t.parameters[p.input]:p.input,m=void 0!==t.parameters?t.parameters[p.output]:p.output;r.push(this.getDependency("node",f)),i.push(this.getDependency("accessor",d)),a.push(this.getDependency("accessor",m)),o.push(p),s.push(h)}return Promise.all([Promise.all(r),Promise.all(i),Promise.all(a),Promise.all(o),Promise.all(s)]).then((function(r){for(var i=r[0],a=r[1],o=r[2],s=r[3],u=r[4],c=[],l=0,p=i.length;l<p;l++){var h=i[l],f=a[l],d=o[l],m=s[l],v=u[l];if(void 0!==h){var g;switch(h.updateMatrix(),h.matrixAutoUpdate=!0,M[v.path]){case M.weights:g=n.NumberKeyframeTrack;break;case M.rotation:g=n.QuaternionKeyframeTrack;break;case M.position:case M.scale:default:g=n.VectorKeyframeTrack}var y=h.name?h.name:h.uuid,T=void 0!==m.interpolation?C[m.interpolation]:n.InterpolateLinear,A=[];M[v.path]===M.weights?h.traverse((function(e){!0===e.isMesh&&e.morphTargetInfluences&&A.push(e.name?e.name:e.uuid)})):A.push(y);var x=d.array;if(d.normalized){var b;if(x.constructor===Int8Array)b=1/127;else if(x.constructor===Uint8Array)b=1/255;else if(x.constructor==Int16Array)b=1/32767;else{if(x.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");b=1/65535}for(var R=new Float32Array(x.length),w=0,N=x.length;w<N;w++)R[w]=x[w]*b;x=R}for(w=0,N=A.length;w<N;w++){var S=new g(A[w]+"."+M[v.path],f.array,x,T);"CUBICSPLINE"===m.interpolation&&(S.createInterpolant=function(e){return new E(this.times,this.values,this.getValueSize()/3,e)},S.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),c.push(S)}}}var k=t.name?t.name:"animation_"+e;return new n.AnimationClip(k,void 0,c)}))},z.prototype.loadNode=function(e){var t=this.json,r=this.extensions,i=this,a=t.nodes[e],o=a.name?i.createUniqueName(a.name):"";return function(){var t=[];return void 0!==a.mesh&&t.push(i.getDependency("mesh",a.mesh).then((function(e){var t=i._getNodeRef(i.meshCache,a.mesh,e);return void 0!==a.weights&&t.traverse((function(e){if(e.isMesh)for(var t=0,r=a.weights.length;t<r;t++)e.morphTargetInfluences[t]=a.weights[t]})),t}))),void 0!==a.camera&&t.push(i.getDependency("camera",a.camera).then((function(e){return i._getNodeRef(i.cameraCache,a.camera,e)}))),i._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){t.push(e)})),Promise.all(t)}().then((function(t){var s;if((s=!0===a.isBone?new n.Bone:t.length>1?new n.Group:1===t.length?t[0]:new n.Object3D)!==t[0])for(var u=0,c=t.length;u<c;u++)s.add(t[u]);if(a.name&&(s.userData.name=a.name,s.name=o),V(s,a),a.extensions&&B(r,s,a),void 0!==a.matrix){var l=new n.Matrix4;l.fromArray(a.matrix),s.applyMatrix4(l)}else void 0!==a.translation&&s.position.fromArray(a.translation),void 0!==a.rotation&&s.quaternion.fromArray(a.rotation),void 0!==a.scale&&s.scale.fromArray(a.scale);return i.associations.set(s,{type:"nodes",index:e}),s}))},z.prototype.loadScene=function(){function e(t,r,i,a){var o=i.nodes[t];return a.getDependency("node",t).then((function(e){return void 0===o.skin?e:a.getDependency("skin",o.skin).then((function(e){for(var r=[],n=0,i=(t=e).joints.length;n<i;n++)r.push(a.getDependency("node",t.joints[n]));return Promise.all(r)})).then((function(r){return e.traverse((function(e){if(e.isMesh){for(var i=[],a=[],o=0,s=r.length;o<s;o++){var u=r[o];if(u){i.push(u);var c=new n.Matrix4;void 0!==t.inverseBindMatrices&&c.fromArray(t.inverseBindMatrices.array,16*o),a.push(c)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[o])}e.bind(new n.Skeleton(i,a),e.matrixWorld)}})),e}));var t})).then((function(t){r.add(t);var n=[];if(o.children)for(var s=o.children,u=0,c=s.length;u<c;u++){var l=s[u];n.push(e(l,t,i,a))}return Promise.all(n)}))}return function(t){var r=this.json,i=this.extensions,a=this.json.scenes[t],o=new n.Group;a.name&&(o.name=this.createUniqueName(a.name)),V(o,a),a.extensions&&B(i,o,a);for(var s=a.nodes||[],u=[],c=0,l=s.length;c<l;c++)u.push(e(s[c],o,r,this));return Promise.all(u).then((function(){return o}))}}(),e}()},4864:function(e,t,r){"use strict";r.d(t,{v:function(){return i}});var n=r(2212),i=function(e){n.Loader.call(this,e)};i.prototype=Object.assign(Object.create(n.Loader.prototype),{constructor:i,load:function(e,t,r,i){var a=this,o=""===this.path?n.LoaderUtils.extractUrlBase(e):this.path,s=new n.FileLoader(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(r){try{t(a.parse(r,o))}catch(n){i?i(n):console.error(n),a.manager.itemError(e)}}),r,i)},setMaterialOptions:function(e){return this.materialOptions=e,this},parse:function(e,t){for(var r=e.split("\n"),n={},a=/\s+/,o={},s=0;s<r.length;s++){var u=r[s];if(0!==(u=u.trim()).length&&"#"!==u.charAt(0)){var c=u.indexOf(" "),l=c>=0?u.substring(0,c):u;l=l.toLowerCase();var p=c>=0?u.substring(c+1):"";if(p=p.trim(),"newmtl"===l)n={name:p},o[p]=n;else if("ka"===l||"kd"===l||"ks"===l||"ke"===l){var h=p.split(a,3);n[l]=[parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2])]}else n[l]=p}}var f=new i.MaterialCreator(this.resourcePath||t,this.materialOptions);return f.setCrossOrigin(this.crossOrigin),f.setManager(this.manager),f.setMaterials(o),f}}),i.MaterialCreator=function(e,t){this.baseUrl=e||"",this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:n.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:n.RepeatWrapping},i.MaterialCreator.prototype={constructor:i.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(e){return this.crossOrigin=e,this},setManager:function(e){this.manager=e},setMaterials:function(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(e){if(!this.options)return e;var t={};for(var r in e){var n=e[r],i={};for(var a in t[r]=i,n){var o=!0,s=n[a],u=a.toLowerCase();switch(u){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===s[0]&&0===s[1]&&0===s[2]&&(o=!1)}o&&(i[u]=s)}}return t},preload:function(){for(var e in this.materialsInfo)this.create(e)},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0;for(var t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray},create:function(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]},createMaterial_:function(e){var t=this,r=this.materialsInfo[e],i={name:e,side:this.side};function a(e,r){if(!i[e]){var n,a,o=t.getTextureParams(r,i),s=t.loadTexture((n=t.baseUrl,"string"!==typeof(a=o.url)||""===a?"":/^https?:\/\//i.test(a)?a:n+a));s.repeat.copy(o.scale),s.offset.copy(o.offset),s.wrapS=t.wrap,s.wrapT=t.wrap,i[e]=s}}for(var o in r){var s,u=r[o];if(""!==u)switch(o.toLowerCase()){case"kd":i.color=(new n.Color).fromArray(u);break;case"ks":i.specular=(new n.Color).fromArray(u);break;case"ke":i.emissive=(new n.Color).fromArray(u);break;case"map_kd":a("map",u);break;case"map_ks":a("specularMap",u);break;case"map_ke":a("emissiveMap",u);break;case"norm":a("normalMap",u);break;case"map_bump":case"bump":a("bumpMap",u);break;case"map_d":a("alphaMap",u),i.transparent=!0;break;case"ns":i.shininess=parseFloat(u);break;case"d":(s=parseFloat(u))<1&&(i.opacity=s,i.transparent=!0);break;case"tr":s=parseFloat(u),this.options&&this.options.invertTrProperty&&(s=1-s),s>0&&(i.opacity=1-s,i.transparent=!0)}}return this.materials[e]=new n.MeshPhongMaterial(i),this.materials[e]},getTextureParams:function(e,t){var r,i={scale:new n.Vector2(1,1),offset:new n.Vector2(0,0)},a=e.split(/\s+/);return(r=a.indexOf("-bm"))>=0&&(t.bumpScale=parseFloat(a[r+1]),a.splice(r,2)),(r=a.indexOf("-s"))>=0&&(i.scale.set(parseFloat(a[r+1]),parseFloat(a[r+2])),a.splice(r,4)),(r=a.indexOf("-o"))>=0&&(i.offset.set(parseFloat(a[r+1]),parseFloat(a[r+2])),a.splice(r,4)),i.url=a.join(" ").trim(),i},loadTexture:function(e,t,r,i,a){var o,s=void 0!==this.manager?this.manager:n.DefaultLoadingManager,u=s.getHandler(e);return null===u&&(u=new n.TextureLoader(s)),u.setCrossOrigin&&u.setCrossOrigin(this.crossOrigin),o=u.load(e,r,i,a),void 0!==t&&(o.mapping=t),o}}},8840:function(e,t,r){"use strict";r.d(t,{L:function(){return i}});var n=r(2212),i=function(){var e=/^[og]\s*(.+)?/,t=/^mtllib /,r=/^usemtl /,i=/^usemap /,a=new n.Vector3,o=new n.Vector3,s=new n.Vector3,u=new n.Vector3,c=new n.Vector3;function l(){var e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);var r=this.object&&"function"===typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(e,t){var r=this._finalize(!1);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);var n={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==r?r.smooth:this.smooth,groupStart:void 0!==r?r.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){var t={index:"number"===typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(n),n},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){var t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&this.materials.length>1)for(var r=this.materials.length-1;r>=0;r--)this.materials[r].groupCount<=0&&this.materials.splice(r,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},r&&r.name&&"function"===typeof r.clone){var n=r.clone(0);n.inherited=!0,this.object.materials.push(n)}this.objects.push(this.object)},finalize:function(){this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){var r=parseInt(e,10);return 3*(r>=0?r-1:r+t/3)},parseNormalIndex:function(e,t){var r=parseInt(e,10);return 3*(r>=0?r-1:r+t/3)},parseUVIndex:function(e,t){var r=parseInt(e,10);return 2*(r>=0?r-1:r+t/2)},addVertex:function(e,t,r){var n=this.vertices,i=this.object.geometry.vertices;i.push(n[e+0],n[e+1],n[e+2]),i.push(n[t+0],n[t+1],n[t+2]),i.push(n[r+0],n[r+1],n[r+2])},addVertexPoint:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,r){var n=this.normals,i=this.object.geometry.normals;i.push(n[e+0],n[e+1],n[e+2]),i.push(n[t+0],n[t+1],n[t+2]),i.push(n[r+0],n[r+1],n[r+2])},addFaceNormal:function(e,t,r){var n=this.vertices,i=this.object.geometry.normals;a.fromArray(n,e),o.fromArray(n,t),s.fromArray(n,r),c.subVectors(s,o),u.subVectors(a,o),c.cross(u),c.normalize(),i.push(c.x,c.y,c.z),i.push(c.x,c.y,c.z),i.push(c.x,c.y,c.z)},addColor:function(e,t,r){var n=this.colors,i=this.object.geometry.colors;void 0!==n[e]&&i.push(n[e+0],n[e+1],n[e+2]),void 0!==n[t]&&i.push(n[t+0],n[t+1],n[t+2]),void 0!==n[r]&&i.push(n[r+0],n[r+1],n[r+2])},addUV:function(e,t,r){var n=this.uvs,i=this.object.geometry.uvs;i.push(n[e+0],n[e+1]),i.push(n[t+0],n[t+1]),i.push(n[r+0],n[r+1])},addDefaultUV:function(){var e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){var t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,r,n,i,a,o,s,u){var c=this.vertices.length,l=this.parseVertexIndex(e,c),p=this.parseVertexIndex(t,c),h=this.parseVertexIndex(r,c);if(this.addVertex(l,p,h),this.addColor(l,p,h),void 0!==o&&""!==o){var f=this.normals.length;l=this.parseNormalIndex(o,f),p=this.parseNormalIndex(s,f),h=this.parseNormalIndex(u,f),this.addNormal(l,p,h)}else this.addFaceNormal(l,p,h);if(void 0!==n&&""!==n){var d=this.uvs.length;l=this.parseUVIndex(n,d),p=this.parseUVIndex(i,d),h=this.parseUVIndex(a,d),this.addUV(l,p,h),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";for(var t=this.vertices.length,r=0,n=e.length;r<n;r++){var i=this.parseVertexIndex(e[r],t);this.addVertexPoint(i),this.addColor(i)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";for(var r=this.vertices.length,n=this.uvs.length,i=0,a=e.length;i<a;i++)this.addVertexLine(this.parseVertexIndex(e[i],r));var o=0;for(a=t.length;o<a;o++)this.addUVLine(this.parseUVIndex(t[o],n))}};return e.startObject("",!1),e}function p(e){n.Loader.call(this,e),this.materials=null}return p.prototype=Object.assign(Object.create(n.Loader.prototype),{constructor:p,load:function(e,t,r,i){var a=this,o=new n.FileLoader(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(r){try{t(a.parse(r))}catch(n){i?i(n):console.error(n),a.manager.itemError(e)}}),r,i)},setMaterials:function(e){return this.materials=e,this},parse:function(a){var o=new l;-1!==a.indexOf("\r\n")&&(a=a.replace(/\r\n/g,"\n")),-1!==a.indexOf("\\\n")&&(a=a.replace(/\\\n/g,""));for(var s=a.split("\n"),u="",c="",p=[],h="function"===typeof"".trimLeft,f=0,d=s.length;f<d;f++)if(u=s[f],0!==(u=h?u.trimLeft():u.trim()).length&&"#"!==(c=u.charAt(0)))if("v"===c){var m=u.split(/\s+/);switch(m[0]){case"v":o.vertices.push(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3])),m.length>=7?o.colors.push(parseFloat(m[4]),parseFloat(m[5]),parseFloat(m[6])):o.colors.push(void 0,void 0,void 0);break;case"vn":o.normals.push(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3]));break;case"vt":o.uvs.push(parseFloat(m[1]),parseFloat(m[2]))}}else if("f"===c){for(var v=u.substr(1).trim().split(/\s+/),g=[],y=0,T=v.length;y<T;y++){var E=v[y];if(E.length>0){var A=E.split("/");g.push(A)}}var x=g[0];for(y=1,T=g.length-1;y<T;y++){var b=g[y],R=g[y+1];o.addFace(x[0],b[0],R[0],x[1],b[1],R[1],x[2],b[2],R[2])}}else if("l"===c){var w=u.substring(1).trim().split(" "),N=[],S=[];if(-1===u.indexOf("/"))N=w;else for(var k=0,_=w.length;k<_;k++){var L=w[k].split("/");""!==L[0]&&N.push(L[0]),""!==L[1]&&S.push(L[1])}o.addLineGeometry(N,S)}else if("p"===c){var I=u.substr(1).trim().split(" ");o.addPointGeometry(I)}else if(null!==(p=e.exec(u))){var O=(" "+p[0].substr(1).trim()).substr(1);o.startObject(O)}else if(r.test(u))o.object.startMaterial(u.substring(7).trim(),o.materialLibraries);else if(t.test(u))o.materialLibraries.push(u.substring(7).trim());else if(i.test(u))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===c){if((p=u.split(" ")).length>1){var M=p[1].trim().toLowerCase();o.object.smooth="0"!==M&&"off"!==M}else o.object.smooth=!0;(K=o.object.currentMaterial())&&(K.smooth=o.object.smooth)}else{if("\0"===u)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+u+'"')}o.finalize();var C=new n.Group;if(C.materialLibraries=[].concat(o.materialLibraries),!0===!(1===o.objects.length&&0===o.objects[0].geometry.vertices.length))for(f=0,d=o.objects.length;f<d;f++){var P=o.objects[f],F=P.geometry,U=P.materials,D="Line"===F.type,B="Points"===F.type,V=!1;if(0!==F.vertices.length){(Z=new n.BufferGeometry).setAttribute("position",new n.Float32BufferAttribute(F.vertices,3)),F.normals.length>0&&Z.setAttribute("normal",new n.Float32BufferAttribute(F.normals,3)),F.colors.length>0&&(V=!0,Z.setAttribute("color",new n.Float32BufferAttribute(F.colors,3))),!0===F.hasUVIndices&&Z.setAttribute("uv",new n.Float32BufferAttribute(F.uvs,2));for(var j,G=[],H=0,z=U.length;H<z;H++){var W=(q=U[H]).name+"_"+q.smooth+"_"+V,K=o.materials[W];if(null!==this.materials)if(K=this.materials.create(q.name),!D||!K||K instanceof n.LineBasicMaterial){if(B&&K&&!(K instanceof n.PointsMaterial)){var X=new n.PointsMaterial({size:10,sizeAttenuation:!1});n.Material.prototype.copy.call(X,K),X.color.copy(K.color),X.map=K.map,K=X}}else{var Y=new n.LineBasicMaterial;n.Material.prototype.copy.call(Y,K),Y.color.copy(K.color),K=Y}void 0===K&&((K=D?new n.LineBasicMaterial:B?new n.PointsMaterial({size:1,sizeAttenuation:!1}):new n.MeshPhongMaterial).name=q.name,K.flatShading=!q.smooth,K.vertexColors=V,o.materials[W]=K),G.push(K)}if(G.length>1){for(H=0,z=U.length;H<z;H++){var q=U[H];Z.addGroup(q.groupStart,q.groupCount,H)}j=D?new n.LineSegments(Z,G):B?new n.Points(Z,G):new n.Mesh(Z,G)}else j=D?new n.LineSegments(Z,G[0]):B?new n.Points(Z,G[0]):new n.Mesh(Z,G[0]);j.name=P.name,C.add(j)}}else if(o.vertices.length>0){var Z;K=new n.PointsMaterial({size:1,sizeAttenuation:!1});(Z=new n.BufferGeometry).setAttribute("position",new n.Float32BufferAttribute(o.vertices,3)),o.colors.length>0&&void 0!==o.colors[0]&&(Z.setAttribute("color",new n.Float32BufferAttribute(o.colors,3)),K.vertexColors=!0);var $=new n.Points(Z,K);C.add($)}return C}}),p}()},879:function(e,t,r){"use strict";r.d(t,{w:function(){return i}});var n=r(2212),i=function(e){n.Loader.call(this,e),this.littleEndian=!0};i.prototype=Object.assign(Object.create(n.Loader.prototype),{constructor:i,load:function(e,t,r,i){var a=this,o=new n.FileLoader(a.manager);o.setPath(a.path),o.setResponseType("arraybuffer"),o.setRequestHeader(a.requestHeader),o.setWithCredentials(a.withCredentials),o.load(e,(function(r){try{t(a.parse(r,e))}catch(n){i?i(n):console.error(n),a.manager.itemError(e)}}),r,i)},parse:function(e,t){var r=n.LoaderUtils.decodeText(new Uint8Array(e)),i=function(e){var t={},r=e.search(/[\r\n]DATA\s(\S*)\s/i),n=/[\r\n]DATA\s(\S*)\s/i.exec(e.substr(r-1));if(t.data=n[1],t.headerLen=n[0].length+r,t.str=e.substr(0,t.headerLen),t.str=t.str.replace(/\#.*/gi,""),t.version=/VERSION (.*)/i.exec(t.str),t.fields=/FIELDS (.*)/i.exec(t.str),t.size=/SIZE (.*)/i.exec(t.str),t.type=/TYPE (.*)/i.exec(t.str),t.count=/COUNT (.*)/i.exec(t.str),t.width=/WIDTH (.*)/i.exec(t.str),t.height=/HEIGHT (.*)/i.exec(t.str),t.viewpoint=/VIEWPOINT (.*)/i.exec(t.str),t.points=/POINTS (.*)/i.exec(t.str),null!==t.version&&(t.version=parseFloat(t.version[1])),null!==t.fields&&(t.fields=t.fields[1].split(" ")),null!==t.type&&(t.type=t.type[1].split(" ")),null!==t.width&&(t.width=parseInt(t.width[1])),null!==t.height&&(t.height=parseInt(t.height[1])),null!==t.viewpoint&&(t.viewpoint=t.viewpoint[1]),null!==t.points&&(t.points=parseInt(t.points[1],10)),null===t.points&&(t.points=t.width*t.height),null!==t.size&&(t.size=t.size[1].split(" ").map((function(e){return parseInt(e,10)}))),null!==t.count)t.count=t.count[1].split(" ").map((function(e){return parseInt(e,10)}));else{t.count=[];for(var i=0,a=t.fields.length;i<a;i++)t.count.push(1)}t.offset={};var o=0;for(i=0,a=t.fields.length;i<a;i++)"ascii"===t.data?t.offset[t.fields[i]]=i:(t.offset[t.fields[i]]=o,o+=t.size[i]*t.count[i]);return t.rowSize=o,t}(r),a=[],o=[],s=[];if("ascii"===i.data)for(var u=i.offset,c=r.substr(i.headerLen).split("\n"),l=0,p=c.length;l<p;l++)if(""!==c[l]){var h=c[l].split(" ");if(void 0!==u.x&&(a.push(parseFloat(h[u.x])),a.push(parseFloat(h[u.y])),a.push(parseFloat(h[u.z]))),void 0!==u.rgb){var f=parseFloat(h[u.rgb]),d=f>>16&255,m=f>>8&255,v=f>>0&255;s.push(d/255,m/255,v/255)}void 0!==u.normal_x&&(o.push(parseFloat(h[u.normal_x])),o.push(parseFloat(h[u.normal_y])),o.push(parseFloat(h[u.normal_z])))}if("binary_compressed"===i.data){var g=new Uint32Array(e.slice(i.headerLen,i.headerLen+8)),y=g[0],T=g[1],E=function(e,t){var r,n,i,a=e.length,o=new Uint8Array(t),s=0,u=0;do{if((r=e[s++])<32){if(u+ ++r>t)throw new Error("Output buffer is not large enough");if(s+r>a)throw new Error("Invalid compressed data");do{o[u++]=e[s++]}while(--r)}else{if(n=r>>5,i=u-((31&r)<<8)-1,s>=a)throw new Error("Invalid compressed data");if(7===n&&(n+=e[s++],s>=a))throw new Error("Invalid compressed data");if(i-=e[s++],u+n+2>t)throw new Error("Output buffer is not large enough");if(i<0)throw new Error("Invalid compressed data");if(i>=u)throw new Error("Invalid compressed data");do{o[u++]=o[i++]}while(2+--n)}}while(s<a);return o}(new Uint8Array(e,i.headerLen+8,y),T),A=new DataView(E.buffer);for(u=i.offset,l=0;l<i.points;l++)void 0!==u.x&&(a.push(A.getFloat32(i.points*u.x+i.size[0]*l,this.littleEndian)),a.push(A.getFloat32(i.points*u.y+i.size[1]*l,this.littleEndian)),a.push(A.getFloat32(i.points*u.z+i.size[2]*l,this.littleEndian))),void 0!==u.rgb&&(s.push(A.getUint8(i.points*u.rgb+i.size[3]*l+0)/255),s.push(A.getUint8(i.points*u.rgb+i.size[3]*l+1)/255),s.push(A.getUint8(i.points*u.rgb+i.size[3]*l+2)/255)),void 0!==u.normal_x&&(o.push(A.getFloat32(i.points*u.normal_x+i.size[4]*l,this.littleEndian)),o.push(A.getFloat32(i.points*u.normal_y+i.size[5]*l,this.littleEndian)),o.push(A.getFloat32(i.points*u.normal_z+i.size[6]*l,this.littleEndian)))}if("binary"===i.data){A=new DataView(e,i.headerLen),u=i.offset,l=0;for(var x=0;l<i.points;l++,x+=i.rowSize)void 0!==u.x&&(a.push(A.getFloat32(x+u.x,this.littleEndian)),a.push(A.getFloat32(x+u.y,this.littleEndian)),a.push(A.getFloat32(x+u.z,this.littleEndian))),void 0!==u.rgb&&(s.push(A.getUint8(x+u.rgb+2)/255),s.push(A.getUint8(x+u.rgb+1)/255),s.push(A.getUint8(x+u.rgb+0)/255)),void 0!==u.normal_x&&(o.push(A.getFloat32(x+u.normal_x,this.littleEndian)),o.push(A.getFloat32(x+u.normal_y,this.littleEndian)),o.push(A.getFloat32(x+u.normal_z,this.littleEndian)))}var b=new n.BufferGeometry;a.length>0&&b.setAttribute("position",new n.Float32BufferAttribute(a,3)),o.length>0&&b.setAttribute("normal",new n.Float32BufferAttribute(o,3)),s.length>0&&b.setAttribute("color",new n.Float32BufferAttribute(s,3)),b.computeBoundingSphere();var R=new n.PointsMaterial({size:.005});s.length>0?R.vertexColors=!0:R.color.setHex(16777215*Math.random());var w=new n.Points(b,R),N=t.split("").reverse().join("");return N=(N=/([^\/]*)/.exec(N))[1].split("").reverse().join(""),w.name=N,w}})},6286:function(e,t,r){"use strict";r.d(t,{F:function(){return i}});var n=r(2212),i=function(e){n.Loader.call(this,e),this.propertyNameMapping={}};i.prototype=Object.assign(Object.create(n.Loader.prototype),{constructor:i,load:function(e,t,r,i){var a=this,o=new n.FileLoader(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(r){try{t(a.parse(r))}catch(n){i?i(n):console.error(n),a.manager.itemError(e)}}),r,i)},setPropertyNameMapping:function(e){this.propertyNameMapping=e},parse:function(e){function t(e){var t="",r=0,n=/ply([\s\S]*)end_header\r?\n/.exec(e);null!==n&&(t=n[1],r=new Blob([n[0]]).size);var i,a,o,s={comments:[],elements:[],headerLength:r,objInfo:""},u=t.split("\n");function c(e,t){var r={type:e[0]};return"list"===r.type?(r.name=e[3],r.countType=e[1],r.itemType=e[2]):r.name=e[1],r.name in t&&(r.name=t[r.name]),r}for(var l=0;l<u.length;l++){var h=u[l];if(""!==(h=h.trim()))switch(a=(o=h.split(/\s+/)).shift(),h=o.join(" "),a){case"format":s.format=o[0],s.version=o[1];break;case"comment":s.comments.push(h);break;case"element":void 0!==i&&s.elements.push(i),(i={}).name=o[0],i.count=parseInt(o[1]),i.properties=[];break;case"property":i.properties.push(c(o,p.propertyNameMapping));break;case"obj_info":s.objInfo=h;break;default:console.log("unhandled",a,o)}}return void 0!==i&&s.elements.push(i),s}function r(e,t){switch(t){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(e);case"float":case"double":case"float32":case"float64":return parseFloat(e)}}function i(e,t){for(var n=t.split(/\s+/),i={},a=0;a<e.length;a++)if("list"===e[a].type){for(var o=[],s=r(n.shift(),e[a].countType),u=0;u<s;u++)o.push(r(n.shift(),e[a].itemType));i[e[a].name]=o}else i[e[a].name]=r(n.shift(),e[a].type);return i}function a(e,t){var r,n={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},a="";null!==(r=/end_header\s([\s\S]*)$/.exec(e))&&(a=r[1]);for(var u=a.split("\n"),c=0,l=0,p=0;p<u.length;p++){var h=u[p];if(""!==(h=h.trim())){l>=t.elements[c].count&&(c++,l=0);var f=i(t.elements[c].properties,h);s(n,t.elements[c].name,f),l++}}return o(n)}function o(e){var t=new n.BufferGeometry;return e.indices.length>0&&t.setIndex(e.indices),t.setAttribute("position",new n.Float32BufferAttribute(e.vertices,3)),e.normals.length>0&&t.setAttribute("normal",new n.Float32BufferAttribute(e.normals,3)),e.uvs.length>0&&t.setAttribute("uv",new n.Float32BufferAttribute(e.uvs,2)),e.colors.length>0&&t.setAttribute("color",new n.Float32BufferAttribute(e.colors,3)),e.faceVertexUvs.length>0&&(t=t.toNonIndexed()).setAttribute("uv",new n.Float32BufferAttribute(e.faceVertexUvs,2)),t.computeBoundingSphere(),t}function s(e,t,r){if("vertex"===t)e.vertices.push(r.x,r.y,r.z),"nx"in r&&"ny"in r&&"nz"in r&&e.normals.push(r.nx,r.ny,r.nz),"s"in r&&"t"in r&&e.uvs.push(r.s,r.t),"red"in r&&"green"in r&&"blue"in r&&e.colors.push(r.red/255,r.green/255,r.blue/255);else if("face"===t){var n=r.vertex_indices||r.vertex_index,i=r.texcoord;3===n.length?(e.indices.push(n[0],n[1],n[2]),i&&6===i.length&&(e.faceVertexUvs.push(i[0],i[1]),e.faceVertexUvs.push(i[2],i[3]),e.faceVertexUvs.push(i[4],i[5]))):4===n.length&&(e.indices.push(n[0],n[1],n[3]),e.indices.push(n[1],n[2],n[3]))}}function u(e,t,r,n){switch(r){case"int8":case"char":return[e.getInt8(t),1];case"uint8":case"uchar":return[e.getUint8(t),1];case"int16":case"short":return[e.getInt16(t,n),2];case"uint16":case"ushort":return[e.getUint16(t,n),2];case"int32":case"int":return[e.getInt32(t,n),4];case"uint32":case"uint":return[e.getUint32(t,n),4];case"float32":case"float":return[e.getFloat32(t,n),4];case"float64":case"double":return[e.getFloat64(t,n),8]}}function c(e,t,r,n){for(var i,a={},o=0,s=0;s<r.length;s++)if("list"===r[s].type){var c=[],l=(i=u(e,t+o,r[s].countType,n))[0];o+=i[1];for(var p=0;p<l;p++)i=u(e,t+o,r[s].itemType,n),c.push(i[0]),o+=i[1];a[r[s].name]=c}else i=u(e,t+o,r[s].type,n),a[r[s].name]=i[0],o+=i[1];return[a,o]}var l,p=this;if(e instanceof ArrayBuffer){var h=n.LoaderUtils.decodeText(new Uint8Array(e)),f=t(h);l="ascii"===f.format?a(h,f):function(e,t){for(var r,n={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},i="binary_little_endian"===t.format,a=new DataView(e,t.headerLength),u=0,l=0;l<t.elements.length;l++)for(var p=0;p<t.elements[l].count;p++){u+=(r=c(a,u,t.elements[l].properties,i))[1];var h=r[0];s(n,t.elements[l].name,h)}return o(n)}(e,f)}else l=a(e,t(e));return l}})},6637:function(e,t,r){"use strict";r.d(t,{j:function(){return i}});var n=r(2212),i=function(e){n.Loader.call(this,e)};i.prototype=Object.assign(Object.create(n.Loader.prototype),{constructor:i,load:function(e,t,r,i){var a=this,o=new n.FileLoader(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(r){try{t(a.parse(r))}catch(n){i?i(n):console.error(n),a.manager.itemError(e)}}),r,i)},parse:function(e){function t(e,t,r){for(var n=0,i=e.length;n<i;n++)if(e[n]!==t.getUint8(r+n,!1))return!1;return!0}var r,i=function(e){if("string"===typeof e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=255&e.charCodeAt(r);return t.buffer||t}return e}(e);return function(e){var r;if(50,84+50*(r=new DataView(e)).getUint32(80,!0)===r.byteLength)return!0;for(var n=[115,111,108,105,100],i=0;i<5;i++)if(t(n,r,i))return!1;return!0}(i)?function(e){for(var t,r,i,a,o,s,u,c,l=new DataView(e),p=l.getUint32(80,!0),h=!1,f=0;f<70;f++)1129270351==l.getUint32(f,!1)&&82==l.getUint8(f+4)&&61==l.getUint8(f+5)&&(h=!0,a=new Float32Array(3*p*3),o=l.getUint8(f+6)/255,s=l.getUint8(f+7)/255,u=l.getUint8(f+8)/255,c=l.getUint8(f+9)/255);for(var d=new n.BufferGeometry,m=new Float32Array(3*p*3),v=new Float32Array(3*p*3),g=0;g<p;g++){var y=84+50*g,T=l.getFloat32(y,!0),E=l.getFloat32(y+4,!0),A=l.getFloat32(y+8,!0);if(h){var x=l.getUint16(y+48,!0);0===(32768&x)?(t=(31&x)/31,r=(x>>5&31)/31,i=(x>>10&31)/31):(t=o,r=s,i=u)}for(var b=1;b<=3;b++){var R=y+12*b,w=3*g*3+3*(b-1);m[w]=l.getFloat32(R,!0),m[w+1]=l.getFloat32(R+4,!0),m[w+2]=l.getFloat32(R+8,!0),v[w]=T,v[w+1]=E,v[w+2]=A,h&&(a[w]=t,a[w+1]=r,a[w+2]=i)}}return d.setAttribute("position",new n.BufferAttribute(m,3)),d.setAttribute("normal",new n.BufferAttribute(v,3)),h&&(d.setAttribute("color",new n.BufferAttribute(a,3)),d.hasColors=!0,d.alpha=c),d}(i):function(e){for(var t,r=new n.BufferGeometry,i=/solid([\s\S]*?)endsolid/g,a=/facet([\s\S]*?)endfacet/g,o=0,s=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,u=new RegExp("vertex"+s+s+s,"g"),c=new RegExp("normal"+s+s+s,"g"),l=[],p=[],h=new n.Vector3,f=0,d=0,m=0;null!==(t=i.exec(e));){d=m;for(var v=t[0];null!==(t=a.exec(v));){for(var g=0,y=0,T=t[0];null!==(t=c.exec(T));)h.x=parseFloat(t[1]),h.y=parseFloat(t[2]),h.z=parseFloat(t[3]),y++;for(;null!==(t=u.exec(T));)l.push(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])),p.push(h.x,h.y,h.z),g++,m++;1!==y&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+o),3!==g&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+o),o++}var E=d,A=m-d;r.addGroup(E,A,f),f++}return r.setAttribute("position",new n.Float32BufferAttribute(l,3)),r.setAttribute("normal",new n.Float32BufferAttribute(p,3)),r}("string"!==typeof(r=e)?n.LoaderUtils.decodeText(new Uint8Array(r)):r)}})},8867:function(e,t,r){"use strict";r.d(t,{u:function(){return i}});var n=r(2212),i=function(e){n.Loader.call(this,e),this.defaultDPI=90,this.defaultUnit="px"};i.prototype=Object.assign(Object.create(n.Loader.prototype),{constructor:i,load:function(e,t,r,i){var a=this,o=new n.FileLoader(a.manager);o.setPath(a.path),o.setRequestHeader(a.requestHeader),o.setWithCredentials(a.withCredentials),o.load(e,(function(r){try{t(a.parse(r))}catch(n){i?i(n):console.error(n),a.manager.itemError(e)}}),r,i)},parse:function(e){var t=this;function r(e,t,r,n,a,o,s,u){if(0!=t&&0!=r){n=n*Math.PI/180,t=Math.abs(t),r=Math.abs(r);var c=(s.x-u.x)/2,l=(s.y-u.y)/2,p=Math.cos(n)*c+Math.sin(n)*l,h=-Math.sin(n)*c+Math.cos(n)*l,f=t*t,d=r*r,m=p*p,v=h*h,g=m/f+v/d;if(g>1){var y=Math.sqrt(g);f=(t*=y)*t,d=(r*=y)*r}var T=f*v+d*m,E=(f*d-T)/T,A=Math.sqrt(Math.max(0,E));a===o&&(A=-A);var x=A*t*h/r,b=-A*r*p/t,R=Math.cos(n)*x-Math.sin(n)*b+(s.x+u.x)/2,w=Math.sin(n)*x+Math.cos(n)*b+(s.y+u.y)/2,N=i(1,0,(p-x)/t,(h-b)/r),S=i((p-x)/t,(h-b)/r,(-p-x)/t,(-h-b)/r)%(2*Math.PI);e.currentPath.absellipse(R,w,t,r,N,N+S,0===o,n)}else e.lineTo(u.x,u.y)}function i(e,t,r,n){var i=e*r+t*n,a=Math.sqrt(e*e+t*t)*Math.sqrt(r*r+n*n),o=Math.acos(Math.max(-1,Math.min(1,i/a)));return e*n-t*r<0&&(o=-o),o}function a(e,t){t=Object.assign({},t);var r={};if(e.hasAttribute("class"))for(var n=e.getAttribute("class").split(/\s/).filter(Boolean).map((e=>e.trim())),i=0;i<n.length;i++)r=Object.assign(r,d["."+n[i]]);function a(n,i,a){void 0===a&&(a=function(e){return e.startsWith("url")&&console.warn("SVGLoader: url access in attributes is not implemented."),e}),e.hasAttribute(n)&&(t[i]=a(e.getAttribute(n))),r[n]&&(t[i]=a(r[n])),e.style&&""!==e.style[n]&&(t[i]=a(e.style[n]))}function o(e){return Math.max(0,Math.min(1,l(e)))}function s(e){return Math.max(0,l(e))}return e.hasAttribute("id")&&(r=Object.assign(r,d["#"+e.getAttribute("id")])),a("fill","fill"),a("fill-opacity","fillOpacity",o),a("opacity","opacity",o),a("stroke","stroke"),a("stroke-opacity","strokeOpacity",o),a("stroke-width","strokeWidth",s),a("stroke-linejoin","strokeLineJoin"),a("stroke-linecap","strokeLineCap"),a("stroke-miterlimit","strokeMiterLimit",s),a("visibility","visibility"),t}function o(e,t){return e-(t-e)}function s(e){if("string"!==typeof e)throw new TypeError("Invalid input: "+typeof e);var t={SEPARATOR:/[ \t\r\n\,.\-+]/,WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i},r=0,n=!0,i=[],a="",o="";function s(e,t,r){var n=new SyntaxError('Unexpected character "'+e+'" at index '+t+".");throw n.partial=r,n}function u(){""!==a&&(""===o?i.push(Number(a)):i.push(Number(a)*Math.pow(10,Number(o)))),a="",o=""}var c,l=0,p=e.length;for(l=0;l<p;l++){if(c=e[l],0===r){if(t.WHITESPACE.test(c))continue;if(t.DIGIT.test(c)||t.SIGN.test(c)){r=1,a=c;continue}if(t.POINT.test(c)){r=2,a=c;continue}t.COMMA.test(c)&&(n&&s(c,l,i),n=!0)}if(1===r){if(t.DIGIT.test(c)){a+=c;continue}if(t.POINT.test(c)){a+=c,r=2;continue}if(t.EXP.test(c)){r=3;continue}t.SIGN.test(c)&&1===a.length&&t.SIGN.test(a[0])&&s(c,l,i)}if(2===r){if(t.DIGIT.test(c)){a+=c;continue}if(t.EXP.test(c)){r=3;continue}t.POINT.test(c)&&"."===a[a.length-1]&&s(c,l,i)}if(3==r){if(t.DIGIT.test(c)){o+=c;continue}if(t.SIGN.test(c)){if(""===o){o+=c;continue}1===o.length&&t.SIGN.test(o)&&s(c,l,i)}}t.WHITESPACE.test(c)?(u(),r=0,n=!1):t.COMMA.test(c)?(u(),r=0,n=!0):t.SIGN.test(c)?(u(),r=1,a=c):t.POINT.test(c)?(u(),r=2,a=c):s(c,l,i)}return u(),i}var u=["mm","cm","in","pt","pc","px"],c={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:12,pc:1,px:-1},px:{px:1}};function l(e){var r="px";if("string"===typeof e||e instanceof String)for(var n=0,i=u.length;n<i;n++){var a=u[n];if(e.endsWith(a)){r=a,e=e.substring(0,e.length-a.length);break}}var o=void 0;return"px"===r&&"px"!==t.defaultUnit?o=c.in[t.defaultUnit]/t.defaultDPI:(o=c[r][t.defaultUnit])<0&&(o=c[r].in*t.defaultDPI),o*parseFloat(e)}function p(e){var t=e.elements;return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function h(e){var t=e.elements;return Math.sqrt(t[3]*t[3]+t[4]*t[4])}var f=[],d={},m=[],v=new n.Matrix3,g=new n.Matrix3,y=new n.Matrix3,T=new n.Matrix3,E=new n.Vector2,A=new n.Vector3,x=new n.Matrix3,b=(new DOMParser).parseFromString(e,"image/svg+xml");return function e(t,i){if(1===t.nodeType){var u=function(e){if(!(e.hasAttribute("transform")||"use"===e.nodeName&&(e.hasAttribute("x")||e.hasAttribute("y"))))return null;var t=function(e){var t=new n.Matrix3,r=v;if("use"===e.nodeName&&(e.hasAttribute("x")||e.hasAttribute("y"))){var i=l(e.getAttribute("x")),a=l(e.getAttribute("y"));t.translate(i,a)}if(e.hasAttribute("transform"))for(var o=e.getAttribute("transform").split(")"),u=o.length-1;u>=0;u--){var c=o[u].trim();if(""!==c){var p=c.indexOf("("),h=c.length;if(p>0&&p<h){var f=c.substr(0,p),d=s(c.substr(p+1,h-p-1));switch(r.identity(),f){case"translate":if(d.length>=1){a=i=d[0];d.length>=2&&(a=d[1]),r.translate(i,a)}break;case"rotate":if(d.length>=1){var m=0,E=0,A=0;m=-d[0]*Math.PI/180,d.length>=3&&(E=d[1],A=d[2]),g.identity().translate(-E,-A),y.identity().rotate(m),T.multiplyMatrices(y,g),g.identity().translate(E,A),r.multiplyMatrices(g,T)}break;case"scale":if(d.length>=1){var x=d[0],b=x;d.length>=2&&(b=d[1]),r.scale(x,b)}break;case"skewX":1===d.length&&r.set(1,Math.tan(d[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":1===d.length&&r.set(1,0,0,Math.tan(d[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":6===d.length&&r.set(d[0],d[2],d[4],d[1],d[3],d[5],0,0,1)}}t.premultiply(r)}}return t}(e);m.length>0&&t.premultiply(m[m.length-1]);return x.copy(t),m.push(t),t}(t),c=!0,b=null;switch(t.nodeName){case"svg":break;case"style":!function(e){if(!e.sheet||!e.sheet.cssRules||!e.sheet.cssRules.length)return;for(var t=0;t<e.sheet.cssRules.length;t++){var r=e.sheet.cssRules[t];if(1===r.type)for(var n=r.selectorText.split(/,/gm).filter(Boolean).map((e=>e.trim())),i=0;i<n.length;i++)d[n[i]]=Object.assign(d[n[i]]||{},r.style)}}(t);break;case"g":i=a(t,i);break;case"path":i=a(t,i),t.hasAttribute("d")&&(b=function(e){for(var t=new n.ShapePath,i=new n.Vector2,a=new n.Vector2,u=new n.Vector2,c=!0,l=!1,p=e.getAttribute("d").match(/[a-df-z][^a-df-z]*/gi),h=0,f=p.length;h<f;h++){var d=p[h],m=d.charAt(0),v=d.substr(1).trim();switch(!0===c&&(l=!0,c=!1),m){case"M":for(var g=0,y=(x=s(v)).length;g<y;g+=2)i.x=x[g+0],i.y=x[g+1],a.x=i.x,a.y=i.y,0===g?t.moveTo(i.x,i.y):t.lineTo(i.x,i.y),0===g&&!0===l&&u.copy(i);break;case"H":for(g=0,y=(x=s(v)).length;g<y;g++)i.x=x[g],a.x=i.x,a.y=i.y,t.lineTo(i.x,i.y),0===g&&!0===l&&u.copy(i);break;case"V":for(g=0,y=(x=s(v)).length;g<y;g++)i.y=x[g],a.x=i.x,a.y=i.y,t.lineTo(i.x,i.y),0===g&&!0===l&&u.copy(i);break;case"L":for(g=0,y=(x=s(v)).length;g<y;g+=2)i.x=x[g+0],i.y=x[g+1],a.x=i.x,a.y=i.y,t.lineTo(i.x,i.y),0===g&&!0===l&&u.copy(i);break;case"C":for(g=0,y=(x=s(v)).length;g<y;g+=6)t.bezierCurveTo(x[g+0],x[g+1],x[g+2],x[g+3],x[g+4],x[g+5]),a.x=x[g+2],a.y=x[g+3],i.x=x[g+4],i.y=x[g+5],0===g&&!0===l&&u.copy(i);break;case"S":for(g=0,y=(x=s(v)).length;g<y;g+=4)t.bezierCurveTo(o(i.x,a.x),o(i.y,a.y),x[g+0],x[g+1],x[g+2],x[g+3]),a.x=x[g+0],a.y=x[g+1],i.x=x[g+2],i.y=x[g+3],0===g&&!0===l&&u.copy(i);break;case"Q":for(g=0,y=(x=s(v)).length;g<y;g+=4)t.quadraticCurveTo(x[g+0],x[g+1],x[g+2],x[g+3]),a.x=x[g+0],a.y=x[g+1],i.x=x[g+2],i.y=x[g+3],0===g&&!0===l&&u.copy(i);break;case"T":for(g=0,y=(x=s(v)).length;g<y;g+=2){var T=o(i.x,a.x),E=o(i.y,a.y);t.quadraticCurveTo(T,E,x[g+0],x[g+1]),a.x=T,a.y=E,i.x=x[g+0],i.y=x[g+1],0===g&&!0===l&&u.copy(i)}break;case"A":for(g=0,y=(x=s(v)).length;g<y;g+=7)if(x[g+5]!=i.x||x[g+6]!=i.y){var A=i.clone();i.x=x[g+5],i.y=x[g+6],a.x=i.x,a.y=i.y,r(t,x[g],x[g+1],x[g+2],x[g+3],x[g+4],A,i),0===g&&!0===l&&u.copy(i)}break;case"m":for(g=0,y=(x=s(v)).length;g<y;g+=2)i.x+=x[g+0],i.y+=x[g+1],a.x=i.x,a.y=i.y,0===g?t.moveTo(i.x,i.y):t.lineTo(i.x,i.y),0===g&&!0===l&&u.copy(i);break;case"h":for(g=0,y=(x=s(v)).length;g<y;g++)i.x+=x[g],a.x=i.x,a.y=i.y,t.lineTo(i.x,i.y),0===g&&!0===l&&u.copy(i);break;case"v":for(g=0,y=(x=s(v)).length;g<y;g++)i.y+=x[g],a.x=i.x,a.y=i.y,t.lineTo(i.x,i.y),0===g&&!0===l&&u.copy(i);break;case"l":for(g=0,y=(x=s(v)).length;g<y;g+=2)i.x+=x[g+0],i.y+=x[g+1],a.x=i.x,a.y=i.y,t.lineTo(i.x,i.y),0===g&&!0===l&&u.copy(i);break;case"c":for(g=0,y=(x=s(v)).length;g<y;g+=6)t.bezierCurveTo(i.x+x[g+0],i.y+x[g+1],i.x+x[g+2],i.y+x[g+3],i.x+x[g+4],i.y+x[g+5]),a.x=i.x+x[g+2],a.y=i.y+x[g+3],i.x+=x[g+4],i.y+=x[g+5],0===g&&!0===l&&u.copy(i);break;case"s":for(g=0,y=(x=s(v)).length;g<y;g+=4)t.bezierCurveTo(o(i.x,a.x),o(i.y,a.y),i.x+x[g+0],i.y+x[g+1],i.x+x[g+2],i.y+x[g+3]),a.x=i.x+x[g+0],a.y=i.y+x[g+1],i.x+=x[g+2],i.y+=x[g+3],0===g&&!0===l&&u.copy(i);break;case"q":for(g=0,y=(x=s(v)).length;g<y;g+=4)t.quadraticCurveTo(i.x+x[g+0],i.y+x[g+1],i.x+x[g+2],i.y+x[g+3]),a.x=i.x+x[g+0],a.y=i.y+x[g+1],i.x+=x[g+2],i.y+=x[g+3],0===g&&!0===l&&u.copy(i);break;case"t":for(g=0,y=(x=s(v)).length;g<y;g+=2){T=o(i.x,a.x),E=o(i.y,a.y);t.quadraticCurveTo(T,E,i.x+x[g+0],i.y+x[g+1]),a.x=T,a.y=E,i.x=i.x+x[g+0],i.y=i.y+x[g+1],0===g&&!0===l&&u.copy(i)}break;case"a":var x;for(g=0,y=(x=s(v)).length;g<y;g+=7)if(0!=x[g+5]||0!=x[g+6]){A=i.clone();i.x+=x[g+5],i.y+=x[g+6],a.x=i.x,a.y=i.y,r(t,x[g],x[g+1],x[g+2],x[g+3],x[g+4],A,i),0===g&&!0===l&&u.copy(i)}break;case"Z":case"z":t.currentPath.autoClose=!0,t.currentPath.curves.length>0&&(i.copy(u),t.currentPath.currentPoint.copy(i),c=!0);break;default:console.warn(d)}l=!1}return t}(t));break;case"rect":i=a(t,i),b=function(e){var t=l(e.getAttribute("x")||0),r=l(e.getAttribute("y")||0),i=l(e.getAttribute("rx")||0),a=l(e.getAttribute("ry")||0),o=l(e.getAttribute("width")),s=l(e.getAttribute("height")),u=new n.ShapePath;u.moveTo(t+2*i,r),u.lineTo(t+o-2*i,r),(0!==i||0!==a)&&u.bezierCurveTo(t+o,r,t+o,r,t+o,r+2*a);u.lineTo(t+o,r+s-2*a),(0!==i||0!==a)&&u.bezierCurveTo(t+o,r+s,t+o,r+s,t+o-2*i,r+s);u.lineTo(t+2*i,r+s),(0!==i||0!==a)&&u.bezierCurveTo(t,r+s,t,r+s,t,r+s-2*a);u.lineTo(t,r+2*a),(0!==i||0!==a)&&u.bezierCurveTo(t,r,t,r,t+2*i,r);return u}(t);break;case"polygon":i=a(t,i),b=function(e){function t(e,t,r){var n=l(t),o=l(r);0===a?i.moveTo(n,o):i.lineTo(n,o),a++}var r=/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,i=new n.ShapePath,a=0;return e.getAttribute("points").replace(r,t),i.currentPath.autoClose=!0,i}(t);break;case"polyline":i=a(t,i),b=function(e){function t(e,t,r){var n=l(t),o=l(r);0===a?i.moveTo(n,o):i.lineTo(n,o),a++}var r=/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,i=new n.ShapePath,a=0;return e.getAttribute("points").replace(r,t),i.currentPath.autoClose=!1,i}(t);break;case"circle":i=a(t,i),b=function(e){var t=l(e.getAttribute("cx")),r=l(e.getAttribute("cy")),i=l(e.getAttribute("r")),a=new n.Path;a.absarc(t,r,i,0,2*Math.PI);var o=new n.ShapePath;return o.subPaths.push(a),o}(t);break;case"ellipse":i=a(t,i),b=function(e){var t=l(e.getAttribute("cx")),r=l(e.getAttribute("cy")),i=l(e.getAttribute("rx")),a=l(e.getAttribute("ry")),o=new n.Path;o.absellipse(t,r,i,a,0,2*Math.PI);var s=new n.ShapePath;return s.subPaths.push(o),s}(t);break;case"line":i=a(t,i),b=function(e){var t=l(e.getAttribute("x1")),r=l(e.getAttribute("y1")),i=l(e.getAttribute("x2")),a=l(e.getAttribute("y2")),o=new n.ShapePath;return o.moveTo(t,r),o.lineTo(i,a),o.currentPath.autoClose=!1,o}(t);break;case"defs":c=!1;break;case"use":i=a(t,i);var R=t.href.baseVal.substring(1),w=t.viewportElement.getElementById(R);w?e(w,i):console.warn("SVGLoader: 'use node' references non-existent node id: "+R)}if(b&&(void 0!==i.fill&&"none"!==i.fill&&b.color.setStyle(i.fill),function(e,t){function r(e){A.set(e.x,e.y,1).applyMatrix3(t),e.set(A.x,A.y)}for(var n=function(e){return 0!==e.elements[1]||0!==e.elements[3]}(t),i=e.subPaths,a=0,o=i.length;a<o;a++)for(var s=i[a].curves,u=0;u<s.length;u++){var c=s[u];c.isLineCurve?(r(c.v1),r(c.v2)):c.isCubicBezierCurve?(r(c.v0),r(c.v1),r(c.v2),r(c.v3)):c.isQuadraticBezierCurve?(r(c.v0),r(c.v1),r(c.v2)):c.isEllipseCurve&&(n&&console.warn("SVGLoader: Elliptic arc or ellipse rotation or skewing is not implemented."),E.set(c.aX,c.aY),r(E),c.aX=E.x,c.aY=E.y,c.xRadius*=p(t),c.yRadius*=h(t))}}(b,x),f.push(b),b.userData={node:t,style:i}),c)for(var N=t.childNodes,S=0;S<N.length;S++)e(N[S],i);u&&(m.pop(),m.length>0?x.copy(m[m.length-1]):x.identity())}}(b.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4}),{paths:f,xml:b.documentElement}}}),i.getStrokeStyle=function(e,t,r,n,i){return{strokeColor:t=void 0!==t?t:"#000",strokeWidth:e=void 0!==e?e:1,strokeLineJoin:r=void 0!==r?r:"miter",strokeLineCap:n=void 0!==n?n:"butt",strokeMiterLimit:i=void 0!==i?i:4}},i.pointsToStroke=function(e,t,r,a){var o=[],s=[],u=[];if(0===i.pointsToStrokeWithBuffers(e,t,r,a,o,s,u))return null;var c=new n.BufferGeometry;return c.setAttribute("position",new n.Float32BufferAttribute(o,3)),c.setAttribute("normal",new n.Float32BufferAttribute(s,3)),c.setAttribute("uv",new n.Float32BufferAttribute(u,2)),c},i.pointsToStrokeWithBuffers=function(){var e=new n.Vector2,t=new n.Vector2,r=new n.Vector2,i=new n.Vector2,a=new n.Vector2,o=new n.Vector2,s=new n.Vector2,u=new n.Vector2,c=new n.Vector2,l=new n.Vector2,p=new n.Vector2,h=new n.Vector2,f=new n.Vector2,d=new n.Vector2,m=new n.Vector2,v=new n.Vector2,g=new n.Vector2;return function(n,y,T,E,A,x,b,R){T=void 0!==T?T:12,E=void 0!==E?E:.001,R=void 0!==R?R:0;var w=(n=function(e){for(var t=!1,r=1,n=e.length-1;r<n;r++)if(e[r].distanceTo(e[r+1])<E){t=!0;break}if(!t)return e;var i=[];i.push(e[0]);for(r=1,n=e.length-1;r<n;r++)e[r].distanceTo(e[r+1])>=E&&i.push(e[r]);return i.push(e[e.length-1]),i}(n)).length;if(w<2)return 0;var N,S,k,_,L,I=n[0].equals(n[w-1]),O=n[0],M=y.strokeWidth/2,C=1/(w-1),P=0,F=!1,U=0,D=3*R,B=2*R;$(n[0],n[1],e).multiplyScalar(M),u.copy(n[0]).sub(e),c.copy(n[0]).add(e),l.copy(u),p.copy(c);for(var V=1;V<w;V++){N=n[V],S=V===w-1?I?n[1]:void 0:n[V+1];var j=e;$(O,N,j),r.copy(j).multiplyScalar(M),h.copy(N).sub(r),f.copy(N).add(r);var G=P+C;if(k=!1,void 0!==S){$(N,S,t),r.copy(t).multiplyScalar(M),d.copy(N).sub(r),m.copy(N).add(r),_=!0,r.subVectors(S,O),j.dot(r)<0&&(_=!1),1===V&&(F=_),r.subVectors(S,N),r.normalize();var H=Math.abs(j.dot(r));if(0!==H){var z=M/H;r.multiplyScalar(-z),i.subVectors(N,O),a.copy(i).setLength(z).add(r),v.copy(a).negate();var W=a.length(),K=i.length();i.divideScalar(K),o.subVectors(S,N);var X=o.length();switch(o.divideScalar(X),i.dot(v)<K&&o.dot(v)<X&&(k=!0),g.copy(a).add(N),v.add(N),L=!1,k?_?(m.copy(v),f.copy(v)):(d.copy(v),h.copy(v)):ee(),y.strokeLineJoin){case"bevel":te(_,k,G);break;case"round":re(_,k),_?Q(N,h,d,G,0):Q(N,m,f,G,1);break;case"miter":case"miter-clip":default:var Y=M*y.strokeMiterLimit/W;if(Y<1){if("miter-clip"!==y.strokeLineJoin){te(_,k,G);break}re(_,k),_?(o.subVectors(g,h).multiplyScalar(Y).add(h),s.subVectors(g,d).multiplyScalar(Y).add(d),J(h,G,0),J(o,G,0),J(N,G,.5),J(N,G,.5),J(o,G,0),J(s,G,0),J(N,G,.5),J(s,G,0),J(d,G,0)):(o.subVectors(g,f).multiplyScalar(Y).add(f),s.subVectors(g,m).multiplyScalar(Y).add(m),J(f,G,1),J(o,G,1),J(N,G,.5),J(N,G,.5),J(o,G,1),J(s,G,1),J(N,G,.5),J(s,G,1),J(m,G,1))}else k?(_?(J(c,P,1),J(u,P,0),J(g,G,0),J(c,P,1),J(g,G,0),J(v,G,1)):(J(c,P,1),J(u,P,0),J(g,G,1),J(u,P,0),J(v,G,0),J(g,G,1)),_?d.copy(g):m.copy(g)):_?(J(h,G,0),J(g,G,0),J(N,G,.5),J(N,G,.5),J(g,G,0),J(d,G,0)):(J(f,G,1),J(g,G,1),J(N,G,.5),J(N,G,.5),J(g,G,1),J(m,G,1)),L=!0}}else ee()}else ee();I||V!==w-1||ne(n[0],l,p,_,!0,P),P=G,O=N,u.copy(d),c.copy(m)}if(I){if(k&&A){var q=g,Z=v;F!==_&&(q=v,Z=g),_?(L||F)&&(Z.toArray(A,0),Z.toArray(A,9),L&&q.toArray(A,3)):!L&&F||(Z.toArray(A,3),Z.toArray(A,9),L&&q.toArray(A,0))}}else ne(N,h,f,_,!1,G);return U;function $(e,t,r){return r.subVectors(t,e),r.set(-r.y,r.x).normalize()}function J(e,t,r){A&&(A[D]=e.x,A[D+1]=e.y,A[D+2]=0,x&&(x[D]=0,x[D+1]=0,x[D+2]=1),D+=3,b&&(b[B]=t,b[B+1]=r,B+=2)),U+=3}function Q(n,a,o,s,u){e.copy(a).sub(n).normalize(),t.copy(o).sub(n).normalize();var c=Math.PI,l=e.dot(t);Math.abs(l)<1&&(c=Math.abs(Math.acos(l))),c/=T,r.copy(a);for(var p=0,h=T-1;p<h;p++)i.copy(r).rotateAround(n,c),J(r,s,u),J(i,s,u),J(n,s,.5),r.copy(i);J(i,s,u),J(o,s,u),J(n,s,.5)}function ee(){J(c,P,1),J(u,P,0),J(h,G,0),J(c,P,1),J(h,G,1),J(f,G,0)}function te(e,t,r){t?e?(J(c,P,1),J(u,P,0),J(h,G,0),J(c,P,1),J(h,G,0),J(v,G,1),J(h,r,0),J(d,r,0),J(v,r,.5)):(J(c,P,1),J(u,P,0),J(f,G,1),J(u,P,0),J(v,G,0),J(f,G,1),J(f,r,1),J(m,r,0),J(v,r,.5)):e?(J(h,r,0),J(d,r,0),J(N,r,.5)):(J(f,r,1),J(m,r,0),J(N,r,.5))}function re(e,t){t&&(e?(J(c,P,1),J(u,P,0),J(h,G,0),J(c,P,1),J(h,G,0),J(v,G,1),J(h,P,0),J(N,G,.5),J(v,G,1),J(N,G,.5),J(d,P,0),J(v,G,1)):(J(c,P,1),J(u,P,0),J(f,G,1),J(u,P,0),J(v,G,0),J(f,G,1),J(f,P,1),J(v,G,0),J(N,G,.5),J(N,G,.5),J(v,G,0),J(m,P,1)))}function ne(n,a,o,s,u,c){switch(y.strokeLineCap){case"round":u?Q(n,o,a,c,.5):Q(n,a,o,c,.5);break;case"square":if(u)e.subVectors(a,n),t.set(e.y,-e.x),r.addVectors(e,t).add(n),i.subVectors(t,e).add(n),s?(r.toArray(A,3),i.toArray(A,0),i.toArray(A,9)):(r.toArray(A,3),r.toArray(A,9),i.toArray(A,0));else{e.subVectors(o,n),t.set(e.y,-e.x),r.addVectors(e,t).add(n),i.subVectors(t,e).add(n);var l=A.length;s?(r.toArray(A,l-3),i.toArray(A,l-6),i.toArray(A,l-12)):(r.toArray(A,l-6),i.toArray(A,l-3),i.toArray(A,l-12))}}}}}()},7412:function(e,t,r){"use strict";r.d(t,{W:function(){return a}});var n=r(2212),i=r(8988),a=function(){if("undefined"===typeof i.F)throw Error("THREE.VRMLLoader: External library chevrotain.min.js required.");function e(e){n.Loader.call(this,e)}function t(e){this.lexer=new i.F.Lexer(e)}function r(e){i.F.Parser.call(this,e);var t=this,r=e.Version,n=e.LCurly,a=e.RCurly,o=e.LSquare,s=e.RSquare,u=e.Identifier,c=e.RouteIdentifier,l=e.StringLiteral,p=e.HexLiteral,h=e.NumberLiteral,f=e.TrueLiteral,d=e.FalseLiteral,m=e.NullLiteral,v=e.DEF,g=e.USE,y=e.ROUTE,T=e.TO,E=e.NodeName;t.RULE("vrml",(function(){t.SUBRULE(t.version),t.AT_LEAST_ONE((function(){t.SUBRULE(t.node)})),t.MANY((function(){t.SUBRULE(t.route)}))})),t.RULE("version",(function(){t.CONSUME(r)})),t.RULE("node",(function(){t.OPTION((function(){t.SUBRULE(t.def)})),t.CONSUME(E),t.CONSUME(n),t.MANY((function(){t.SUBRULE(t.field)})),t.CONSUME(a)})),t.RULE("field",(function(){t.CONSUME(u),t.OR2([{ALT:function(){t.SUBRULE(t.singleFieldValue)}},{ALT:function(){t.SUBRULE(t.multiFieldValue)}}])})),t.RULE("def",(function(){t.CONSUME(v),t.OR([{ALT:function(){t.CONSUME(u)}},{ALT:function(){t.CONSUME(E)}}])})),t.RULE("use",(function(){t.CONSUME(g),t.OR([{ALT:function(){t.CONSUME(u)}},{ALT:function(){t.CONSUME(E)}}])})),t.RULE("singleFieldValue",(function(){t.AT_LEAST_ONE((function(){t.OR([{ALT:function(){t.SUBRULE(t.node)}},{ALT:function(){t.SUBRULE(t.use)}},{ALT:function(){t.CONSUME(l)}},{ALT:function(){t.CONSUME(p)}},{ALT:function(){t.CONSUME(h)}},{ALT:function(){t.CONSUME(f)}},{ALT:function(){t.CONSUME(d)}},{ALT:function(){t.CONSUME(m)}}])}))})),t.RULE("multiFieldValue",(function(){t.CONSUME(o),t.MANY((function(){t.OR([{ALT:function(){t.SUBRULE(t.node)}},{ALT:function(){t.SUBRULE(t.use)}},{ALT:function(){t.CONSUME(l)}},{ALT:function(){t.CONSUME(p)}},{ALT:function(){t.CONSUME(h)}},{ALT:function(){t.CONSUME(m)}}])})),t.CONSUME(s)})),t.RULE("route",(function(){t.CONSUME(y),t.CONSUME(c),t.CONSUME(T),t.CONSUME2(c)})),this.performSelfAnalysis()}function a(e,t,r){this.a=e,this.b=t,this.c=r,this.normal=new n.Vector3}e.prototype=Object.assign(Object.create(n.Loader.prototype),{constructor:e,load:function(e,t,r,i){var a=this,o=""===a.path?n.LoaderUtils.extractUrlBase(e):a.path,s=new n.FileLoader(a.manager);s.setPath(a.path),s.setRequestHeader(a.requestHeader),s.setWithCredentials(a.withCredentials),s.load(e,(function(r){try{t(a.parse(r,o))}catch(n){i?i(n):console.error(n),a.manager.itemError(e)}}),r,i)},parse:function(e,s){var u={};function c(e){e.DEF&&(u[e.DEF]=e);for(var t=e.fields,r=0,n=t.length;r<n;r++){var i=t[r];if("node"===i.type)for(var a=i.values,o=0,s=a.length;o<s;o++)c(a[o])}}function l(e){return e.USE?function(e){var t=l(u[e]);return t.isObject3D||t.isMaterial?t.clone():t}(e.USE):(void 0!==e.build||(e.build=function(e){var t,r=e.name;switch(r){case"Group":case"Transform":case"Collision":t=function(e){for(var t=new n.Group,r=e.fields,i=0,a=r.length;i<a;i++){var o=r[i],s=o.name,u=o.values;switch(s){case"bboxCenter":case"bboxSize":case"center":break;case"children":f(u,t);break;case"collide":break;case"rotation":var c=new n.Vector3(u[0],u[1],u[2]),l=u[3];t.quaternion.setFromAxisAngle(c,l);break;case"scale":t.scale.set(u[0],u[1],u[2]);break;case"scaleOrientation":break;case"translation":t.position.set(u[0],u[1],u[2]);break;case"proxy":break;default:console.warn("THREE.VRMLLoader: Unknown field:",s)}}return t}(e);break;case"Background":t=function(e){for(var t,r,i,a,o=new n.Group,s=e.fields,u=0,c=s.length;u<c;u++){var l=s[u],p=l.name,h=l.values;switch(p){case"groundAngle":t=h;break;case"groundColor":r=h;break;case"backUrl":case"bottomUrl":case"frontUrl":case"leftUrl":case"rightUrl":case"topUrl":break;case"skyAngle":i=h;break;case"skyColor":a=h;break;default:console.warn("THREE.VRMLLoader: Unknown field:",p)}}var f=1e4;if(a){var d=new n.SphereGeometry(f,32,16),m=new n.MeshBasicMaterial({fog:!1,side:n.BackSide,depthWrite:!1,depthTest:!1});a.length>3?(C(d,f,i,M(a),!0),m.vertexColors=!0):m.color.setRGB(a[0],a[1],a[2]);var v=new n.Mesh(d,m);o.add(v)}if(r&&r.length>0){var g=new n.SphereGeometry(f,32,16,0,2*Math.PI,.5*Math.PI,1.5*Math.PI),y=new n.MeshBasicMaterial({fog:!1,side:n.BackSide,vertexColors:!0,depthWrite:!1,depthTest:!1});C(g,f,t,M(r),!1);var T=new n.Mesh(g,y);o.add(T)}return o.renderOrder=-1/0,o}(e);break;case"Shape":t=function(e){for(var t,r,i=e.fields,a=new n.MeshBasicMaterial({color:0}),o=0,s=i.length;o<s;o++){var u=i[o],c=u.name,p=u.values;switch(c){case"appearance":null!==p[0]&&(a=l(p[0]));break;case"geometry":null!==p[0]&&(t=l(p[0]));break;default:console.warn("THREE.VRMLLoader: Unknown field:",c)}}if(t&&t.attributes.position){var h=t._type;if("points"===h){var f=new n.PointsMaterial({color:16777215});void 0!==t.attributes.color?f.vertexColors=!0:a.isMeshPhongMaterial&&f.color.copy(a.emissive),r=new n.Points(t,f)}else if("line"===h){var d=new n.LineBasicMaterial({color:16777215});void 0!==t.attributes.color?d.vertexColors=!0:a.isMeshPhongMaterial&&d.color.copy(a.emissive),r=new n.LineSegments(t,d)}else void 0!==t._solid&&(a.side=t._solid?n.FrontSide:n.DoubleSide),void 0!==t.attributes.color&&(a.vertexColors=!0),r=new n.Mesh(t,a)}else(r=new n.Object3D).visible=!1;return r}(e);break;case"Appearance":t=function(e){for(var t,r=new n.MeshPhongMaterial,i=e.fields,a=0,s=i.length;a<s;a++){var u=i[a],c=u.name,p=u.values;switch(c){case"material":if(null!==p[0]){var h=l(p[0]);h.diffuseColor&&r.color.copy(h.diffuseColor),h.emissiveColor&&r.emissive.copy(h.emissiveColor),h.shininess&&(r.shininess=h.shininess),h.specularColor&&r.specular.copy(h.specularColor),h.transparency&&(r.opacity=1-h.transparency),h.transparency>0&&(r.transparent=!0)}else r=new n.MeshBasicMaterial({color:0});break;case"texture":var f=p[0];null!==f&&("ImageTexture"!==f.name&&"PixelTexture"!==f.name||(r.map=l(f)));break;case"textureTransform":null!==p[0]&&(t=l(p[0]));break;default:console.warn("THREE.VRMLLoader: Unknown field:",c)}}if(r.map){if(r.map.__type){switch(r.map.__type){case o.INTENSITY_ALPHA:r.opacity=1;break;case o.RGB:r.color.set(16777215);break;case o.RGBA:r.color.set(16777215),r.opacity=1}delete r.map.__type}t&&(r.map.center.copy(t.center),r.map.rotation=t.rotation,r.map.repeat.copy(t.scale),r.map.offset.copy(t.translation))}return r}(e);break;case"Material":t=function(e){for(var t={},r=e.fields,i=0,a=r.length;i<a;i++){var o=r[i],s=o.name,u=o.values;switch(s){case"ambientIntensity":break;case"diffuseColor":t.diffuseColor=new n.Color(u[0],u[1],u[2]);break;case"emissiveColor":t.emissiveColor=new n.Color(u[0],u[1],u[2]);break;case"shininess":t.shininess=u[0];break;case"specularColor":t.emissiveColor=new n.Color(u[0],u[1],u[2]);break;case"transparency":t.transparency=u[0];break;default:console.warn("THREE.VRMLLoader: Unknown field:",s)}}return t}(e);break;case"ImageTexture":t=function(e){for(var t,r=n.RepeatWrapping,i=n.RepeatWrapping,a=e.fields,o=0,s=a.length;o<s;o++){var u=a[o],c=u.name,l=u.values;switch(c){case"url":var p=l[0];p&&(t=P.load(p));break;case"repeatS":!1===l[0]&&(r=n.ClampToEdgeWrapping);break;case"repeatT":!1===l[0]&&(i=n.ClampToEdgeWrapping);break;default:console.warn("THREE.VRMLLoader: Unknown field:",c)}}t&&(t.wrapS=r,t.wrapT=i);return t}(e);break;case"PixelTexture":t=function(e){for(var t,r=n.RepeatWrapping,i=n.RepeatWrapping,a=e.fields,o=0,s=a.length;o<s;o++){var u=a[o],c=u.name,l=u.values;switch(c){case"image":for(var f=l[0],d=l[1],m=l[2],v=2===m||4===m,g=h(m),y=new Uint8Array(f*d*(!0===v?4:3)),T={r:0,g:0,b:0,a:0},E=3,A=0,x=l.length;E<x;E++,A++){var b;if(p(l[E],g,T),!0===v)y[(b=4*A)+0]=T.r,y[b+1]=T.g,y[b+2]=T.b,y[b+3]=T.a;else y[(b=3*A)+0]=T.r,y[b+1]=T.g,y[b+2]=T.b}(t=new n.DataTexture(y,f,d,!0===v?n.RGBAFormat:n.RGBFormat)).__type=g;break;case"repeatS":!1===l[0]&&(r=n.ClampToEdgeWrapping);break;case"repeatT":!1===l[0]&&(i=n.ClampToEdgeWrapping);break;default:console.warn("THREE.VRMLLoader: Unknown field:",c)}}t&&(t.wrapS=r,t.wrapT=i);return t}(e);break;case"TextureTransform":t=function(e){for(var t={center:new n.Vector2,rotation:new n.Vector2,scale:new n.Vector2,translation:new n.Vector2},r=e.fields,i=0,a=r.length;i<a;i++){var o=r[i],s=o.name,u=o.values;switch(s){case"center":t.center.set(u[0],u[1]);break;case"rotation":t.rotation=u[0];break;case"scale":t.scale.set(u[0],u[1]);break;case"translation":t.translation.set(u[0],u[1]);break;default:console.warn("THREE.VRMLLoader: Unknown field:",s)}}return t}(e);break;case"IndexedFaceSet":t=function(e){for(var t,r,i,a,o,s,u,c,p=!0,h=!0,f=0,g=!0,y=!0,T=e.fields,E=0,A=T.length;E<A;E++){var x=T[E],b=x.name,R=x.values;switch(b){case"color":var S=R[0];null!==S&&(t=l(S));break;case"coord":var _=R[0];null!==_&&(r=l(_));break;case"normal":var L=R[0];null!==L&&(i=l(L));break;case"texCoord":var O=R[0];null!==O&&(a=l(O));break;case"ccw":p=R[0];break;case"colorIndex":o=R;break;case"colorPerVertex":g=R[0];break;case"convex":break;case"coordIndex":s=R;break;case"creaseAngle":f=R[0];break;case"normalIndex":u=R;break;case"normalPerVertex":y=R[0];break;case"solid":h=R[0];break;case"texCoordIndex":c=R;break;default:console.warn("THREE.VRMLLoader: Unknown field:",b)}}if(void 0===s)return console.warn("THREE.VRMLLoader: Missing coordIndex."),new n.BufferGeometry;var M,C,P,F,U=d(s,p);if(t){if(!0===g)if(o&&o.length>0)C=w(U,d(o,p),t,3);else C=k(U,new n.Float32BufferAttribute(t,3));else if(o&&o.length>0)C=N(U,m(v(t,o),s));else C=N(U,m(t,s))}if(i){if(!0===y)if(u&&u.length>0)P=w(U,d(u,p),i,3);else P=k(U,new n.Float32BufferAttribute(i,3));else if(u&&u.length>0)P=N(U,m(v(i,u),s));else P=N(U,m(i,s))}else P=I(U,r,f);if(a){if(c&&c.length>0)F=w(U,d(c,p),a,2);else F=k(U,new n.Float32BufferAttribute(a,2))}var D=new n.BufferGeometry;M=k(U,new n.Float32BufferAttribute(r,3)),D.setAttribute("position",M),D.setAttribute("normal",P),C&&D.setAttribute("color",C);F&&D.setAttribute("uv",F);return D._solid=h,D._type="mesh",D}(e);break;case"IndexedLineSet":t=function(e){for(var t,r,i,a,o,s=!0,u=e.fields,c=0,p=u.length;c<p;c++){var h=u[c],f=h.name,d=h.values;switch(f){case"color":var m=d[0];null!==m&&(t=l(m));break;case"coord":var T=d[0];null!==T&&(r=l(T));break;case"colorIndex":i=d;break;case"colorPerVertex":s=d[0];break;case"coordIndex":a=d;break;default:console.warn("THREE.VRMLLoader: Unknown field:",f)}}var E=g(a);if(t){if(!0===s)if(i.length>0)o=w(E,g(i),t,3);else o=k(E,new n.Float32BufferAttribute(t,3));else if(i.length>0)o=S(E,y(v(t,i),a));else o=S(E,y(t,a))}var A=new n.BufferGeometry,x=k(E,new n.Float32BufferAttribute(r,3));A.setAttribute("position",x),o&&A.setAttribute("color",o);return A._type="line",A}(e);break;case"PointSet":t=function(e){for(var t,r,i=e.fields,a=0,o=i.length;a<o;a++){var s=i[a],u=s.name,c=s.values;switch(u){case"color":var p=c[0];null!==p&&(t=l(p));break;case"coord":var h=c[0];null!==h&&(r=l(h));break;default:console.warn("THREE.VRMLLoader: Unknown field:",u)}}var f;(f=new n.BufferGeometry).setAttribute("position",new n.Float32BufferAttribute(r,3)),t&&f.setAttribute("color",new n.Float32BufferAttribute(t,3));return f._type="points",f}(e);break;case"Box":t=function(e){for(var t=new n.Vector3(2,2,2),r=e.fields,i=0,a=r.length;i<a;i++){var o=r[i],s=o.name,u=o.values;switch(s){case"size":t.x=u[0],t.y=u[1],t.z=u[2];break;default:console.warn("THREE.VRMLLoader: Unknown field:",s)}}return new n.BoxGeometry(t.x,t.y,t.z)}(e);break;case"Cone":t=function(e){for(var t=1,r=2,i=!1,a=e.fields,o=0,s=a.length;o<s;o++){var u=a[o],c=u.name,l=u.values;switch(c){case"bottom":i=!l[0];break;case"bottomRadius":t=l[0];break;case"height":r=l[0];break;case"side":break;default:console.warn("THREE.VRMLLoader: Unknown field:",c)}}return new n.ConeGeometry(t,r,16,1,i)}(e);break;case"Cylinder":t=function(e){for(var t=1,r=2,i=e.fields,a=0,o=i.length;a<o;a++){var s=i[a],u=s.name,c=s.values;switch(u){case"bottom":break;case"radius":t=c[0];break;case"height":r=c[0];break;case"side":case"top":break;default:console.warn("THREE.VRMLLoader: Unknown field:",u)}}return new n.CylinderGeometry(t,t,r,16,1)}(e);break;case"Sphere":t=function(e){for(var t=1,r=e.fields,i=0,a=r.length;i<a;i++){var o=r[i],s=o.name,u=o.values;switch(s){case"radius":t=u[0];break;default:console.warn("THREE.VRMLLoader: Unknown field:",s)}}return new n.SphereGeometry(t,16,16)}(e);break;case"ElevationGrid":t=function(e){for(var t,r,i,a,o=!0,s=!0,u=!0,c=!0,p=0,h=2,f=2,d=1,m=1,v=e.fields,g=0,y=v.length;g<y;g++){var T=v[g],E=T.name,A=T.values;switch(E){case"color":var x=A[0];null!==x&&(t=l(x));break;case"normal":var b=A[0];null!==b&&(r=l(b));break;case"texCoord":var R=A[0];null!==R&&(i=l(R));break;case"height":a=A;break;case"ccw":c=A[0];break;case"colorPerVertex":o=A[0];break;case"creaseAngle":p=A[0];break;case"normalPerVertex":s=A[0];break;case"solid":u=A[0];break;case"xDimension":h=A[0];break;case"xSpacing":d=A[0];break;case"zDimension":f=A[0];break;case"zSpacing":m=A[0];break;default:console.warn("THREE.VRMLLoader: Unknown field:",E)}}var w=[],N=[],S=[],_=[];for(g=0;g<f;g++)for(var L=0;L<h;L++){var O=d*g,M=a[$=g*h+L],C=m*L;if(w.push(O,M,C),t&&!0===o){var P=t[3*$+0],F=t[3*$+1],U=t[3*$+2];S.push(P,F,U)}if(r&&!0===s){var D=r[3*$+0],B=r[3*$+1],V=r[3*$+2];N.push(D,B,V)}if(i){var j=i[2*$+0],G=i[2*$+1];_.push(j,G)}else _.push(g/(h-1),L/(f-1))}var H=[];for(g=0;g<h-1;g++)for(L=0;L<f-1;L++){var z=g+L*h,W=(U=g+(L+1)*h,g+1+(L+1)*h),K=g+1+L*h;!0===c?(H.push(z,W,U),H.push(W,z,K)):(H.push(z,U,W),H.push(W,K,z))}var X,Y,q=k(H,new n.Float32BufferAttribute(w,3)),Z=k(H,new n.Float32BufferAttribute(_,2));if(t)if(!1===o){for(g=0;g<h-1;g++)for(L=0;L<f-1;L++){P=t[3*($=g+L*(h-1))+0],F=t[3*$+1],U=t[3*$+2];S.push(P,F,U),S.push(P,F,U),S.push(P,F,U),S.push(P,F,U),S.push(P,F,U),S.push(P,F,U)}X=new n.Float32BufferAttribute(S,3)}else X=k(H,new n.Float32BufferAttribute(S,3));if(r)if(!1===s){for(g=0;g<h-1;g++)for(L=0;L<f-1;L++){var $;D=r[3*($=g+L*(h-1))+0],B=r[3*$+1],V=r[3*$+2];N.push(D,B,V),N.push(D,B,V),N.push(D,B,V),N.push(D,B,V),N.push(D,B,V),N.push(D,B,V)}Y=new n.Float32BufferAttribute(N,3)}else Y=k(H,new n.Float32BufferAttribute(N,3));else Y=I(H,w,p);var J=new n.BufferGeometry;J.setAttribute("position",q),J.setAttribute("normal",Y),J.setAttribute("uv",Z),X&&J.setAttribute("color",X);return J._solid=u,J._type="mesh",J}(e);break;case"Extrusion":t=function(e){for(var t,r,i=[1,1,1,-1,-1,-1,-1,1,1,1],a=[0,0,0,0,1,0],o=!0,s=!0,u=0,c=!0,l=!0,p=e.fields,h=0,f=p.length;h<f;h++){var d=p[h],m=d.name,v=d.values;switch(m){case"beginCap":o=v[0];break;case"ccw":s=v[0];break;case"convex":break;case"creaseAngle":u=v[0];break;case"crossSection":i=v;break;case"endCap":c=v[0];break;case"orientation":r=v;break;case"scale":t=v;break;case"solid":l=v[0];break;case"spine":a=v;break;default:console.warn("THREE.VRMLLoader: Unknown field:",m)}}for(var g=i[0]===i[i.length-2]&&i[1]===i[i.length-1],y=[],T=new n.Vector3,E=new n.Vector3,A=new n.Vector3,x=new n.Vector3,b=new n.Quaternion,R=(h=0,0),w=0,N=a.length;h<N;h+=3,R+=2,w+=4){T.fromArray(a,h),E.x=t?t[R+0]:1,E.y=1,E.z=t?t[R+1]:1,A.x=r?r[w+0]:0,A.y=r?r[w+1]:0,A.z=r?r[w+2]:1;for(var S=r?r[w+3]:0,_=0,L=i.length;_<L;_+=2)x.x=i[_+0],x.y=0,x.z=i[_+1],x.multiply(E),b.setFromAxisAngle(A,S),x.applyQuaternion(b),x.add(T),y.push(x.x,x.y,x.z)}var O=[],M=a.length/3,C=i.length/2;for(h=0;h<M-1;h++)for(R=0;R<C-1;R++){var P=R+h*C,F=R+1+h*C,U=R+(h+1)*C,D=R+1+(h+1)*C;R===C-2&&!0===g&&(F=h*C,D=(h+1)*C),!0===s?(O.push(P,F,U),O.push(U,F,D)):(O.push(P,U,F),O.push(U,D,F))}if(!0===o||!0===c){var B=[];for(h=0,f=i.length;h<f;h+=2)B.push(new n.Vector2(i[h],i[h+1]));var V=n.ShapeUtils.triangulateShape(B,[]),j=[];for(h=0,f=V.length;h<f;h++){var G=V[h];j.push(G[0],G[1],G[2])}if(!0===o)for(h=0,f=j.length;h<f;h+=3)!0===s?O.push(j[h+0],j[h+1],j[h+2]):O.push(j[h+0],j[h+2],j[h+1]);if(!0===c){var H=C*(M-1);for(h=0,f=j.length;h<f;h+=3)!0===s?O.push(H+j[h+0],H+j[h+2],H+j[h+1]):O.push(H+j[h+0],H+j[h+1],H+j[h+2])}}var z=k(O,new n.Float32BufferAttribute(y,3)),W=I(O,y,u),K=new n.BufferGeometry;return K.setAttribute("position",z),K.setAttribute("normal",W),K._solid=l,K._type="mesh",K}(e);break;case"Color":case"Coordinate":case"Normal":case"TextureCoordinate":t=function(e){return e.fields[0].values}(e);break;case"WorldInfo":t=function(e){for(var t={},r=e.fields,n=0,i=r.length;n<i;n++){var a=r[n],o=a.name,s=a.values;switch(o){case"title":t.title=s[0];break;case"info":t.info=s;break;default:console.warn("THREE.VRMLLoader: Unknown field:",o)}}return t}(e);break;case"Anchor":case"Billboard":case"Inline":case"LOD":case"Switch":case"AudioClip":case"DirectionalLight":case"PointLight":case"Script":case"Sound":case"SpotLight":case"CylinderSensor":case"PlaneSensor":case"ProximitySensor":case"SphereSensor":case"TimeSensor":case"TouchSensor":case"VisibilitySensor":case"Text":case"FontStyle":case"MovieTexture":case"ColorInterpolator":case"CoordinateInterpolator":case"NormalInterpolator":case"OrientationInterpolator":case"PositionInterpolator":case"ScalarInterpolator":case"Fog":case"NavigationInfo":case"Viewpoint":break;default:console.warn("THREE.VRMLLoader: Unknown node:",r)}void 0!==t&&void 0!==e.DEF&&!0===t.hasOwnProperty("name")&&(t.name=e.DEF);return t}(e)),e.build)}function p(e,t,r){switch(t){case o.INTENSITY:var n=parseInt(e);r.r=n,r.g=n,r.b=n;break;case o.INTENSITY_ALPHA:n=parseInt("0x"+e.substring(2,4));r.r=n,r.g=n,r.b=n,r.a=parseInt("0x"+e.substring(4,6));break;case o.RGB:r.r=parseInt("0x"+e.substring(2,4)),r.g=parseInt("0x"+e.substring(4,6)),r.b=parseInt("0x"+e.substring(6,8));break;case o.RGBA:r.r=parseInt("0x"+e.substring(2,4)),r.g=parseInt("0x"+e.substring(4,6)),r.b=parseInt("0x"+e.substring(6,8)),r.a=parseInt("0x"+e.substring(8,10))}}function h(e){var t;switch(e){case 1:t=o.INTENSITY;break;case 2:t=o.INTENSITY_ALPHA;break;case 3:t=o.RGB;break;case 4:t=o.RGBA}return t}function f(e,t){for(var r=0,i=e.length;r<i;r++){var a=l(e[r]);a instanceof n.Object3D&&t.add(a)}}function d(e,t){for(var r=[],n=0,i=0,a=e.length;i<a;i++){var o=e[n],s=e[i+(t?1:2)],u=e[i+(t?2:1)];r.push(o,s,u),(-1===e[i+3]||i+3>=a)&&(n=(i+=3)+1)}return r}function m(e,t){for(var r=[],n=0,i=0,a=t.length;i<a;i++){var o=3*n,s=e[o],u=e[o+1],c=e[o+2];r.push(s,u,c),(-1===t[i+3]||i+3>=a)&&(i+=3,n++)}return r}function v(e,t){for(var r=[],n=0,i=t.length;n<i;n++){var a=3*t[n],o=e[a],s=e[a+1],u=e[a+2];r.push(o,s,u)}return r}function g(e){for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r],a=e[r+1];t.push(i,a),(-1===e[r+2]||r+2>=n)&&(r+=2)}return t}function y(e,t){for(var r=[],n=0,i=0,a=t.length;i<a;i++){var o=3*n,s=e[o],u=e[o+1],c=e[o+2];r.push(s,u,c),(-1===t[i+2]||i+2>=a)&&(i+=2,n++)}return r}var T=new n.Vector3,E=new n.Vector3,A=new n.Vector3,x=new n.Vector2,b=new n.Vector2,R=new n.Vector2;function w(e,t,r,i){for(var a=[],o=0,s=e.length;o<s;o+=3){var u=t[o],c=t[o+1],l=t[o+2];2===i?(x.fromArray(r,u*i),b.fromArray(r,c*i),R.fromArray(r,l*i),a.push(x.x,x.y),a.push(b.x,b.y),a.push(R.x,R.y)):(T.fromArray(r,u*i),E.fromArray(r,c*i),A.fromArray(r,l*i),a.push(T.x,T.y,T.z),a.push(E.x,E.y,E.z),a.push(A.x,A.y,A.z))}return new n.Float32BufferAttribute(a,i)}function N(e,t){for(var r=[],i=0,a=0,o=e.length;i<o;i+=3,a++)T.fromArray(t,3*a),r.push(T.x,T.y,T.z),r.push(T.x,T.y,T.z),r.push(T.x,T.y,T.z);return new n.Float32BufferAttribute(r,3)}function S(e,t){for(var r=[],i=0,a=0,o=e.length;i<o;i+=2,a++)T.fromArray(t,3*a),r.push(T.x,T.y,T.z),r.push(T.x,T.y,T.z);return new n.Float32BufferAttribute(r,3)}function k(e,t){for(var r=t.array,i=t.itemSize,a=new r.constructor(e.length*i),o=0,s=0,u=0,c=e.length;u<c;u++){o=e[u]*i;for(var l=0;l<i;l++)a[s++]=r[o++]}return new n.Float32BufferAttribute(a,i)}var _=new n.Vector3,L=new n.Vector3;function I(e,t,r){for(var i=[],o={},s=0,u=e.length;s<u;s+=3){var c=e[s],l=e[s+1],p=e[s+2],h=new a(c,l,p);T.fromArray(t,3*c),E.fromArray(t,3*l),A.fromArray(t,3*p),L.subVectors(A,E),_.subVectors(T,E),L.cross(_),L.normalize(),h.normal.copy(L),void 0===o[c]&&(o[c]=[]),void 0===o[l]&&(o[l]=[]),void 0===o[p]&&(o[p]=[]),o[c].push(h.normal),o[l].push(h.normal),o[p].push(h.normal),i.push(h)}var f=[];for(s=0,u=i.length;s<u;s++){var d=O(o[(h=i[s]).a],h.normal,r),m=O(o[h.b],h.normal,r),v=O(o[h.c],h.normal,r);T.fromArray(t,3*h.a),E.fromArray(t,3*h.b),A.fromArray(t,3*h.c),f.push(d.x,d.y,d.z),f.push(m.x,m.y,m.z),f.push(v.x,v.y,v.z)}return new n.Float32BufferAttribute(f,3)}function O(e,t,r){var i=new n.Vector3;if(0===r)i.copy(t);else for(var a=0,o=e.length;a<o;a++)e[a].angleTo(t)<r&&i.add(e[a]);return i.normalize()}function M(e){for(var t=[],r=0,i=e.length;r<i;r+=3)t.push(new n.Color(e[r],e[r+1],e[r+2]));return t}function C(e,t,r,i,a){for(var o=[],s=!0===a?0:Math.PI,u=0,c=i.length;u<c;u++){var l=0===u?0:r[u-1];l=!0===a?l:s-l;var p=new n.Vector3;p.setFromSphericalCoords(t,l,0),o.push(p)}var h=e.index,f=e.attributes.position,d=new n.BufferAttribute(new Float32Array(3*e.attributes.position.count),3),m=new n.Vector3,v=new n.Color;for(u=0;u<h.count;u++){var g,y,T=h.getX(u);m.fromBufferAttribute(f,T);for(var E=1,A=1;A<o.length;A++){y=A;var x=o[g=A-1],b=o[y];if(!0===a){if(m.y<=x.y&&m.y>b.y){E=Math.abs(x.y-m.y)/Math.abs(x.y-b.y);break}}else if(m.y>=x.y&&m.y<b.y){E=Math.abs(x.y-m.y)/Math.abs(x.y-b.y);break}}var R=i[g],w=i[y];v.copy(R).lerp(w,E),d.setXYZ(T,v.r,v.g,v.b)}e.setAttribute("color",d)}var P=new n.TextureLoader(this.manager);if(P.setPath(this.resourcePath||s).setCrossOrigin(this.crossOrigin),-1===e.indexOf("#VRML V2.0"))throw Error("THREE.VRMLLexer: Version of VRML asset not supported.");return function(e){for(var t=e.nodes,r=new n.Scene,i=0,a=t.length;i<a;i++){c(o=t[i])}for(i=0,a=t.length;i<a;i++){var o,s=l(o=t[i]);s instanceof n.Object3D&&r.add(s),"WorldInfo"===o.name&&(r.userData.worldInfo=s)}return r}(function(e){var n=function(){for(var e=i.F.createToken,t=e({name:"RouteIdentifier",pattern:/[^\x30-\x39\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d][^\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d]*[\.][^\x30-\x39\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d][^\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d]*/}),r=e({name:"Identifier",pattern:/[^\x30-\x39\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d][^\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d]*/,longer_alt:t}),n=["Anchor","Billboard","Collision","Group","Transform","Inline","LOD","Switch","AudioClip","DirectionalLight","PointLight","Script","Shape","Sound","SpotLight","WorldInfo","CylinderSensor","PlaneSensor","ProximitySensor","SphereSensor","TimeSensor","TouchSensor","VisibilitySensor","Box","Cone","Cylinder","ElevationGrid","Extrusion","IndexedFaceSet","IndexedLineSet","PointSet","Sphere","Color","Coordinate","Normal","TextureCoordinate","Appearance","FontStyle","ImageTexture","Material","MovieTexture","PixelTexture","TextureTransform","ColorInterpolator","CoordinateInterpolator","NormalInterpolator","OrientationInterpolator","PositionInterpolator","ScalarInterpolator","Background","Fog","NavigationInfo","Viewpoint","Text"],a=e({name:"Version",pattern:/#VRML.*/,longer_alt:r}),o=e({name:"NodeName",pattern:new RegExp(n.join("|")),longer_alt:r}),s=e({name:"DEF",pattern:/DEF/,longer_alt:r}),u=e({name:"USE",pattern:/USE/,longer_alt:r}),c=e({name:"ROUTE",pattern:/ROUTE/,longer_alt:r}),l=e({name:"TO",pattern:/TO/,longer_alt:r}),p=e({name:"StringLiteral",pattern:/"(:?[^\\"\n\r]+|\\(:?[bfnrtv"\\/]|u[0-9a-fA-F]{4}))*"/}),h=e({name:"HexLiteral",pattern:/0[xX][0-9a-fA-F]+/}),f=e({name:"NumberLiteral",pattern:/[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?/}),d=e({name:"TrueLiteral",pattern:/TRUE/}),m=e({name:"FalseLiteral",pattern:/FALSE/}),v=e({name:"NullLiteral",pattern:/NULL/}),g=e({name:"LSquare",pattern:/\[/}),y=e({name:"RSquare",pattern:/]/}),T=e({name:"LCurly",pattern:/{/}),E=e({name:"RCurly",pattern:/}/}),A=e({name:"Comment",pattern:/#.*/,group:i.F.Lexer.SKIPPED}),x=[e({name:"WhiteSpace",pattern:/[ ,\s]/,group:i.F.Lexer.SKIPPED}),o,s,u,c,l,d,m,v,a,r,t,p,h,f,g,y,T,E,A],b={},R=0,w=x.length;R<w;R++){var N=x[R];b[N.name]=N}return{tokens:x,tokenVocabulary:b}}(),a=new t(n.tokens),o=new r(n.tokenVocabulary),s=function(e){function t(){e.call(this),this.validateVisitor()}function r(e,t){var r={type:null,values:[]};if(t.node){r.type="node";for(var n=0,i=t.node.length;n<i;n++){var a=t.node[n];r.values.push(e.visit(a))}}if(t.use){r.type="use";for(n=0,i=t.use.length;n<i;n++){var o=t.use[n];r.values.push(e.visit(o))}}if(t.StringLiteral){r.type="string";for(n=0,i=t.StringLiteral.length;n<i;n++){var s=t.StringLiteral[n];r.values.push(s.image.replace(/'|"/g,""))}}if(t.NumberLiteral){r.type="number";for(n=0,i=t.NumberLiteral.length;n<i;n++){var u=t.NumberLiteral[n];r.values.push(parseFloat(u.image))}}if(t.HexLiteral){r.type="hex";for(n=0,i=t.HexLiteral.length;n<i;n++){var c=t.HexLiteral[n];r.values.push(c.image)}}if(t.TrueLiteral){r.type="boolean";for(n=0,i=t.TrueLiteral.length;n<i;n++){"TRUE"===t.TrueLiteral[n].image&&r.values.push(!0)}}if(t.FalseLiteral){r.type="boolean";for(n=0,i=t.FalseLiteral.length;n<i;n++){"FALSE"===t.FalseLiteral[n].image&&r.values.push(!1)}}return t.NullLiteral&&(r.type="null",t.NullLiteral.forEach((function(){r.values.push(null)}))),r}return t.prototype=Object.assign(Object.create(e.prototype),{constructor:t,vrml:function(e){for(var t={version:this.visit(e.version),nodes:[],routes:[]},r=0,n=e.node.length;r<n;r++){var i=e.node[r];t.nodes.push(this.visit(i))}if(e.route)for(r=0,n=e.route.length;r<n;r++){var a=e.route[r];t.routes.push(this.visit(a))}return t},version:function(e){return e.Version[0].image},node:function(e){var t={name:e.NodeName[0].image,fields:[]};if(e.field)for(var r=0,n=e.field.length;r<n;r++){var i=e.field[r];t.fields.push(this.visit(i))}return e.def&&(t.DEF=this.visit(e.def[0])),t},field:function(e){var t,r={name:e.Identifier[0].image,type:null,values:null};return e.singleFieldValue&&(t=this.visit(e.singleFieldValue[0])),e.multiFieldValue&&(t=this.visit(e.multiFieldValue[0])),r.type=t.type,r.values=t.values,r},def:function(e){return(e.Identifier||e.NodeName)[0].image},use:function(e){return{USE:(e.Identifier||e.NodeName)[0].image}},singleFieldValue:function(e){return r(this,e)},multiFieldValue:function(e){return r(this,e)},route:function(e){return{FROM:e.RouteIdentifier[0].image,TO:e.RouteIdentifier[1].image}}}),new t}(o.getBaseCstVisitorConstructor()),u=a.lex(e);o.input=u.tokens;var c=o.vrml();if(o.errors.length>0)throw console.error(o.errors),Error("THREE.VRMLLoader: Parsing errors detected.");return s.visit(c)}(e))}}),t.prototype={constructor:t,lex:function(e){var t=this.lexer.tokenize(e);if(t.errors.length>0)throw console.error(t.errors),Error("THREE.VRMLLexer: Lexing errors detected.");return t}},r.prototype=Object.create(i.F.Parser.prototype),r.prototype.constructor=r;var o={INTENSITY:1,INTENSITY_ALPHA:2,RGB:3,RGBA:4};return e}()}}]);